æ€§èƒ½åˆ†æå·¥å…·åˆé›†

| å·¥å…·åŒ…  | å‘½ä»¤\å·¥å…· | ç”¨é€”                                                         |
| ------- | --------- | ------------------------------------------------------------ |
|         | top       |                                                              |
|         | ps        | è·å–å½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€                                       |
| sysstat | vmstat    | è™šæ‹Ÿå†…å­˜ç»Ÿè®¡çš„ç¼©å†™ï¼Œå¯å¯¹**è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€cpu**æ´»åŠ¨è¿›ç¨‹ç›‘æ§  |
| sysstat | mpstat    | ç›‘æ§**cpuç›¸å…³**çš„ç»Ÿè®¡ä¿¡æ¯                                    |
| sysstat | pidstat   | ç›‘æ§å…¨éƒ¨çš„æŒ‡å®šè¿›ç¨‹çš„cpuã€å†…å­˜ã€çº¿ç¨‹ã€è®¾å¤‡ioç­‰èµ„æºå ç”¨æƒ…å†µå’Œ<font color="red">**ä¸Šä¸‹æ–‡åˆ‡æ¢**</font>ä¿¡æ¯ |
| sysstat | netstat   | ç”¨äºæ˜¾ç¤ºä¸IP\TCP\UDP\ICMPåè®®ç›¸å…³çš„æ•°æ®ç»Ÿè®¡ï¼Œä¸€èˆ¬ç”¨äº**æ£€éªŒæœ¬æœºå„ç«¯å£**çš„ç½‘ç»œè¿æ¥æƒ…å†µ |
| sysstat | iostat    | æ˜¾ç¤ºè®¾å¤‡ï¼Œåˆ†åŒºå’Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿçš„**CPUç»Ÿè®¡**ä¿¡æ¯å’Œ**è¾“å…¥/è¾“å‡º**ç»Ÿè®¡ä¿¡æ¯ |
|         | sar       | æ˜¾ç¤ºå„ç§èµ„æºçš„ä½¿ç”¨æƒ…å†µ                                       |



## stressã€å·¥å…·ã€‘

### æ¨èæŒ‡æ•°	â˜…â˜…

### å‚è€ƒ

â€‹	å‚è€ƒæ–‡ç« ï¼šhttps://www.cnblogs.com/architectforest/p/12626121.html

### å·¥å…·ç”¨é€”

ä¸»è¦ç”¨æ¥æ¨¡æ‹Ÿç³»ç»Ÿè´Ÿè½½è¾ƒé«˜æ—¶çš„åœºæ™¯ï¼Œ å¯ä»¥å¯¹cpuã€memoryã€IOä»¥åŠç£ç›˜è¿›è¡Œå‹åŠ›æµ‹è¯•

### å·¥å…·å®‰è£…

åœ¨centos8çš„æºä¸­ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰åŒ…ï¼ˆ20200604ï¼‰ï¼Œå…ˆç”¨el7æºå®‰è£…

```sh
wget https://download-ib01.fedoraproject.org/pub/epel/7/x86_64/Packages/s/stress-1.0.4-16.el7.x86_64.rpm

rpm -ivh stress-1.0.4-16.el7.x86_64.rpm

# å¦‚æœæ²¡æœ‰å®‰è£…wget,å¯ä»¥ä½¿ç”¨å®‰è£…: dnf install -y wget 
```

åœ¨centos7ä¸­å®‰è£…stress

```shell
sudo yum install -y epel-release
sudo yum install -y stress
```

### å¸®åŠ©ä¿¡æ¯

```shell
stress --help
`stress' imposes certain types of compute stress on your system

Usage: stress [OPTION [ARG]] ...
 -?, --help         show this help statement
     --version      show version statement
 -v, --verbose      be verbose
 -q, --quiet        be quiet
 -n, --dry-run      show what would have been done
 -t, --timeout N    timeout after N seconds
     --backoff N    wait factor of N microseconds before work starts
 -c, --cpu N        spawn N workers spinning on sqrt()
 -i, --io N         spawn N workers spinning on sync()
 -m, --vm N         spawn N workers spinning on malloc()/free()
     --vm-bytes B   malloc B bytes per vm worker (default is 256MB)
     --vm-stride B  touch a byte every B bytes (default is 4096)
     --vm-hang N    sleep N secs before free (default none, 0 is inf)
     --vm-keep      redirty memory instead of freeing and reallocating
 -d, --hdd N        spawn N workers spinning on write()/unlink()
     --hdd-bytes B  write B bytes per hdd worker (default is 1GB)

Example: stress --cpu 8 --io 4 --vm 2 --vm-bytes 128M --timeout 10s

Note: Numbers may be suffixed with s,m,h,d,y (time) or B,K,M,G (size).
```

### å¸®åŠ©è¯´æ˜

| å‚æ•°                | ç”¨æ³•è¯´æ˜                                                     |
| ------------------- | ------------------------------------------------------------ |
| **-c, --cpu N**     | äº§ç”Ÿnä¸ªè¿›ç¨‹ï¼Œ æ¯ä¸ªè¿›ç¨‹éƒ½åå¤ä¸åœçš„è®¡ç®—éšæœºæ•°çš„å¹³æ–¹æ ¹sqrt()   =======**cpu** |
| **-i, --io N**      | äº§ç”Ÿnä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åå¤è°ƒç”¨sync()å‡½æ•°ï¼Œsync()ç”¨äºå°†å†…å­˜å†™åˆ°ç£ç›˜ä¸Š  ====**io** |
| **-m, --vm N**      | äº§ç”Ÿnä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åå¤è°ƒç”¨å†…å­˜åˆ†é…malloc() å’Œå†…å­˜é‡Šæ”¾free()å‡½æ•°  ====**å†…å­˜** |
| --vm-bytes B        | æŒ‡å®šè°ƒç”¨å†…å­˜åˆ†é…malloc()å‡½æ•°æ—¶ï¼Œåˆ†é…çš„å†…å®¹å¤§å°(é»˜è®¤ 256MB)   |
| --vm-stride B       | æ¯æ¬¡åˆ›å»ºæ–‡ä»¶å¤§å°(é»˜è®¤ 4096)                                  |
| --vm-hang N         | å†…å­˜é‡Šæ”¾å‰ä¼‘çœ å¤šé•¿æ—¶é—´(å•ä½ ç§’) æœ‰åˆ©äºæ¨¡æ‹Ÿåªæœ‰å°‘é‡å†…å­˜çš„æœºå™¨(é»˜è®¤ ä¸ä¼‘çœ ) |
| --vm-keep           | é‡è½½å†…å®¹ï¼Œè€Œä¸æ˜¯é‡Šæ”¾æˆ–é‡æ–°åˆ†é…                               |
| **-d, --hdd N**     | äº§ç”Ÿnä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åå¤è°ƒç”¨write() æˆ– unlink() å‡½æ•°  ========**ç£ç›˜** |
| --hdd-bytes B       | æŒ‡å®šæŒç»­å†™æ–‡ä»¶çš„å¤§å°(é»˜è®¤ 1GB)                               |
| **-t, --timeout N** | æŒç»­æ–½å‹æ—¶é•¿     ========**æŒç»­æ—¶é•¿**                        |
| --backoff N         | å¼€å§‹æ–½å‹å‰ï¼Œç­‰å¾… å¤šå°‘å¾®ç§’                                    |

### æ¡ˆä¾‹å®æ“

**ä¾‹1ï¼š**

**å¯¹cpuæ–½å‹ï¼š** `stress -c 1 -t 120`	 å‘1ä¸ªcpuæŒç»­æ–½å‹120ç§’é’Ÿ

```shell
$ stress -c 1 -t 120
stress: info: [79256] dispatching hogs: 1 cpu, 0 io, 0 vm, 0 hdd

```

ç”¨pidstat æŸ¥çœ‹cpuçš„ä½¿ç”¨æ•°æ®:   `pidstat -p ALL 5`  æˆ–ç”¨ï¼š`mpstat -P ALL 5`

å¹³å‡æ—¶é—´:   UID       PID    %usr 	%system  %guest   %wait    %CPU   	CPU  Command
å¹³å‡æ—¶é—´:  1000    108738   **64.99**    0.00    	0.00   	34.73   	**64.99**     -  stress

**ç»“è®ºï¼š** <u>ç”¨æˆ·æ€%usrçš„cpuä½¿ç”¨ç‡%CPUéå¸¸é«˜ï¼Œå‡ ä¹å ç”¨äº†æ‰€æœ‰çš„cpuä½¿ç”¨</u>

---

**ä¾‹2ï¼š**

**å¯¹å†…å­˜æ–½å‹ï¼š**`stress -m 2 -t 120`  äº§ç”Ÿ2ä¸ªè¿›ç¨‹ï¼ŒæŒç»­è°ƒç”¨å†…å­˜åˆ†é…mallocå’Œå†…å­˜é‡Šæ”¾freeå‡½æ•°120ç§’é’Ÿ

ç„¶åç”¨ `pidstat -r | grep stress` å¯ä»¥çœ‹åˆ°å†…å­˜å ç”¨æƒ…å†µ

**ä¾‹3ï¼š**

**å¯¹ç£ç›˜æ–½å‹ï¼š**`stress -d 2 -t 120`  äº§ç”Ÿ2ä¸ªè¿›ç¨‹ï¼ŒæŒç»­å¯¹ç£ç›˜è¿›è¡Œwriteå’Œunlinkå‡½æ•°æ“ä½œ120ç§’é’Ÿ

ç„¶åç”¨ `pidstat -d` æŸ¥çœ‹æƒ…å†µ

**ä¾‹4ï¼š**

**å¯¹ioæ–½å‹ï¼š**`stress -i 4 -t 120`  äº§ç”Ÿ4ä¸ªè¿›ç¨‹ï¼ŒæŒç»­è°ƒç”¨sync()å‡½æ•°120ç§’é’Ÿ

èƒ½çœ‹åˆ°stressçš„4ä¸ªè¿›ç¨‹äº§ç”Ÿçš„å¤§é‡çš„waitç±»çš„cpuä½¿ç”¨

å†ç”¨ `pidstat -u 5 1 `  é—´éš”5ç§’åè¾“å‡ºä¸€ç»„æ•°æ®ï¼Œ-uè¡¨ç¤ºCPUæŒ‡æ ‡

---

## stress-ng[å·¥å…·]

### æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…

### å‚è€ƒï¼š

â€‹	https://blog.csdn.net/s1421578048/article/details/104262751

https://zhuanlan.zhihu.com/p/33422310

https://bbs.huaweicloud.com/blogs/140864

### å·¥å…·ç”¨é€”ï¼š

â€‹	æ˜¯stressçš„å‡çº§ç‰ˆæœ¬ï¼Œä¸»è¦æ¨¡æ‹Ÿå‹åŠ›æµ‹è¯•

### å·¥å…·å®‰è£…ï¼š

centos7ç³»ç»Ÿå®‰è£…stress-ngï¼š

```sh
yum install -y epel-release.noarch && yum -y update

yum install -y stress-ng
```

centos8ç³»ç»Ÿå®‰è£…stress-ngï¼š

```sh
wget http://kernel.ubuntu.com/~cking/tarballs/stress-ng/stress-ng-0.11.18.tar.xz
# http://kernel.ubuntu.com/~cking/tarballs/stress-ng è¿™ä¸ªä¸Šé¢å¯ä»¥çœ‹åˆ°æœ€æ–°çš„åŒ…

# è§£å‹å®‰è£…
tar -xJvf stress-ng-0.11.18.tar.xz
cd stress-ng-0.11.18
make
sudo make install
```

å¸®åŠ©ä¿¡æ¯ï¼š

```sh
stress-ng --help

stress-ng, version 0.11.18 (gcc 8.3, x86_64 Linux 4.18.0-193.6.3.el8_2.x86_64) ğŸ’»ğŸ”¥

Usage: stress-ng [OPTION [ARG]]

General control options:å¸¸è§„æ§åˆ¶é€‰é¡¹
      --abort              abort all stressors if any stressor fails
      --aggressive         enable all aggressive options
-a N, --all N              start N workers of each stress test
-b N, --backoff N          wait of N microseconds before work starts
      --class name         specify a class of stressors, use with --sequential
-n,   --dry-run            do not run
-h,   --help               show help
      --ignite-cpu         alter kernel controls to make CPU run hot
      --ionice-class C     specify ionice class (idle, besteffort, realtime)
      --ionice-level L     specify ionice level (0 max, 7 min)
-j,   --job jobfile        run the named jobfile
-k,   --keep-name          keep stress worker names to be 'stress-ng'
      --log-brief          less verbose log messages
      --log-file filename  log messages to a log file
      --maximize           enable maximum stress options
      --max-fd             set maximum file descriptor limit
-M,   --metrics            print pseudo metrics of activity
      --metrics-brief      enable metrics and only show non-zero results
      --minimize           enable minimal stress options
      --no-madvise         don't use random madvise options for each mmap
      --no-rand-seed       seed random numbers with the same constant
      --page-in            touch allocated pages that are not in core
      --parallel N         synonym for 'all N'
      --pathological       enable stressors that are known to hang a machine
      --perf               display perf statistics
-q,   --quiet              quiet output
-r,   --random N           start N random workers
      --sched type         set scheduler type
      --sched-prio N       set scheduler priority level N
      --sched-period N     set period for SCHED_DEADLINE to N nanosecs (Linux only)
      --sched-runtime N    set runtime for SCHED_DEADLINE to N nanosecs (Linux only)
      --sched-deadline N   set deadline for SCHED_DEADLINE to N nanosecs (Liunx only)
      --sched-reclaim      set reclaim cpu bandwidth for deadline schduler (Liunx only)
      --sequential N       run all stressors one by one, invoking N of them
      --stressors          show available stress tests
      --syslog             log messages to the syslog
      --taskset            use specific CPUs (set CPU affinity)
      --temp-path path     specify path for temporary directories and files
      --thrash             force all pages in causing swap thrashing
-t N, --timeout T          timeout after T seconds
      --timer-slack        enable timer slack mode
      --times              show run time summary at end of the run
      --timestamp          timestamp log output
      --tz                 collect temperatures from thermal zones (Linux only)
-v,   --verbose            verbose output
      --verify             verify results (not available on all tests)
-V,   --version            show version
-Y,   --yaml file          output results to YAML formatted filed
-x,   --exclude            list of stressors to exclude (not run)


Stressor specific options: å‹åŠ›æµ‹è¯•ç‰¹å®šé€‰é¡¹

-c N, --cpu N              start N workers spinning on sqrt(rand())å¯åŠ¨Nä¸ªworkerså¾ªç¯è¿›è¡Œéšæœºæ•°çš„å¹³æ–¹æ ¹è®¡ç®—
      --cpu-ops N          stop after N cpu bogo operations
-l P, --cpu-load P         load CPU by P %, 0=sleep, 100=full load (see -c)
      --cpu-load-slice S   specify time slice during busy load
      --cpu-method M       specify stress cpu method M, default is all
      --cpu-online N       start N workers offlining/onlining the CPUs
      --cpu-online-ops N   stop after N offline/online operations
-d N, --hdd N              start N workers spinning on write()/unlink()å¯åŠ¨Nä¸ªworkerså¾ªç¯è¿›è¡Œå†™/åˆ é™¤æ“ä½œ
      --hdd-ops N          stop after N hdd bogo operations
      --hdd-bytes N        write N bytes per hdd worker (default is 1GB)
      --hdd-opts list      specify list of various stressor options
      --hdd-write-size N   set the default write size to N bytes
-i N, --io N               start N workers spinning on sync() å¯åŠ¨Nä¸ªworkerså¾ªç¯è°ƒç”¨syncï¼Œæœ¬æ„æ˜¯æ¨¡æ‹ŸI/Oé—®é¢˜ï¼Œä½†æ˜¯æ•°æ®åº“ä¼šåœ¨bufferä¸­ç¼“å­˜ï¼Œè¾¾ä¸åˆ°æ•ˆæœï¼Œè¿™ä¸€ç‚¹åœ¨SSDç£ç›˜ç¯å¢ƒä¸­å°¤å…¶æ˜æ˜¾ã€‚å¾ˆå¯èƒ½iowaitä¸º0ï¼Œè€Œcpuä½¿ç”¨ç‡syså¾ˆé«˜
      --io-ops N           stop sync I/O after N io bogo operations
      --iomix N            start N workers that have a mix of I/O operations
      --iomix-bytes N      write N bytes per iomix worker (default is 1GB)
      --iomix-ops N        stop iomix workers after N iomix bogo operations
      --ioport N           start N workers exercising port I/O
      --ioport-ops N       stop ioport workers after N port bogo operations
      --ioprio N           start N workers exercising set/get iopriority
      --ioprio-ops N       stop after N io bogo iopriority operations
-T N, --timer N            start N workers producing timer events
      --timer-ops N        stop after N timer bogo events
      --timer-freq F       run timer(s) at F Hz, range 1 to 1000000000
      --timer-rand         enable random timer frequency
      --timerfd N          start N workers producing timerfd events
      --timerfd-ops N      stop after N timerfd bogo events
      --timerfd-freq F     run timer(s) at F Hz, range 1 to 1000000000
      --timerfd-rand       enable random timerfd frequency
-m N, --vm N               start N workers spinning on anonymous mmap å¯åŠ¨Nä¸ªworkersè¿›è¡Œå¾ªç¯åŒ¿åmmapï¼ˆmmapï¼šå°†ä¸€ä¸ªæ–‡ä»¶æˆ–å…¶å®ƒå¯¹è±¡æ˜ å°„åˆ°å†…å­˜ï¼‰
      --vm-bytes N         allocate N bytes per vm worker (default 256MB)
      --vm-hang N          sleep N seconds before freeing memory
      --vm-keep            redirty memory instead of reallocating
      --vm-ops N           stop after N vm bogo operations
      --vm-locked           lock the pages of the mapped region into memory
      --vm-madvise M       specify mmap'd vm buffer madvise advice
      --vm-method M        specify stress vm method M, default is all
      --vm-populate        populate (prefault) page tables for a mapping
      --vm-addr N          start N vm address exercising workers
      --vm-addr-ops N      stop after N vm address bogo operations
      --vm-rw N            start N vm read/write process_vm* copy workers
      --vm-rw-bytes N      transfer N bytes of memory per bogo operation
      --vm-rw-ops N        stop after N vm process_vm* copy bogo operations
      --vm-segv N          start N workers that unmap their address space
      --vm-segv-ops N      stop after N vm-segv unmap'd SEGV faults
      --vm-splice N        start N workers reading/writing using vmsplice
      --vm-splice-ops N    stop after N bogo splice operations
      --vm-splice-bytes N  number of bytes to transfer per vmsplice call
      --wait N             start N workers waiting on child being stop/resumed
      --wait-ops N         stop after N bogo wait operations

```

### å¸®åŠ©è¯´æ˜ï¼š

```
-c N: è¿è¡ŒN worker CPUå‹åŠ›æµ‹è¯•è¿›ç¨‹
--cpu-method all: workerä»è¿­ä»£ä½¿ç”¨30å¤šç§ä¸é€šçš„å‹åŠ›ç®—æ³•ï¼Œ åŒ…æ‹¬piã€crc16ã€fftç­‰ç­‰
-tastset N: å°†å‹åŠ›åŠ åˆ°æŒ‡å®šæ ¸å¿ƒä¸Š
-d N: è¿è¡ŒN worker HDD write/unlink æµ‹è¯•
-i N: è¿è¡ŒN worker IOæµ‹è¯•
--hdd: è¡¨ç¤ºè¯»å†™ä¸´æ—¶æ–‡ä»¶
```



### æ¡ˆä¾‹å®æ“ï¼š

```sh
stress-ng --cpu 8 --io 4 --vm 2 --vm-bytes 128M --fork 4 --timeout 10s

# æ¨¡æ‹Ÿcpuå¯†é›†åœºæ™¯ï¼Œè¯¥å‘½ä»¤ä¼šå°½é‡å æ»¡6ä¸ªCPUæ ¸
stress-ng --cpu 6 --timeout 300

# ioå¯†é›†åœºæ™¯ï¼Œè¯¥å‘½ä»¤ä¼šå¼€å¯1ä¸ªworkerä¸åœçš„è¯»å†™ä¸´æ—¶æ–‡ä»¶ï¼ŒåŒæ—¶å¯åŠ¨6ä¸ªworkersä¸åœçš„è°ƒç”¨syncç³»ç»Ÿè°ƒç”¨æäº¤ç¼“å­˜
stress-ng  -i 6 --hdd 1 --timeout 300

# è¿›ç¨‹å¯†é›†åœºæ™¯ï¼Œè¯¥å‘½ä»¤ä¼šå¯åŠ¨N*10ä¸ªè¿›ç¨‹ï¼Œåœ¨åªæœ‰Nä¸ªæ ¸çš„ç³»ç»Ÿä¸Šï¼Œä¼šäº§ç”Ÿå¤§é‡çš„è¿›ç¨‹åˆ‡æ¢ï¼Œæ¨¡æ‹Ÿè¿›ç¨‹é—´ç«äº‰CPUçš„åœºæ™¯
(( proc_cnt = `nproc`*10 )); stress-ng --cpu $proc_cnt --pthread 1 timeout 300

# çº¿ç¨‹å¯†é›†å‹åœºæ™¯ï¼Œè¯¥å‘½ä»¤ä¼šåœ¨Nä¸ªCPUæ ¸çš„ç³»ç»Ÿä¸Šï¼Œäº§ç”ŸNä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹1024ä¸ªçº¿ç¨‹ï¼Œæ¨¡æ‹Ÿçº¿ç¨‹é—´ç«äº‰CPUçš„åœºæ™¯
stress-ng --cpu `nproc` --pthread 1024 timeout 300




# äº§ç”Ÿ2ä¸ªworkeråšåœ†å‘¨ç‡ç®—æ³•å‹åŠ›
stress-ng -c 2 --cpu-method pi

# äº§ç”Ÿ2ä¸ªworkerä»è¿­ä»£ä½¿ç”¨30å¤šç§ä¸åŒçš„å‹åŠ›ç®—æ³•ï¼ŒåŒ…æ‹¬pi, crc16, fftç­‰ç­‰
stress-ng -c 2 --cpu-method all

# äº§ç”Ÿ2ä¸ªworkerè°ƒç”¨socketç›¸å…³å‡½æ•°äº§ç”Ÿå‹åŠ›
stress-ng --sock 2

# äº§ç”Ÿ2ä¸ªworkerè¯»å–tscäº§ç”Ÿå‹åŠ›
stress-ng --tsc 2

# æŒ‡å®šå‘ç¬¬0ã€2ã€3ã€6ä¸ªcpuæ–½å‹
stress-ng --sock 4 --taskset 0,2-3,6

```

---

## dd

https://www.cnblogs.com/sylar5/p/6649009.html

## sysstatã€å·¥å…·é›†ã€‘

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	 https://github.com/sysstat/sysstat

â€‹	http://sebastien.godard.pagesperso-orange.fr/documentation.html

### å·¥å…·ç”¨é€”

 	æ€§èƒ½åˆ†æå·¥å…·åŒ…åˆé›†ï¼ŒåŒ…å«äº†å¤šä¸ªå¸¸ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·

The sysstat package contains various utilities, common to many  commercial Unixes, to monitor system performance and usage activity.sysstatè½¯ä»¶åŒ…åŒ…å«è®¸å¤šå•†ä¸šUnixé€šç”¨çš„å„ç§å®ç”¨ç¨‹åºï¼Œç”¨äºç›‘è§†ç³»ç»Ÿæ€§èƒ½å’Œä½¿ç”¨æƒ…å†µã€‚

+ ä¸»è¦åŠŸèƒ½ï¼š
  + åœ¨æŠ¥å‘Šæœ«å°¾æ˜¾ç¤ºå¹³å‡ç»Ÿè®¡å€¼ã€‚
  + åŠ¨æ€æ£€æµ‹åŠ¨æ€åˆ›å»ºæˆ–æ³¨å†Œçš„æ–°è®¾å¤‡ï¼ˆç£ç›˜ï¼Œç½‘ç»œæ¥å£ç­‰ï¼‰ã€‚
  + æ”¯æŒUPå’ŒSMPè®¡ç®—æœºï¼ŒåŒ…æ‹¬å…·æœ‰è¶…çº¿ç¨‹æˆ–å¤šæ ¸å¤„ç†å™¨çš„è®¡ç®—æœºã€‚
  + æ”¯æŒçƒ­æ’æ‹”CPUï¼ˆè‡ªåŠ¨æ£€æµ‹æ­£åœ¨åŠ¨æ€ç¦ç”¨æˆ–å¯ç”¨çš„å¤„ç†å™¨ï¼‰å’Œæ— æ»´ç­”çš„CPUã€‚
  + é€‚ç”¨äº32ä½æˆ–64ä½çš„è®¸å¤šä¸åŒä½“ç³»ç»“æ„ã€‚
  + åªéœ€å¾ˆå°‘çš„CPUæ—¶é—´å³å¯è¿è¡Œï¼ˆç”¨Cç¼–å†™ï¼‰ã€‚
  + å¯ä»¥å°†sar / sadcæ”¶é›†çš„ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œä»¥å¤‡å°†æ¥æ£€æŸ¥ã€‚ æ‚¨å¯ä»¥é…ç½®è¦ä¿ç•™çš„æ•°æ®å†å²è®°å½•çš„é•¿åº¦ã€‚ æ­¤å†å²è®°å½•çš„é•¿åº¦æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯å­˜å‚¨è®¾å¤‡ä¸Šçš„å¯ç”¨ç©ºé—´ã€‚
  + å¯ä»¥ä»¥å„ç§ä¸åŒçš„æ ¼å¼ï¼ˆCSVï¼ŒXMLï¼ŒJSONï¼ŒSVGç­‰ï¼‰å¯¼å‡ºç”±sar / sadcæ”¶é›†çš„ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ã€‚  sysstatè½¯ä»¶åŒ…ä¸­åŒ…å«DTDå’ŒXML Schemaæ–‡æ¡£ã€‚  JSONè¾“å‡ºæ ¼å¼è¿˜å¯ç”¨äºmpstatå’Œiostatå‘½ä»¤ã€‚
  + iostatå¯ä»¥æ˜¾ç¤ºç”±ç”¨æˆ·ç©ºé—´ï¼ˆä¾‹å¦‚spdkï¼‰ä¸­çš„é©±åŠ¨ç¨‹åºç®¡ç†çš„è®¾å¤‡çš„ç»Ÿè®¡ä¿¡æ¯ã€‚
  + æ™ºèƒ½å½©è‰²è¾“å‡ºï¼Œæ›´æ˜“äºè¯»å–ç»Ÿè®¡æ•°æ®ã€‚

### å·¥å…·å®‰è£…

â€‹	sudo dnf install sysstat

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

â€‹	åŒ…å«äº†ï¼šiostatã€mpstatã€pidstatã€cifsiostatï¼›sarã€sadcã€sa1ã€sa2ã€sadf

### æ¡ˆä¾‹å®æ“

---

## top

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://www.cnblogs.com/lovychen/p/5237852.html

### å·¥å…·ç”¨é€”

 linuxç³»ç»Ÿä¸­å¸¸ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œèƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µï¼Œç±»ä¼¼äºwindowsçš„ä»»åŠ¡ç®¡ç†å™¨ã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ top
h
Help for Interactive Commands - procps-ng 3.3.12
Window 1:Def: Cumulative mode Off.  System: Delay 3.0 secs; Secure mode Off.

  Z,B,E,e   Global: 'Z' colors; 'B' bold; 'E'/'e' summary/task memory scale
  l,t,m     Toggle Summary: 'l' load avg; 't' task/cpu stats; 'm' memory info
  0,1,2,3,I Toggle: '0' zeros; '1/2/3' cpus or numa node views; 'I' Irix mode
  f,F,X     Fields: 'f'/'F' add/remove/order/sort; 'X' increase fixed-width

  L,&,<,> . Locate: 'L'/'&' find/again; Move sort column: '<'/'>' left/right
  R,H,V,J . Toggle: 'R' Sort; 'H' Threads; 'V' Forest view; 'J' Num justify
  c,i,S,j . Toggle: 'c' Cmd name/line; 'i' Idle; 'S' Time; 'j' Str justify
  x,y     . Toggle highlights: 'x' sort field; 'y' running tasks
  z,b     . Toggle: 'z' color/mono; 'b' bold/reverse (only if 'x' or 'y')
  u,U,o,O . Filter by: 'u'/'U' effective/any user; 'o'/'O' other criteria
  n,#,^O  . Set: 'n'/'#' max tasks displayed; Show: Ctrl+'O' other filter(s)
  C,...   . Toggle scroll coordinates msg for: up,down,left,right,home,end

  k,r       Manipulate tasks: 'k' kill; 'r' renice
  d or s    Set update interval
  W,Y       Write configuration file 'W'; Inspect other output 'Y'
  q         Quit
          ( commands shown with '.' require a visible task display window )
Press 'h' or '?' for help with Windows,
Type 'q' or <Esc> to continue 
```

### å¸®åŠ©è¯´æ˜

usï¼šuser space ç”¨æˆ·ç©ºé—´å ç”¨cpuç™¾åˆ†æ¯”

syï¼šsystcl ç³»ç»Ÿå†…æ ¸å ç”¨cpuç™¾åˆ†æ¯”

niï¼šnice è¿›ç¨‹ä¼˜å…ˆçº§æ”¹å˜å cpuç™¾åˆ†æ¯”

idï¼šidolt  ç©ºé—²cpuç™¾åˆ†æ¯”

waï¼š wait  IOç­‰å¾…å ç”¨cpuç™¾åˆ†æ¯”

hiï¼šHardware IRQ ç¡¬ä¸­æ–­å ç”¨ç™¾åˆ†æ¯”

siï¼šSoftware Interrupt è½¯ä¸­æ–­å ç”¨ç™¾åˆ†æ¯”

stï¼šhypervisorç®¡ç†ç¨‹åºå ç”¨ç™¾åˆ†æ¯”

totalï¼šæ€»å†…å­˜

freeï¼šç©ºé—²å†…å­˜

usedï¼šå·²ç»ä½¿ç”¨çš„ç‰©ç†å†…å­˜

buff/cacheï¼šå†…æ ¸çš„ç¼“å­˜æ€»é‡

swapï¼šäº¤æ¢åŒº

avaliï¼šå¯ç”¨äºä¸‹ä¸€æ¬¡çš„ç‰©ç†å†…å­˜æ€»é‡

PIDï¼šè¿›ç¨‹id

USERï¼šç”¨æˆ·

PRï¼šä¼˜å…ˆçº§

NIï¼šniceå€¼ï¼Œè´Ÿé«˜ä¼˜å…ˆçº§

VIRTï¼šè™šæ‹Ÿå†…å­˜ä½¿ç”¨é‡

RESï¼šä½¿ç”¨çš„ç‰©ç†å†…å­˜

SHRï¼šå…±äº«å†…å­˜å¤§å°

Sï¼šè¿›ç¨‹çŠ¶æ€

%CPUï¼šcpuä½¿ç”¨ç‡

%MEMï¼šå†…å­˜ä½¿ç”¨ç‡

TIME+ï¼šå ç”¨cpuæ€»æ—¶é•¿

COMMANDï¼šå‘½ä»¤/è¿›ç¨‹

| **å‚æ•°**  | **ç”¨æ³•è§£é‡Š**                                                 |
| --------- | ------------------------------------------------------------ |
| Z B E e   | Zé¢œè‰²ã€BåŠ ç²—ã€**E**ç³»ç»Ÿå†…å­˜å•ä½è½¬æ¢**ã€ **eè¿›ç¨‹å†…å­˜å•ä½è½¬æ¢  |
| l t m     | l å¹³å‡å€¼ã€t ä»»åŠ¡/cpuç»Ÿè®¡ä¿¡æ¯ã€ **m** **å†…å­˜ä¿¡æ¯**            |
| 0 1 2 3 I | 0 åˆ‡æ¢æ˜¾ç¤º0ä¿¡æ¯ã€**1\2\3 cpu**ä¿¡æ¯                           |
| f F X     | f\F æ·»åŠ \åˆ é™¤\è®¢è´­\æ’åºå­—æ®µã€ X å¢åŠ åˆ—å®½åº¦                   |
| L & < >   | L & æŸ¥æ‰¾\å†æ¬¡æŸ¥æ‰¾ã€< > å·¦å³ç§»åŠ¨æ’åº                          |
| R H V J   | R æ’åº **H** **æ˜¾ç¤ºçº¿ç¨‹** **V** **æ ‘ç»“æ„å±•ç¤º** **J**åˆ—è¡¨æ•°å­—(å·¦\å³å¯¹é½) |
| c i s j   | c æŸ¥çœ‹cmdå‘½ä»¤ i æŸ¥çœ‹idleå€¼ **s** **è®¾ç½®æ›´æ–°**æ—¶é—´ **j** åˆ—è¡¨ä¸ºå­—ç¬¦ä¸²(å·¦\å³å¯¹é½) |
| x y       | x åˆ‡æ¢é«˜äº®æ’åºå­—æ®µ ã€yæ ¹æ®è¿è¡Œä»»åŠ¡é«˜äº®æ’åº                   |
| u         | u\U ç”¨æˆ·                                                     |

| **å‚æ•°** | **ç”¨æ„**            | **ä¸­æ–‡**                                         | **å‚æ•°** | **ç”¨æ„**             | **ä¸­æ–‡**                 |
| -------- | ------------------- | ------------------------------------------------ | -------- | -------------------- | ------------------------ |
| PID      | Process Id          | è¿›ç¨‹id                                           | TIME+    | CPU Time, hundredths | è¿›ç¨‹ä½¿ç”¨cpuæ—¶é—´ï¼Œ1/100ç§’ |
| USER     | Effective User Name | ç”¨æˆ·å                                           | COMMAND  | Command Name/Line    | å‘½ä»¤å/è¡Œ                |
| PR       | Priority            | ä¼˜å…ˆçº§                                           | PPID     | Parent Process pid   | çˆ¶è¿›ç¨‹id                 |
| NI       | Nice Value          | ä¼˜å…ˆçº§å€¼ï¼Œè´Ÿé«˜                                   | UID      | Effective User Id    | è¿›ç¨‹æ‰€æœ‰è€…çš„ç”¨æˆ·id       |
| VIRT     | Virtual Image (KiB) | è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜é‡                             | RUID     | Real User Id         | è¿›ç¨‹çœŸå®çš„ç”¨æˆ·id         |
| RES      | Resident Size (KiB) | ä½¿ç”¨ã€æœªè¢«æ¢å‡ºçš„å†…å­˜å¤§å°                         | RUSER    | Real User Name       | çœŸå®ç”¨æˆ·                 |
| SHR      | Shared Memory (KiB) | å…±äº«å†…å­˜å¤§å°                                     | SUID     | Saved User Id        | ä¿å­˜åˆ°ç”¨æˆ·id             |
| S        | Process Status      | è¿›ç¨‹çŠ¶æ€ï¼ŒDä¸å¯ä¸­æ–­ Rè¿è¡Œ Sç¡çœ  Tè·Ÿè¸ª/åœæ­¢ Zåƒµå°¸ | SUSER    | Saved User Name      | ä¿å­˜åˆ°ç”¨æˆ·å             |
| %CPU     | CPU Usage           | cpuä½¿ç”¨ç‡                                        | GID      | Group Id             | è¿›ç¨‹æ‰€æœ‰è€…çš„ç»„id         |
| %MEM     | Memory Usage (RES)  | å†…å­˜ä½¿ç”¨ç‡                                       | GROUP    | Group Name           | è¿›ç¨‹æ‰€æœ‰è€…çš„ç»„å         |

| **å‚æ•°** | **ç”¨æ„**            | **ä¸­æ–‡**            | **å‚æ•°** | **ç”¨æ„**             | **ä¸­æ–‡**       |
| -------- | ------------------- | ------------------- | -------- | -------------------- | -------------- |
| PGRP     | Process Group Id    | è¿›ç¨‹æ‰€æœ‰è€…ç»„id      | nMaj     | Major Page Faults    | ä¸»è¦é¡µé¢é”™è¯¯   |
| TTY      | Controlling Tty     | å¯åŠ¨è¿›ç¨‹çš„ç»ˆç«¯å    | nMin     | Minor Page Faults    | æœ€å°é¡µé¢é”™è¯¯   |
| TPGID    | Tty Process Grp Id  | ttyæµç¨‹ç»„id         | nDRT     | Dirty Pages Count    | è¢«ä¿®æ”¹ç¬¬é¡µé¢æ•° |
| SID      | Session Id          | ä¼šè¯id              | WCHAN    | Sleeping in Function | ç¡çœ ä¸­çš„å‡½æ•°å |
| nTH      | Number of Threads   | çº¿ç¨‹å·              | Flags    | Task Flags <sched.h> | ä»»åŠ¡æ ‡è®°       |
| P        | Last Used Cpu (SMP) | æœ€åä½¿ç”¨çš„cpu       | CGROUPS  | Control Groups       | æ§åˆ¶ç»„å       |
| TIME     | CPU Time            | è¿›ç¨‹ä½¿ç”¨cpuæ—¶é—´ï¼Œç§’ | SUPGIDS  | Supp Groups IDs      | æ”¯æŒç»„id       |
| SWAP     | Swapped Size (KiB)  | äº¤æ¢åŒºå¤§å°          | SUPGRPS  | Supp Groups Names    | æ”¯æŒç»„åç§°     |
| CODE     | Code Size (KiB)     | ä»£ç å ç”¨å†…å­˜å¤§å°    | TGID     | Thread Group Id      | çº¿ç¨‹ç»„id       |
| DATA     | Data+Stack (KiB)    | æ•°æ®+æ ˆå¤§å°         | OOMa     | OOMEM Adjustment     | å†…å­˜è°ƒæ•´       |

| **å‚æ•°** | **ç”¨æ„**             | **ä¸­æ–‡**     | **å‚æ•°** | **ç”¨æ„**             | **ä¸­æ–‡**         |
| -------- | -------------------- | ------------ | -------- | -------------------- | ---------------- |
| OOMs     | OOMEM Score current  | å†…å­˜å½“å‰è¯„åˆ† | nsUTS    | UTS namespace Inode  | UTSå‘½åç©ºé—´      |
| ENVIRON  | Environment vars     | ç¯å¢ƒå˜é‡     | LXC      | LXC container name   | LXCæ§åˆ¶å™¨å      |
| vMj      | Major Faults delta   | æœ€ä¸»è¦ é”™è¯¯  | RSan     | RES Anonymous (KiB)  | åŒ¿åå†…å­˜å¤§å°     |
| vMn      | Minor Faults delta   | æœ€å°é”™è¯¯     | RSfd     | RES File-based (KiB) | åŸºç¡€æ–‡ä»¶å†…å­˜å¤§å° |
| USED     | Res+Swap Size (KiB)  | çœŸå®å†…å­˜ä½¿ç”¨ | RSlk     | RES Locked (KiB)     | å†…å­˜é”å¤§å°       |
| nsIPC    | IPC namespace Inode  | IPCå‘½åç©ºé—´  | RSsh     | RES Shared (KiB)     | å…±äº«å†…å­˜å¤§å°     |
| nsMNT    | MNT namespace Inode  | MNTå‘½åç©ºé—´  | CGNAME   | Control Group name   | æ§åˆ¶ç»„å         |
| nsNET    | NET namespace Inode  | NETå‘½åç©ºé—´  |          |                      |                  |
| nsPID    | PID namespace Inode  | PIDå‘½åç©ºé—´  |          |                      |                  |
| nsUSER   | USER namespace Inode | USERå‘½åç©ºé—´ |          |                      |                  |

### æ¡ˆä¾‹å®æ“

b + n + 4ï¼š é«˜äº®æ˜¾ç¤ºcpuä½¿ç”¨ç‡æœ€é«˜çš„å‰4ä¸ªè¿›ç¨‹

n + 0ï¼š æ¢å¤é»˜è®¤æ˜¾ç¤ºæœ‰è¿›ç¨‹ä¿¡æ¯

Eï¼šç³»ç»Ÿå†…å­˜å•ä½è½¬æ¢ï¼Œé»˜è®¤KB

eï¼šè¿›ç¨‹å†…å­˜å•ä½è½¬æ¢ï¼Œé»˜è®¤KB

mï¼šç³»ç»Ÿå†…å­˜åˆ©ç”¨ç‡(æŒ‰4ä¸‹æ¢å¤)

tï¼šcpuçš„æ€»ä½¿ç”¨ç‡

s\d + 1 ï¼š è®¾ç½®æ•°æ®æ›´æ–°æ—¶é—´ä¸º1ç§’,é»˜è®¤ä¸º3ç§’

top -H -p è¿›ç¨‹id ï¼š æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ä¸‹çš„çº¿ç¨‹  https://linux.cn/article-5633-1.html

---

## pidstat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://sebastien.godard.pagesperso-orange.fr/man_pidstat.html

### å·¥å…·ç”¨é€”

â€‹	pidstat æ˜¯sysstatå·¥å…·çš„ ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äº**ç›‘æ§å…¨éƒ¨æˆ–æŒ‡å®šè¿›ç¨‹çš„cpuã€å†…å­˜ã€çº¿ç¨‹ã€è®¾å¤‡ioç­‰ç³»ç»Ÿèµ„æºå ç”¨æƒ…å†µï¼Œä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä¿¡æ¯**ã€‚

**å®˜æ–¹ï¼š**reports statistics for Linux tasks (processes) : I/O, CPU, memory, etc. æ˜¾ç¤ºæŠ¥å‘ŠLinuxä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰çš„ç»Ÿè®¡ä¿¡æ¯ï¼šI / Oï¼ŒCPUï¼Œå†…å­˜ç­‰ã€‚

æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¿›ç¨‹æ€§èƒ½åˆ†æå·¥å…·ï¼Œç”¨æ¥å®æ—¶æŸ¥çœ‹è¿›ç¨‹çš„CPUã€å†…å­˜ã€I/Oä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰æŒ‡æ ‡

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ pidstat --help
ç”¨æ³•ï¼špidstat [ é€‰é¡¹ ] [ <æ—¶é—´é—´éš”> [ <è®¡æ•°> ] ] [ -e <ç¨‹åº> <å‚æ•°> ]
é€‰é¡¹ï¼š
[ -d ] [ -H ] [ -h ] [ -I ] [ -l ] [ -R ] [ -r ] [ -s ] [ -t ] [ -U [ <ç”¨æˆ·å> ] ]
[ -u ] [ -V ] [ -v ] [ -w ] [ -C <å‘½ä»¤> ] [ -G <è¿›ç¨‹å> ]
[ -p { <pid> [,...] | SELF | ALL } ] [ -T { TASK | CHILD | ALL } ]
[ --dec={ 0 | 1 | 2 } ] [ --human ]

```

### å¸®åŠ©è¯´æ˜

| å‚æ•°                 | ç”¨æˆ·è§£é‡Š                                                     |
| -------------------- | ------------------------------------------------------------ |
| -u                   | é»˜è®¤å‚æ•°ï¼Œæ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„cpuä½¿ç”¨ç»Ÿè®¡                          |
| -r                   | æ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ç»Ÿè®¡                                   |
| -d                   | æ˜¾ç¤ºå„ä¸ªè¿›ç¨‹çš„ioä½¿ç”¨æƒ…å†µ                                     |
| -p                   | æŒ‡å®šè¿›ç¨‹å·                                                   |
| -w                   | **æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢**æƒ…å†µ                             |
| -t                   | æ˜¾ç¤ºé€‰æ‹©**ä»»åŠ¡çš„çº¿ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯**å¤–çš„é¢å¤–ä¿¡æ¯                 |
| -T{TASK\|CHILD\|ALL} | TASK è¡¨ç¤ºæŠ¥å‘Šç‹¬ç«‹çš„taskã€CHILDè¡¨ç¤ºè¿›ç¨‹ä¸‹æ‰€æœ‰è¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒALLè¡¨ç¤ºæŠ¥å‘Šç‹¬ç«‹çš„taskå’Œå®ƒä¸‹é¢çš„æ‰€æœ‰çº¿ç¨‹ã€‚ |
| -l                   | åœ¨SMPç¯å¢ƒï¼Œè¡¨ç¤ºä»»åŠ¡çš„cpuçš„ä½¿ç”¨ç‡/å†…æ ¸æ•°é‡                    |
|                      |                                                              |

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹1ï¼š

```shell
pidstat -u -p ALL
```

æ¡ˆä¾‹2ï¼š

```sh
pidstat -u 1
# æ¯éš”1ç§’è¾“å‡ºå½“å‰ç³»ç»Ÿè¿›ç¨‹ã€cpuæ•°æ®
```

æ¡ˆä¾‹3ï¼š

```sh
pidstat -p 5547 -d 1
# æŒ‡å®šè¿›ç¨‹5547ï¼Œæ¯1ç§’æ›´æ–°ä¸€æ¬¡ioæ•°æ®
```



---

## uptime

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ uptime --help

Usage:
 uptime [options]

Options:
 -p, --pretty   show uptime in pretty format
 -h, --help     display this help and exit
 -s, --since    system up since
 -V, --version  output version information and exit

```

### å¸®åŠ©è¯´æ˜

| å‚æ•°         | ç”¨æ³•è§£é‡Š             |
| ------------ | -------------------- |
| -p, --pretty | æ˜¾ç¤ºç³»ç»Ÿå¯åŠ¨è¿è¡Œæ—¶é•¿ |
| -s, --since  | æ˜¾ç¤ºç³»ç»Ÿå¯åŠ¨çš„æ—¶é—´ç‚¹ |

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹1ï¼š uptime

æ¡ˆä¾‹2ï¼š watch -d uptime

---

## watch

### æ¨èæŒ‡æ•°	â˜…â˜…

### å‚è€ƒ

https://man.linuxde.net/watch

### å·¥å…·ç”¨é€”

â€‹	ä»¥å‘¨æœŸæ€§çš„æ–¹å¼æ‰§è¡Œç»™å®šçš„æŒ‡ä»¤ï¼ŒæŒ‡ä»¤è¾“å‡ºä»¥å…¨å±æ–¹å¼æ˜¾ç¤ºã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ watch --help

Usage:
 watch [options] command

Options:
  -b, --beep             beep if command has a non-zero exit
  -c, --color            interpret ANSI color and style sequences
  -d, --differences[=<permanent>]
                         highlight changes between updates
  -e, --errexit          exit if command has a non-zero exit
  -g, --chgexit          exit when output from command changes
  -n, --interval <secs>  seconds to wait between updates
  -p, --precise          attempt run command in precise intervals
  -t, --no-title         turn off header
  -x, --exec             pass command to exec instead of "sh -c"

 -h, --help     display this help and exit
 -v, --version  output version information and exit

```

### å¸®åŠ©è¯´æ˜

| å‚æ•°                                   | ç”¨æ³•è§£é‡Š                     |
| -------------------------------------- | ---------------------------- |
| -n, --interval <secs>                  | æŒ‡å®šæŒ‡ä»¤æ‰§è¡Œçš„é—´éš”æ—¶é—´(ç§’)   |
| -d, --differences[=<permanent>]        | é«˜äº®æ˜¾ç¤ºæŒ‡ä»¤è¾“å‡ºä¿¡æ¯ä¸åŒä¹‹å¤„ |
| -t, --no-title         turn off header | ä¸æ˜¾ç¤ºæ ‡é¢˜                   |

### æ¡ˆä¾‹å®æ“

æŸ¥çœ‹uptimeä¿¡æ¯ï¼š`watch -d uptime`

```
watch uptime
watch -t uptime
watch -d -n 1 netstat -ntlp
watch -d 'ls -l | fgrep goface'	//æ£€æµ‹gofaceçš„æ–‡ä»¶
watch -t -differences=cumulative uptime
watch -n 60 from 	//ç›‘æ§mail
watch -n 1 'df -i;df'	// æ£€æµ‹ç£ç›˜inodeå’Œblockæ•°ç›®å˜åŒ–æƒ…å†µ
```



---

## mpstat

###  æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://www.cnblogs.com/chengd/p/10914037.html

â€‹	http://sebastien.godard.pagesperso-orange.fr/man_mpstat.html

### å·¥å…·ç”¨é€”

 mpstat æ˜¯**ä¸€ä¸ªå®æ—¶ç›‘æ§å·¥å…·ï¼Œä¸»è¦æŠ¥å‘Šä¸cpuç›¸å…³ç»Ÿè®¡ä¿¡æ¯**ï¼Œä¿¡æ¯å­˜æ”¾åœ¨/proc/statæ–‡ä»¶ä¸­ã€‚

**å®˜æ–¹ï¼š**reports individual or combined processor related statistics.æ˜¾ç¤ºæŠ¥å‘Šå•ä¸ªæˆ–ç»„åˆçš„å¤„ç†å™¨ç›¸å…³ç»Ÿè®¡ä¿¡æ¯ã€‚

æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å¤šæ ¸CPUæ€§èƒ½åˆ†æå·¥å…·ï¼Œç”¨æ¥å®æ—¶æŸ¥çœ‹æ¯ä¸ªCPUçš„æ€§èƒ½æŒ‡æ ‡ï¼Œä»¥åŠæ‰€æœ‰CPUçš„å¹³å‡æŒ‡æ ‡

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ man mpstat
NAME
       mpstat - Report processors related statistics.

SYNOPSIS
       mpstat [ -A ] [ --dec={ 0 | 1 | 2 } ] [ -n ] [ -u ] [ -T ] [ -V ] [ -I { keyword [,...] | ALL } ] [ -N { node_list | ALL } ] [ -o JSON ] [ -P { cpu_list | ALL } ] [ interval [ count ] ]

DESCRIPTION
       The  mpstat  command writes to standard output activities for each available processor, processor 0 being the first one.  Global average activities among all processors are also reported.  The mpstat command can be used both on SMP and UP machines, but in the latter, only global average activities will be printed. If no activity has been selected, then the default report is the CPU utilization report.
       mpstatå‘½ä»¤å°†æ¯ä¸ªå¯ç”¨å¤„ç†å™¨çš„æ ‡å‡†è¾“å‡ºæ´»åŠ¨å†™å…¥å…¶ä¸­ï¼Œå¤„ç†å™¨0ä¸ºç¬¬ä¸€ä¸ªã€‚ è¿˜æŠ¥å‘Šäº†æ‰€æœ‰å¤„ç†å™¨ä¹‹é—´çš„å…¨å±€å¹³å‡æ´»è·ƒæƒ…å†µã€‚  mpstatå‘½ä»¤å¯ä»¥åœ¨SMPå’ŒUPè®¡ç®—æœºä¸Šä½¿ç”¨ï¼Œä½†æ˜¯åœ¨åè€…ä¸­ï¼Œä»…æ‰“å°å…¨å±€å¹³å‡æ´»åŠ¨ã€‚ å¦‚æœæœªé€‰æ‹©ä»»ä½•æ´»åŠ¨ï¼Œåˆ™é»˜è®¤æŠ¥å‘Šä¸ºCPUåˆ©ç”¨ç‡æŠ¥å‘Šã€‚

       The interval parameter specifies the amount of time in seconds between each report.  A value of 0 (or no parameters at all) indicates that processors statistics are to be reported for the time since system startup  (boot).
       intervalå‚æ•°æŒ‡å®šæ¯ä¸ªæŠ¥å‘Šä¹‹é—´çš„æ—¶é—´é—´éš”ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚ å€¼0ï¼ˆæˆ–å®Œå…¨æ²¡æœ‰å‚æ•°ï¼‰æŒ‡ç¤ºè‡ªç³»ç»Ÿå¯åŠ¨ï¼ˆå¼•å¯¼ï¼‰ä»¥æ¥çš„æ—¶é—´å†…è¦æŠ¥å‘Šå¤„ç†å™¨ç»Ÿè®¡ä¿¡æ¯ã€‚
       The  count parameter can be specified in conjunction with the interval parameter if this one is not set to zero. The value of count determines the number of reports generated at interval seconds apart. If the interval parameter is specified without the count parameter, the mpstat command generates reports continuously.å¦‚æœæ­¤å‚æ•°æœªè®¾ç½®ä¸ºé›¶ï¼Œåˆ™å¯ä»¥ä¸countå‚æ•°ä¸€èµ·æŒ‡å®šcountå‚æ•°ã€‚  countçš„å€¼ç¡®å®šé—´éš”é—´éš”ç§’ç”Ÿæˆçš„æŠ¥å‘Šæ•°ã€‚ å¦‚æœæŒ‡å®šäº†intervalå‚æ•°ä½†æœªæŒ‡å®šcountå‚æ•°ï¼Œåˆ™mpstatå‘½ä»¤å°†è¿ç»­ç”ŸæˆæŠ¥å‘Šã€‚

OPTIONS
       -A     This option is equivalent to specifying -n -u -I ALL.  This option also implies specifying -N ALL -P ALL unless these options are explicitly set on the command line. æ­¤é€‰é¡¹ç­‰æ•ˆäºæŒ‡å®š-n -u -I ALLã€‚ è¯¥é€‰é¡¹è¿˜æ„å‘³ç€æŒ‡å®š-N ALL -P ALLï¼Œé™¤éåœ¨å‘½ä»¤è¡Œä¸Šæ˜¾å¼è®¾ç½®äº†è¿™äº›é€‰é¡¹ã€‚

       --dec={ 0 | 1 | 2 }
              Specify the number of decimal places to use (0 to 2, default value is 2).æŒ‡å®šè¦ä½¿ç”¨çš„å°æ•°ä½æ•°ï¼ˆ0åˆ°2ï¼Œé»˜è®¤å€¼ä¸º2ï¼‰

       -I { keyword [,...] | ALL }
              Report interrupts statistics.æŠ¥å‘Šä¸­æ–­ç»Ÿè®¡ä¿¡æ¯ã€‚
              
              Possible keywords are CPU, SCPU, and SUM.å¯èƒ½çš„å…³é”®å­—æ˜¯CPUï¼ŒSCPUå’ŒSUMã€‚
              
              With the CPU keyword, the number of each individual interrupt received per second by the CPU or CPUs is displayed. Interrupts are those listed in /proc/interrupts file.ä½¿ç”¨CPUå…³é”®å­—ï¼Œæ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUæ¯ç§’æ¥æ”¶åˆ°çš„æ¯ä¸ªå•ç‹¬ä¸­æ–­çš„æ•°é‡ã€‚ ä¸­æ–­æ˜¯/ proc / interruptsæ–‡ä»¶ä¸­åˆ—å‡ºçš„ä¸­æ–­ã€‚

              With the SCPU keyword, the number of each individual software interrupt received per second by the CPU or CPUs is displayed. This option works only with  kernels  2.6.31  and  later.  Software  interrupts  are  those  listed  in /proc/softirqs file.ä½¿ç”¨SCPUå…³é”®å­—ï¼Œæ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUæ¯ç§’æ¥æ”¶çš„æ¯ä¸ªè½¯ä»¶ä¸­æ–­çš„æ•°é‡ã€‚ æ­¤é€‰é¡¹ä»…é€‚ç”¨äºå†…æ ¸2.6.31åŠæ›´é«˜ç‰ˆæœ¬ã€‚ è½¯ä»¶ä¸­æ–­æ˜¯/ proc / softirqsæ–‡ä»¶ä¸­åˆ—å‡ºçš„ä¸­æ–­ã€‚

              With the SUM keyword, the mpstat command reports the total number of interrupts per processor.  The following values are displayed:ä½¿ç”¨SUMå…³é”®å­—ï¼Œmpstatå‘½ä»¤æŠ¥å‘Šæ¯ä¸ªå¤„ç†å™¨çš„ä¸­æ–­æ€»æ•°ã€‚ æ˜¾ç¤ºä»¥ä¸‹å€¼

              CPU
                     Processor number. The keyword all indicates that statistics are calculated as averages among all processors.å¤„ç†å™¨ç¼–å·ã€‚ å…³é”®å­—allè¡¨ç¤ºç»Ÿè®¡ä¿¡æ¯æ˜¯æ‰€æœ‰å¤„ç†å™¨ä¹‹é—´çš„å¹³å‡å€¼ã€‚

              intr/s
                     Show the total number of interrupts received per second by the CPU or CPUs.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUæ¯ç§’æ¥æ”¶çš„ä¸­æ–­æ€»æ•°ã€‚

              The ALL keyword is equivalent to specifying all the keywords above and therefore all the interrupts statistics are displayed.ALLå…³é”®å­—ç­‰æ•ˆäºæŒ‡å®šä¸Šé¢çš„æ‰€æœ‰å…³é”®å­—ï¼Œå› æ­¤å°†æ˜¾ç¤ºæ‰€æœ‰ä¸­æ–­ç»Ÿè®¡ä¿¡æ¯ã€‚

       -N { node_list | ALL }
              Indicate  the  NUMA nodes for which statistics are to be reported.  node_list is a list of comma-separated values or range of values (e.g., 0,2,4-7,12-).  Note that node all is the global average among all nodes. The ALL keyword indicates that statistics are to be reported for all nodes.æŒ‡ç¤ºè¦æŠ¥å‘Šå…¶ç»Ÿè®¡ä¿¡æ¯çš„NUMAèŠ‚ç‚¹ã€‚  node_listæ˜¯é€—å·åˆ†éš”å€¼æˆ–å€¼èŒƒå›´ï¼ˆä¾‹å¦‚0ã€2ã€4-7ã€12-ï¼‰çš„åˆ—è¡¨ã€‚ æ³¨æ„ï¼Œæ‰€æœ‰èŠ‚ç‚¹æ˜¯æ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´çš„å…¨å±€å¹³å‡å€¼ã€‚  ALLå…³é”®å­—æŒ‡ç¤ºè¦æŠ¥å‘Šæ‰€æœ‰èŠ‚ç‚¹çš„ç»Ÿè®¡ä¿¡æ¯ã€‚

       -n     Report summary CPU statistics based on NUMA node placement. The following values are displayed:

              NODE
                     Logical NUMA node number. The keyword all indicates that statistics are calculated as averages among all nodes.

              All the other fields are the same as those displayed with option -u (see below).

       -o JSON
              Display the statistics in JSON (Javascript Object Notation) format.  JSON output field order is undefined, and new fields may be added in the future.ä»¥JSONï¼ˆJavaScriptå¯¹è±¡è¡¨ç¤ºæ³•ï¼‰æ ¼å¼æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ã€‚  JSONè¾“å‡ºå­—æ®µé¡ºåºæœªå®šä¹‰ï¼Œå°†æ¥å¯èƒ½ä¼šæ·»åŠ æ–°å­—æ®µã€‚

       -P { cpu_list | ALL }
              Indicate the processors for which statistics are to be reported.  cpu_list is a list of comma-separated values or range of values (e.g., 0,2,4-7,12-).  Note that processor 0 is the first  processor,  and  processor  all  is  the  global average among all processors.  The ALL keyword indicates that statistics are to be reported for all processors.  Offline processors are not displayed. æŒ‡ç¤ºè¦æŠ¥å‘Šå…¶ç»Ÿè®¡ä¿¡æ¯çš„å¤„ç†å™¨ã€‚  cpu_listæ˜¯é€—å·åˆ†éš”å€¼æˆ–å€¼èŒƒå›´ï¼ˆä¾‹å¦‚0ã€2ã€4-7ã€12-ï¼‰çš„åˆ—è¡¨ã€‚ è¯·æ³¨æ„ï¼Œå¤„ç†å™¨0æ˜¯ç¬¬ä¸€ä¸ªå¤„ç†å™¨ï¼Œæ‰€æœ‰å¤„ç†å™¨æ˜¯æ‰€æœ‰å¤„ç†å™¨ä¹‹é—´çš„å…¨å±€å¹³å‡å€¼ã€‚  ALLå…³é”®å­—æŒ‡ç¤ºè¦æŠ¥å‘Šæ‰€æœ‰å¤„ç†å™¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ ä¸æ˜¾ç¤ºè„±æœºå¤„ç†å™¨ã€‚

       -T     Display topology elements in the CPU report (see option -u below). The following elements are displayed:

              CORE
                     Logical core number.

              SOCK
                     Logical socket number.

              NODE
                     Logical NUMA node number.

       -u     Report CPU utilization. The following values are displayed:

              CPU
                     Processor number. The keyword all indicates that statistics are calculated as averages among all processors.
                   
              %usr
                     Show the percentage of CPU utilization that occurred while executing at the user level (application).æ˜¾ç¤ºåœ¨ç”¨æˆ·çº§åˆ«ï¼ˆåº”ç”¨ç¨‹åºï¼‰æ‰§è¡Œæ—¶å‘ç”Ÿçš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚

              %nice
                     Show the percentage of CPU utilization that occurred while executing at the user level with nice priority.æ˜¾ç¤ºåœ¨ç”¨æˆ·çº§åˆ«æ‰§è¡Œæ—¶å…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚

              %sys
                     Show the percentage of CPU utilization that occurred while executing at the system level (kernel). Note that this does not include time spent servicing hardware and software interrupts.æ˜¾ç¤ºåœ¨ç³»ç»Ÿçº§åˆ«ï¼ˆå†…æ ¸ï¼‰æ‰§è¡Œæ—¶å‘ç”Ÿçš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚ è¯·æ³¨æ„ï¼Œè¿™ä¸åŒ…æ‹¬èŠ±åœ¨ç»´ä¿®ç¡¬ä»¶å’Œè½¯ä»¶ä¸­æ–­ä¸Šçš„æ—¶é—´ã€‚

              %iowait
                     Show the percentage of time that the CPU or CPUs were idle during which the system had an outstanding disk I/O request.æ˜¾ç¤ºåœ¨ç³»ç»Ÿæœ‰æœªå®Œæˆçš„ç£ç›˜I / Oè¯·æ±‚æœŸé—´ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªCPUç©ºé—²çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

              %irq
                     Show the percentage of time spent by the CPU or CPUs to service hardware interrupts.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUæœåŠ¡ç¡¬ä»¶ä¸­æ–­æ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

              %soft
                     Show the percentage of time spent by the CPU or CPUs to service software interrupts.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUæœåŠ¡è½¯ä»¶ä¸­æ–­æ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

              %steal
                     Show the percentage of time spent in involuntary wait by the virtual CPU or CPUs while the hypervisor was servicing another virtual processor.æ˜¾ç¤ºåœ¨ç®¡ç†ç¨‹åºä¸ºå¦ä¸€ä¸ªè™šæ‹Ÿå¤„ç†å™¨æä¾›æœåŠ¡æ—¶ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹ŸCPUåœ¨éè‡ªæ„¿ç­‰å¾…ä¸­èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

              %guest
                     Show the percentage of time spent by the CPU or CPUs to run a virtual processor.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUè¿è¡Œè™šæ‹Ÿå¤„ç†å™¨æ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

              %gnice
                     Show the percentage of time spent by the CPU or CPUs to run a niced guest.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUè¿è¡Œä¸€ä¸ªguestç”¨æˆ·ä¼˜å…ˆçº§åˆ‡æ¢æ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚
 
              %idle
                     Show the percentage of time that the CPU or CPUs were idle and the system did not have an outstanding disk I/O request.æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªCPUç©ºé—²ä¸”ç³»ç»Ÿæ²¡æœ‰æœªå®Œæˆçš„ç£ç›˜I / Oè¯·æ±‚çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

       -V     Print version number then exit.

ENVIRONMENT
       The mpstat command takes into account the following environment variable:

       S_COLORS
              When this variable is set, display statistics in color on the terminal.  Possible values for this variable are never, always or auto (the latter is the default).

              Please note that the color (being red, yellow, or some other color) used to display a value is not indicative of any kind of issue simply because of the color. It only indicates different ranges of values.

       S_COLORS_SGR
              Specify the colors and other attributes used to display statistics on the terminal.  Its value is a colon-separated list of capabilities that defaults to H=31;1:I=32;22:M=35;1:N=34;1:Z=34;22.  Supported capabilities are:

              H=     SGR (Select Graphic Rendition) substring for percentage values greater than or equal to 75%.

              I=     SGR substring for CPU number.

              M=     SGR substring for percentage values in the range from 50% to 75%.

              N=     SGR substring for non-zero statistics values.

              Z=     SGR substring for zero values.

       S_TIME_FORMAT
              If this variable exists and its value is ISO then the current locale will be ignored when printing the date in the report header.  The mpstat command will use the ISO 8601 format (YYYY-MM-DD) instead.  The timestamp will also be compliant with ISO 8601 format.

EXAMPLES
       mpstat 2 5
              Display five reports of global statistics among all processors at two second intervals.

       mpstat -P ALL 2 5
              Display five reports of statistics for all processors at two second intervals.

BUGS
       /proc filesystem must be mounted for the mpstat command to work.

FILES
       /proc contains various files with system statistics.

AUTHOR
       Sebastien Godard (sysstat <at> orange.fr)


```

### å¸®åŠ©è¯´æ˜

ã€€ã€€-Aï¼š ç­‰åŒäº -u -I ALL -P ALL

ã€€ã€€-uï¼š æŠ¥å‘ŠCPUåˆ©ç”¨ç‡ã€‚å°†æ˜¾ç¤ºä»¥ä¸‹å€¼

ã€€ã€€ã€€ã€€CPU: å¤„ç†å™¨ç¼–å·ã€‚å…³é”®å­—allè¡¨ç¤ºç»Ÿè®¡ä¿¡æ¯è®¡ç®—ä¸ºæ‰€æœ‰å¤„ç†å™¨ä¹‹é—´çš„å¹³å‡å€¼ã€‚

ã€€ã€€ã€€ã€€ï¼…usr: æ˜¾ç¤ºåœ¨ç”¨æˆ·çº§ï¼ˆåº”ç”¨ç¨‹åºï¼‰æ‰§è¡Œæ—¶å‘ç”Ÿçš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚

ã€€ã€€ã€€ã€€ï¼…nice: æ˜¾ç¤ºä»¥ä¼˜å…ˆçº§è¾ƒé«˜çš„ç”¨æˆ·çº§åˆ«æ‰§è¡Œæ—¶å‘ç”Ÿçš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚

ã€€ã€€ã€€ã€€ï¼…sys: æ˜¾ç¤ºåœ¨ç³»ç»Ÿçº§ï¼ˆå†…æ ¸ï¼‰æ‰§è¡Œæ—¶å‘ç”Ÿçš„CPUåˆ©ç”¨ç‡ç™¾åˆ†æ¯”ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸åŒ…æ‹¬ç»´æŠ¤ç¡¬ä»¶å’Œè½¯ä»¶çš„æ—¶é—´ä¸­æ–­ã€‚

ã€€ã€€ã€€ã€€ï¼…iowait: æ˜¾ç¤ºç³»ç»Ÿå…·æœ‰æœªå®Œæˆç£ç›˜I / Oè¯·æ±‚çš„CPUæˆ–CPUç©ºé—²çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

ã€€ã€€ã€€ã€€**ï¼…irq: æ˜¾ç¤ºCPUæˆ–CPUç”¨äºæœåŠ¡ç¡¬ä»¶ä¸­æ–­çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚**

ã€€ã€€ã€€ã€€**%soft: æ˜¾ç¤ºCPUæˆ–CPUç”¨äºæœåŠ¡è½¯ä»¶ä¸­æ–­çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚**

ã€€ã€€ã€€ã€€**%steal: æ˜¾ç¤ºè™šæ‹ŸCPUæˆ–CPUåœ¨ç®¡ç†ç¨‹åºä¸ºå¦ä¸€ä¸ªè™šæ‹Ÿå¤„ç†å™¨æä¾›æœåŠ¡æ—¶éè‡ªæ„¿ç­‰å¾…çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚**

ã€€ã€€ã€€ã€€%guest: æ˜¾ç¤ºCPUæˆ–CPUè¿è¡Œè™šæ‹Ÿå¤„ç†å™¨æ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

ã€€ã€€ã€€ã€€%gnice: æ˜¾ç¤ºCPUæˆ–CPUè¿è¡Œnicedå®¢æˆ·æœºæ‰€èŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

ã€€ã€€ã€€ã€€%idle: æ˜¾ç¤ºCPUæˆ–CPUç©ºé—²ä¸”ç³»ç»Ÿæ²¡æœ‰æœªå®Œæˆçš„ç£ç›˜I / Oè¯·æ±‚çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚

ã€€ã€€-V ï¼š æ‰“å°ç‰ˆæœ¬å·ï¼Œç„¶åé€€å‡º

ã€€ã€€-I {SUM | CPU | ALL} ï¼šæŠ¥å‘Šä¸­æ–­ç»Ÿè®¡ä¿¡æ¯ã€‚ ä½¿ç”¨SUMå…³é”®å­—ï¼Œmpstatå‘½ä»¤æŠ¥å‘Šæ¯ä¸ªå¤„ç†å™¨çš„ä¸­æ–­æ€»æ•°ã€‚ä½¿ç”¨CPUå…³é”®å­—ï¼Œæ˜¾ç¤ºCPUæˆ–CPUæ¯ç§’æ¥æ”¶çš„æ¯ä¸ªä¸­æ–­çš„æ•°é‡ã€‚ALLå…³é”®å­—ç­‰æ•ˆäºæŒ‡å®šä¸Šé¢çš„æ‰€æœ‰å…³é”®å­—ï¼Œå› æ­¤æ˜¾ç¤ºæ‰€æœ‰ä¸­æ–­ç»Ÿè®¡ä¿¡æ¯ã€‚

ã€€ã€€intervalï¼šæŒ‡å®šæ¯ä¸ªæŠ¥å‘Šä¹‹é—´çš„æ—¶é—´ï¼ˆä¸æŒ‡å®šcountåˆ™æŒç»­ç”ŸæˆæŠ¥å‘Šï¼‰

ã€€ã€€countï¼šæŒ‡å®šç”ŸæˆæŠ¥å‘Šæ•°é‡

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹1ï¼š

`mpstat -P ALL 3`	3ç§’é’Ÿè·å–ä¸€æ¬¡æ•°æ®

---

## iostat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://sebastien.godard.pagesperso-orange.fr/man_iostat.html

https://www.cnblogs.com/ocp-100/articles/10649306.html

### å·¥å…·ç”¨é€”

**å®˜æ–¹ï¼š**reports CPU statistics and input/output statistics for devices, partitions and network filesystems.æ˜¾ç¤ºè®¾å¤‡ï¼Œåˆ†åŒºå’Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿçš„CPUç»Ÿè®¡ä¿¡æ¯å’Œè¾“å…¥/è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ã€‚The **iostat** command is used for monitoring system input/output device loading by observing the time the devices are active in relation to their average transfer rates. The **iostat** command generates reports that can be used to change system configuration to better balance the input/output load between physical disks. 

### å·¥å…·å®‰è£…

centos7å®‰è£…:  sudo yum install sysstat -y

### å¸®åŠ©ä¿¡æ¯

```shell
$ iostat --help
ç”¨æ³•: iostat [ é€‰é¡¹ ] [ <æ—¶é—´é—´éš”> [ <æ¬¡æ•°> ] ]
é€‰é¡¹ï¼š
[ -c ] [ -d ] [ -h ] [ -k | -m ] [ -N ] [ -s ] [ -t ] [ -V ] [ -x ] [ -y ] [ -z ]
[ { -f | +f } <ç›®å½•> ] [ -j { ID | LABEL | PATH | UUID | ... } ]
[ --dec={ 0 | 1 | 2 } ] [ --human ] [ -o JSON ]
[ [ -H ] -g <ç”¨æˆ·ç»„å> ] [ -p [ <è®¾å¤‡> [,...] | ALL ] ]
[ <è®¾å¤‡> [...] | ALL ]
       iostat - Report Central Processing Unit (CPU) statistics and input/output statistics for devices and partitions.

SYNOPSIS
       iostat  [ -c ] [ -d ] [ -h ] [ -k | -m ] [ -N ] [ -s ] [ -t ] [ -V ] [ -x ] [ -y ] [ -z ] [ --dec={ 0 | 1 | 2 } ] [ -j { ID | LABEL | PATH | UUID | ... } ] [ -o JSON ] [ [ -H ] -g group_name ] [ --human ] [ -p [ device [,...] | ALL ] ]
       [ device [...] | ALL ] [ interval [ count ] ]

DESCRIPTION
       The iostat command is used for monitoring system input/output device loading by observing the time the devices are active in relation to their average transfer rates. The iostat command generates reports that can be used to change system configuration to better balance the input/output load between physical disks.iostatå‘½ä»¤ç”¨äºé€šè¿‡è§‚å¯Ÿè®¾å¤‡æ´»åŠ¨çš„æ—¶é—´ï¼ˆç›¸å¯¹äºå…¶å¹³å‡ä¼ è¾“é€Ÿç‡ï¼‰æ¥ç›‘è§†ç³»ç»Ÿè¾“å…¥/è¾“å‡ºè®¾å¤‡è´Ÿè½½ã€‚  iostatå‘½ä»¤ç”Ÿæˆå¯ç”¨äºæ›´æ”¹ç³»ç»Ÿé…ç½®çš„æŠ¥å‘Šï¼Œä»¥æ›´å¥½åœ°å¹³è¡¡ç‰©ç†ç£ç›˜ä¹‹é—´çš„è¾“å…¥/è¾“å‡ºè´Ÿè½½ã€‚

       The  first  report  generated by the iostat command provides statistics concerning the time since the system was booted, unless the -y option is used (in this case, this first report is omitted).  Each subsequent report covers the time
       since the previous report. All statistics are reported each time the iostat command is run. The report consists of a CPU header row followed by a row of CPU statistics. On multiprocessor systems, CPU statistics are  calculated  system-
       wide as averages among all processors. A device header row is displayed followed by a line of statistics for each device that is configured.

       The interval parameter specifies the amount of time in seconds between each report. The count parameter can be specified in conjunction with the interval parameter. If the count parameter is specified, the value of count determines the
       number of reports generated at interval seconds apart. If the interval parameter is specified without the count parameter, the iostat command generates reports continuously.

REPORTS
       The iostat command generates two types of reports, the CPU Utilization report and the Device Utilization report.

       CPU Utilization Report  cpuä½¿ç”¨ç‡æŠ¥å‘Š
              The first report generated by the iostat command is the CPU Utilization Report. For multiprocessor systems, the CPU values are global averages among all processors.  The report has the following format:

              %user
                     Show the percentage of CPU utilization that occurred while executing at the user level (application).

              %nice
                     Show the percentage of CPU utilization that occurred while executing at the user level with nice priority.

              %system
                     Show the percentage of CPU utilization that occurred while executing at the system level (kernel).

              %iowait
                     Show the percentage of time that the CPU or CPUs were idle during which the system had an outstanding disk I/O request.

              %steal
                     Show the percentage of time spent in involuntary wait by the virtual CPU or CPUs while the hypervisor was servicing another virtual processor.

              %idle
                     Show the percentage of time that the CPU or CPUs were idle and the system did not have an outstanding disk I/O request.

       Device Utilization Report   ç£ç›˜ä½¿ç”¨ç‡æŠ¥å‘Š
              The second report generated by the iostat command is the Device Utilization Report. The device report provides statistics on a per physical device or partition basis. Block devices and partitions for which statistics are  to  be
              displayed may be entered on the command line.  If no device nor partition is entered, then statistics are displayed for every device used by the system, and providing that the kernel maintains statistics for it.  If the ALL keyâ€
              word is given on the command line, then statistics are displayed for every device defined by the system, including those that have never been used.  Transfer rates are shown in 1K blocks by default, unless the environment  variâ€
              able POSIXLY_CORRECT is set, in which case 512-byte blocks are used.  The report may show the following fields, depending on the flags used:

              Device:
                     This column gives the device (or partition) name as listed in the /dev directory.

              tps
                     Indicate  the  number of transfers per second that were issued to the device. A transfer is an I/O request to the device. Multiple logical requests can be combined into a single I/O request to the device. A transfer is of
                     indeterminate size.

              Blk_read/s (kB_read/s, MB_read/s)
                     Indicate the amount of data read from the device expressed in a number of blocks (kilobytes, megabytes) per second. Blocks are equivalent to sectors and therefore have a size of 512 bytes.

              Blk_wrtn/s (kB_wrtn/s, MB_wrtn/s)
                     Indicate the amount of data written to the device expressed in a number of blocks (kilobytes, megabytes) per second.

              Blk_dscd/s (kB_dscd/s, MB_dscd/s)
                     Indicate the amount of data discarded for the device expressed in a number of blocks (kilobytes, megabytes) per second.

              Blk_read (kB_read, MB_read)
                     The total number of blocks (kilobytes, megabytes) read.

              Blk_wrtn (kB_wrtn, MB_wrtn)
                     The total number of blocks (kilobytes, megabytes) written.

              Blk_dscd (kB_dscd, MB_dscd)
                     The total number of blocks (kilobytes, megabytes) discarded.

              r/s
                     The number (after merges) of read requests completed per second for the device.

              w/s
                     The number (after merges) of write requests completed per second for the device.

              d/s
                     The number (after merges) of discard requests completed per second for the device.

              f/s
                     The number (after merges) of flush requests completed per second for the device.  This counts flush requests executed by disks. Flush requests are not tracked for partitions.  Before being  merged,  flush  operations  are
                     counted as writes.

              sec/s (kB/s, MB/s)
                     The number of sectors (kilobytes, megabytes) read from, written to or discarded for the device per second.

              rsec/s (rkB/s, rMB/s)
                     The number of sectors (kilobytes, megabytes) read from the device per second.

              wsec/s (wkB/s, wMB/s)
                     The number of sectors (kilobytes, megabytes) written to the device per second.

              dsec/s (dkB/s, dMB/s)
                     The number of sectors (kilobytes, megabytes) discarded for the device per second.

              rqm/s
                     The number of I/O requests merged per second that were queued to the device.

              rrqm/s
                     The number of read requests merged per second that were queued to the device.

              wrqm/s
                     The number of write requests merged per second that were queued to the device.

              drqm/s
                     The number of discard requests merged per second that were queued to the device.

              %rrqm
                     The percentage of read requests merged together before being sent to the device.

              %wrqm
                     The percentage of write requests merged together before being sent to the device.

              %drqm
                     The percentage of discard requests merged together before being sent to the device.

              areq-sz
                     The average size (in kilobytes) of the I/O requests that were issued to the device.
                     Note: In previous versions, this field was known as avgrq-sz and was expressed in sectors.

              rareq-sz
                     The average size (in kilobytes) of the read requests that were issued to the device.

              wareq-sz
                     The average size (in kilobytes) of the write requests that were issued to the device.

              dareq-sz
                     The average size (in kilobytes) of the discard requests that were issued to the device.

              await
                     The average time (in milliseconds) for I/O requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.

              r_await
                     The average time (in milliseconds) for read requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.


              w_await
                     The average time (in milliseconds) for write requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.

              d_await
                     The average time (in milliseconds) for discard requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.

              f_await
                     The average time (in milliseconds) for flush requests issued to the device to be served.  The block layer combines flush requests and executes at most one at a time.  Thus flush operations could be twice as long: Wait for
                     current flush request, then execute it, then wait for the next one.

              aqu-sz
                     The average queue length of the requests that were issued to the device.
                     Note: In previous versions, this field was known as avgqu-sz.

              %util
                     Percentage of elapsed time during which I/O requests were issued to the device (bandwidth utilization for the device). Device saturation occurs when this value is close to 100% for devices serving requests serially.   But
                     for devices serving requests in parallel, such as RAID arrays and modern SSDs, this number does not reflect their performance limits.

OPTIONS
       -c     Display the CPU utilization report.	æ˜¾ç¤ºCPUä½¿ç”¨ç‡æŠ¥å‘Š

       -d     Display the device utilization report. æ˜¾ç¤ºè®¾å¤‡ä½¿ç”¨ç‡æŠ¥å‘Š

       --dec={ 0 | 1 | 2 }
              Specify the number of decimal places to use (0 to 2, default value is 2).


       -g group_name { device [...] | ALL }
              Display  statistics  for  a group of devices.  The iostat command reports statistics for each individual device in the list then a line of global statistics for the group displayed as group_name and made up of all the devices in
              the list. The ALL keyword means that all the block devices defined by the system shall be included in the group.

       -H     This option must be used with option -g and indicates that only global statistics for the group are to be displayed, and not statistics for individual devices in the group.

       -h     Make the Device Utilization Report easier to read by a human.  --human is enabled implicitly with this option.

       --human
              Print sizes in human readable format (e.g. 1.0k, 1.2M, etc.)  The units displayed with this option supersede any other default units (e.g.  kilobytes, sectors...) associated with the metrics.

       -j { ID | LABEL | PATH | UUID | ... } [ device [...] | ALL ]
              Display persistent device names. Options ID, LABEL, etc. specify the type of the persistent name. These options are not limited, only prerequisite is that directory  with  required  persistent  names  is  present  in  /dev/disk.
              Optionally, multiple devices can be specified in the chosen persistent name type.  Because persistent device names are usually long, option

       -k     Display statistics in kilobytes per second.	ä»¥æ¯ç§’åƒå­—èŠ‚æ˜¾ç¤ºç»Ÿè®¡æŠ¥å‘Š

       -m     Display statistics in megabytes per second.	ä»¥æ¯ç§’å…†å­—èŠ‚æ˜¾ç¤ºç»Ÿè®¡æŠ¥å‘Š

       -N     Display the registered device mapper names for any device mapper devices.  Useful for viewing LVM2 statistics.

       -o JSON
              Display the statistics in JSON (Javascript Object Notation) format.  JSON output field order is undefined, and new fields may be added in the future.

       -p [ { device [,...] | ALL } ]
              The  -p  option displays statistics for block devices and all their partitions that are used by the system.  If a device name is entered on the command line, then statistics for it and all its partitions are displayed. Last, the
              ALL keyword indicates that statistics have to be displayed for all the block devices and partitions defined by the system, including those that have never been used. If option -j is defined before this option, devices entered on
              the command line can be specified with the chosen persistent name type.

       -s     Display a short (narrow) version of the report that should fit in 80 characters wide screens.

       -t     Print the time for each report displayed. The timestamp format may depend on the value of the S_TIME_FORMAT environment variable (see below).

       -V     Print version number then exit.

       -x     Display extended statistics.

       -y     Omit first report with statistics since system boot, if displaying multiple records at given interval.

       -z     Tell iostat to omit output for any devices for which there was no activity during the sample period.

EXAMPLES
       iostat
              Display a single history since boot report for all CPU and Devices.è‡ªå¯åŠ¨æŠ¥å‘Šä»¥æ¥ï¼Œæ˜¾ç¤ºæ‰€æœ‰CPUå’Œè®¾å¤‡çš„å•ä¸ªå†å²è®°å½•ã€‚

       iostat -d 2
              Display a continuous device report at two second intervals.

       iostat -d 2 6
              Display six reports at two second intervals for all devices.

       iostat -x sda sdb 2 6
              Display six reports of extended statistics at two second intervals for devices sda and sdb.

       iostat -p sda 2 6
              Display six reports at two second intervals for device sda and all its partitions (sda1, etc.)

```

### å¸®åŠ©è¯´æ˜

-dï¼šæ˜¾ç¤ºè®¾å¤‡(ç£ç›˜)ä½¿ç”¨çŠ¶æ€

-kï¼šæŸäº›ä½¿ç”¨blockä¸ºå•ä½çš„åˆ—å¼ºåˆ¶ä½¿ç”¨Kilobytesä¸ºå•ä½

### æ¡ˆä¾‹å®æ“

```shell
EXAMPLES
       iostat
              Display a single history since boot report for all CPU and Devices.è‡ªå¯åŠ¨æŠ¥å‘Šä»¥æ¥ï¼Œæ˜¾ç¤ºæ‰€æœ‰CPUå’Œè®¾å¤‡çš„å•ä¸ªå†å²è®°å½•ã€‚

       iostat -d 2
              Display a continuous device report at two second intervals.æ¯ä¸¤ç§’æ˜¾ç¤ºä¸€æ¬¡è¿ç»­çš„è®¾å¤‡æŠ¥å‘Šã€‚

       iostat -d 2 6
              Display six reports at two second intervals for all devices. å¯¹äºæ‰€æœ‰è®¾å¤‡ï¼Œæ¯éš”ä¸¤ç§’æ˜¾ç¤ºå…­ä¸ªæŠ¥å‘Šã€‚

       iostat -x sda sdb 2 6
              Display six reports of extended statistics at two second intervals for devices sda and sdb.ä»¥ä¸¤ç§’ä¸ºé—´éš”æ˜¾ç¤ºè®¾å¤‡sdaå’Œsdbçš„å…­ä¸ªæ‰©å±•ç»Ÿè®¡ä¿¡æ¯æŠ¥å‘Šã€‚

       iostat -p sda 2 6
              Display six reports at two second intervals for device sda and all its partitions (sda1, etc.)ä»¥ä¸¤ç§’çš„é—´éš”æ˜¾ç¤ºå…­ä¸ªå…³äºè®¾å¤‡sdaåŠå…¶æ‰€æœ‰åˆ†åŒºï¼ˆsda1ç­‰ï¼‰çš„æŠ¥å‘Šã€‚
```

æ¡ˆä¾‹ï¼š iostat -dx 5

![iostat-01](image/iostat-01.png)

ç¬¬ä¸€è¡Œæ˜¾ç¤ºçš„æ˜¯è‡ªç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„å¹³å‡å€¼ï¼Œç„¶åæ˜¾ç¤ºå¢é‡çš„å¹³å‡å€¼ï¼Œæ¯ä¸ªè®¾å¤‡ä¸€è¡Œã€‚

å¸¸è§linuxçš„ç£ç›˜IOæŒ‡æ ‡çš„ç¼©å†™ä¹ æƒ¯ï¼šrqæ˜¯request,ræ˜¯read,wæ˜¯write,quæ˜¯queueï¼Œszæ˜¯size,aæ˜¯verage,tmæ˜¯time,svcæ˜¯serviceã€‚

â–ªrrqm/så’Œwrqm/sï¼šæ¯ç§’åˆå¹¶çš„è¯»å’Œå†™è¯·æ±‚ï¼Œâ€œåˆå¹¶çš„â€æ„å‘³ç€æ“ä½œç³»ç»Ÿä»é˜Ÿåˆ—ä¸­æ‹¿å‡ºå¤šä¸ªé€»è¾‘è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªè¯·æ±‚åˆ°å®é™…ç£ç›˜ã€‚

â–ªr/så’Œw/sï¼šæ¯ç§’å‘é€åˆ°è®¾å¤‡çš„è¯»å’Œå†™è¯·æ±‚æ•°ã€‚

â–ªrsec/så’Œwsec/sï¼šæ¯ç§’è¯»å’Œå†™çš„æ‰‡åŒºæ•°ã€‚

â–ªavgrq â€“szï¼šè¯·æ±‚çš„æ‰‡åŒºæ•°ã€‚

â–ªavgqu â€“szï¼šåœ¨è®¾å¤‡é˜Ÿåˆ—ä¸­ç­‰å¾…çš„è¯·æ±‚æ•°ã€‚

â–ªawaitï¼šæ¯ä¸ªIOè¯·æ±‚èŠ±è´¹çš„æ—¶é—´ã€‚

â–ªsvctmï¼šå®é™…è¯·æ±‚ï¼ˆæœåŠ¡ï¼‰æ—¶é—´ã€‚

â–ª%utilï¼šè‡³å°‘æœ‰ä¸€ä¸ªæ´»è·ƒè¯·æ±‚æ‰€å æ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚

---

## lscpu

### æ¨èæŒ‡æ•°	â˜…â˜…

### å·¥å…·ç”¨é€”

ä»/proc/cpuinfo ä¸­è¯»å–CPUæ•°æ®ï¼Œè§£ææˆæ°¸æ’æ›´å®¹æ˜“ç†è§£å’Œé˜…è¯»çš„ä¿¡æ¯ã€‚

### å‚è€ƒ

https://www.linux-man.cn/command/lscpu

### å·¥å…·å®‰è£…

ç³»ç»Ÿè‡ªå¸¦

### å¸®åŠ©ä¿¡æ¯

```shell
[root@virtual ~]# lscpu --help

ç”¨æ³•ï¼š
 lscpu [é€‰é¡¹]

Display information about the CPU architecture.

é€‰é¡¹ï¼š
 -a, --all               åŒæ—¶æ‰“å°åœ¨çº¿å’Œç¦»çº¿ CPU (-e é€‰é¡¹é»˜è®¤å€¼)
 -b, --online            åªæ‰“å°åœ¨çº¿ CPU (-p é€‰é¡¹é»˜è®¤å€¼)
 -c, --offline           åªæ‰“å°ç¦»çº¿ CPU
 -e, --extended[=<åˆ—è¡¨>] æ‰“å°æ‰©å±•çš„å¯è¯»æ ¼å¼
 -p, --parse[=<åˆ—è¡¨>]    æ‰“å°å¯è§£ææ ¼å¼
 -s, --sysroot <ç›®å½•>    ä»¥æŒ‡å®šç›®å½•ä½œä¸ºç³»ç»Ÿæ ¹ç›®å½•
 -x, --hex               æ‰“å°åå…­è¿›åˆ¶æ©ç è€Œé CPU åˆ—è¡¨
 -y, --physical          print physical instead of logical IDs

 -h, --help     æ˜¾ç¤ºæ­¤å¸®åŠ©å¹¶é€€å‡º
 -V, --version  è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º

å¯ç”¨çš„åˆ—ï¼š
           CPU  é€»è¾‘ CPU æ•°é‡
          CORE  é€»è¾‘æ ¸å¿ƒæ•°é‡
        SOCKET  é€»è¾‘(CPU)åº§æ•°é‡
          NODE  é€»è¾‘ NUMA èŠ‚ç‚¹æ•°é‡
          BOOK  é€»è¾‘ book æ•°
        DRAWER  logical drawer number
         CACHE  shows how caches are shared between CPUs
  POLARIZATION  CPU dispatching mode on virtual hardware
       ADDRESS  physical address of a CPU
    CONFIGURED  shows if the hypervisor has allocated the CPU
        ONLINE  shows if Linux currently makes use of the CPU
        MAXMHZ  shows the maximum MHz of the CPU
        MINMHZ  shows the minimum MHz of the CPU

æ›´å¤šä¿¡æ¯è¯·å‚é˜… lscpu(1)ã€‚
```



### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

```shell
[root@virtual ~]# lscpu -e
CPU NODE SOCKET CORE L1d:L1i:L2:L3 ONLINE
0   0    0      0    0:0:0:0       æ˜¯
1   0    0      1    1:1:1:1       æ˜¯

```



---

## bcc-toolã€å·¥å…·é›†ã€‘

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

centos8 å®‰è£…bccï¼š sudo dnf install bcc-toolsï¼Œ å®‰è£…å®Œæˆåï¼Œåœ¨/usr/share/bcc/tools   ä½†æ˜¯æœ‰å¾ˆå¤šå‘½ä»¤ä¸èƒ½ç”¨ã€‚

centos7 å®‰è£…bccï¼š sudo yum install bcc-tools

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## perf

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://blog.csdn.net/trochiluses/article/details/10261339

http://blog.itpub.net/24585765/viewspace-2564885/

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

centos8ä¸­å®‰è£…ï¼š `sudo dnf install perf -y`

centos7ä¸­å®‰è£…ï¼š sudo yum install perf -y

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

| å‘½ä»¤          | ç”¨æˆ·è¯´æ˜                                                     |
| ------------- | ------------------------------------------------------------ |
| annotate      | è§£æperf recordç”Ÿæˆçš„perf.dataæ–‡ä»¶ï¼Œæ˜¾ç¤ºè¢«æ³¨é‡Šçš„ä»£ç          |
| archive       | æ ¹æ®æ•°æ®æ–‡ä»¶è®°å½•çš„build-idï¼Œå°†æ‰€æœ‰è¢«é‡‡æ ·åˆ°çš„elfæ–‡ä»¶æ‰“åŒ…ï¼Œåˆ©ç”¨æ­¤å‹ç¼©åŒ…ï¼Œå¯ä»¥åœ¨å¦‚ä½•æœºå™¨ä¸Šåˆ†ææ•°æ®æ–‡ä»¶ä¸­è®°å½•çš„é‡‡æ ·æ•°æ® |
| bench         | perfä¸­å†…ç½®çš„benchmarkï¼Œç›®å‰åŒ…æ‹¬ä¸¤å¥—é’ˆå¯¹è°ƒåº¦å™¨å’Œå†…å­˜ç®¡ç†å­ç³»ç»Ÿçš„benchmark |
| buildid-cache | ç®¡ç†perfçš„buildidç¼“å­˜ï¼Œæ¯ä¸ªelfæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„buildidï¼Œbuildidè¢«perfç”¨æ¥å…³è”æ€§èƒ½æ•°æ®å’Œelfæ–‡ä»¶ |
| buildid-list  | åˆ—å‡ºæ•°æ®æ–‡ä»¶ä¸­è®°å½•çš„æ‰€æœ‰buildid                              |
| diff          | å¯¹æ¯”ä¸¤ä¸ªæ•°æ®æ–‡ä»¶çš„å·®å¼‚ï¼Œèƒ½å¤Ÿç»™å‡ºæ¯ä¸ªç¬¦å·ã€å‡½æ•°åœ¨çƒ­ç‚¹åˆ†æä¸Šçš„å…·ä½“å·®å¼‚ |
| evlist        | åˆ—å‡ºæ•°æ®æ–‡ä»¶perf.dataä¸­æ‰€æœ‰æ€§èƒ½äº‹ä»¶ã€‚                        |
| inject        | è¯¥å·¥å…·è¯»å–perf recordå·¥å…·è®°å½•çš„äº‹ä»¶æµï¼Œå¹¶å°†å…¶å®šå‘åˆ°æ ‡å‡†è¾“å‡ºã€‚åœ¨è¢«åˆ†æä»£ç ä¸­çš„ä»»ä½•ä¸€ç‚¹ï¼Œéƒ½å¯ä»¥å‘äº‹ä»¶æµä¸­æ³¨å…¥å…¶å®ƒäº‹ä»¶ã€‚ |
| kmem          | é’ˆå¯¹å†…æ ¸å†…å­˜ï¼ˆslabï¼‰å­ç³»ç»Ÿè¿›è¡Œè¿½è¸ªæµ‹é‡çš„å·¥å…·                 |
| kvm           | ç”¨æ¥è¿½è¸ªæµ‹è¯•è¿è¡Œåœ¨KVMè™šæ‹Ÿæœºä¸Šçš„Guest OSã€‚                    |
| list          | åˆ—å‡ºå½“å‰ç³»ç»Ÿæ”¯æŒçš„æ‰€æœ‰æ€§èƒ½äº‹ä»¶ã€‚åŒ…æ‹¬ç¡¬ä»¶æ€§èƒ½äº‹ä»¶ã€è½¯ä»¶æ€§èƒ½äº‹ä»¶ä»¥åŠæ£€æŸ¥ç‚¹ã€‚ |
| lock          | åˆ†æå†…æ ¸ä¸­çš„é”ä¿¡æ¯ï¼ŒåŒ…æ‹¬é”çš„äº‰ç”¨æƒ…å†µï¼Œç­‰å¾…å»¶è¿Ÿç­‰ã€‚           |
| mem           | å†…å­˜å­˜å–æƒ…å†µ                                                 |
| record        | æ”¶é›†é‡‡æ ·ä¿¡æ¯ï¼Œå¹¶å°†å…¶è®°å½•åœ¨æ•°æ®æ–‡ä»¶ä¸­ã€‚éšåå¯é€šè¿‡å…¶å®ƒå·¥å…·å¯¹æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æã€‚ |
| report        | è¯»å–perf recordåˆ›å»ºçš„æ•°æ®æ–‡ä»¶ï¼Œå¹¶ç»™å‡ºçƒ­ç‚¹åˆ†æç»“æœã€‚          |
| sched         | é’ˆå¯¹è°ƒåº¦å™¨å­ç³»ç»Ÿçš„åˆ†æå·¥å…·ã€‚                                 |
| script        | æ‰§è¡Œperlæˆ–pythonå†™çš„åŠŸèƒ½æ‰©å±•è„šæœ¬ã€ç”Ÿæˆè„šæœ¬æ¡†æ¶ã€è¯»å–æ•°æ®æ–‡ä»¶ä¸­çš„æ•°æ®ä¿¡æ¯ç­‰ã€‚ |
| stat          | æ‰§è¡ŒæŸä¸ªå‘½ä»¤ï¼Œæ”¶é›†ç‰¹å®šè¿›ç¨‹çš„æ€§èƒ½æ¦‚å†µï¼ŒåŒ…æ‹¬CPIã€Cacheä¸¢å¤±ç‡ç­‰ã€‚ |
| test          | perfå¯¹å½“å‰è½¯ç¡¬ä»¶å¹³å°è¿›è¡Œå¥å…¨æ€§æµ‹è¯•ï¼Œå¯ç”¨æ­¤å·¥å…·æµ‹è¯•å½“å‰çš„è½¯ç¡¬ä»¶å¹³å°æ˜¯å¦èƒ½æ”¯æŒperfçš„æ‰€æœ‰åŠŸèƒ½ã€‚ |
| timechart     | é’ˆå¯¹æµ‹è¯•æœŸé—´ç³»ç»Ÿè¡Œä¸ºè¿›è¡Œå¯è§†åŒ–çš„å·¥å…·                         |
| top           | ç±»ä¼¼äºlinuxçš„topå‘½ä»¤ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½è¿›è¡Œå®æ—¶åˆ†æã€‚               |
| trace         | å…³äºsyscallçš„å·¥å…·ã€‚                                          |
| probe         | ç”¨äºå®šä¹‰åŠ¨æ€æ£€æŸ¥ç‚¹ã€‚                                         |

### æ¡ˆä¾‹å®æ“

perf listæŸ¥çœ‹å½“å‰ç³»ç»Ÿæ”¯æŒçš„æ€§èƒ½äº‹ä»¶

perf benchå¯¹ç³»ç»Ÿæ€§èƒ½è¿›è¡Œæ‘¸åº•ï¼›

perf testå¯¹ç³»ç»Ÿè¿›è¡Œå¥å…¨æ€§æµ‹è¯•ï¼›

perf statå¯¹å…¨å±€æ€§èƒ½è¿›è¡Œç»Ÿè®¡ï¼›



perf topå¯ä»¥å®æ—¶æŸ¥çœ‹å½“å‰ç³»ç»Ÿè¿›ç¨‹å‡½æ•°å ç”¨ç‡æƒ…å†µï¼›

perf probeå¯ä»¥è‡ªå®šä¹‰åŠ¨æ€äº‹ä»¶ï¼›



perf kmemé’ˆå¯¹slabå­ç³»ç»Ÿæ€§èƒ½åˆ†æï¼›

perf kvmé’ˆå¯¹kvmè™šæ‹ŸåŒ–åˆ†æï¼›

perf lockåˆ†æé”æ€§èƒ½ï¼›

perf memåˆ†æå†…å­˜slabæ€§èƒ½ï¼›

perf schedåˆ†æå†…æ ¸è°ƒåº¦å™¨æ€§èƒ½ï¼›

perf traceè®°å½•ç³»ç»Ÿè°ƒç”¨è½¨è¿¹ï¼›



pref recordè®°å½•ä¿¡æ¯åˆ°perf.dataï¼›

perf reportç”ŸæˆæŠ¥å‘Šï¼›

perf diffå¯¹ä¸¤ä¸ªè®°å½•è¿›è¡Œdiffï¼›

perf evliståˆ—å‡ºè®°å½•çš„æ€§èƒ½äº‹ä»¶ï¼›

perf annotateæ˜¾ç¤ºperf.dataå‡½æ•°ä»£ç ï¼›

perf archiveå°†ç›¸å…³ç¬¦å·æ‰“åŒ…ï¼Œæ–¹ä¾¿åœ¨å…¶å®ƒæœºå™¨è¿›è¡Œåˆ†æï¼›

perf scriptå°†perf.dataè¾“å‡ºå¯è¯»æ€§æ–‡æœ¬ï¼›

---

## sar

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://blog.csdn.net/liyongbing1122/article/details/89517282

### å·¥å…·ç”¨é€”

+ è¾“å…¥/è¾“å‡ºå’Œä¼ è¾“é€Ÿç‡ç»Ÿè®¡ä¿¡æ¯ï¼ˆå…¨å±€ï¼Œæ¯ä¸ªè®¾å¤‡ï¼Œæ¯ä¸ªåˆ†åŒºå’Œæ¯ä¸ªç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼‰
+ CPUç»Ÿè®¡ä¿¡æ¯ï¼ˆå…¨å±€å’Œæ¯ä¸ªCPUï¼‰ï¼ŒåŒ…æ‹¬å¯¹è™šæ‹ŸåŒ–ä½“ç³»ç»“æ„çš„æ”¯æŒ
+ å†…å­˜ï¼Œå¤§é¡µé¢å’Œäº¤æ¢ç©ºé—´åˆ©ç”¨ç‡ç»Ÿè®¡ä¿¡æ¯
+ è™šæ‹Ÿå†…å­˜ï¼Œåˆ†é¡µå’Œæ•…éšœç»Ÿè®¡
+ æµç¨‹åˆ›å»ºæ´»åŠ¨
+ ä¸­æ–­ç»Ÿè®¡ä¿¡æ¯ï¼ˆå…¨å±€ï¼Œæ¯ä¸ªCPUå’Œæ¯ä¸ªä¸­æ–­ï¼ŒåŒ…æ‹¬æ½œåœ¨çš„APICä¸­æ–­æºï¼Œç¡¬ä»¶å’Œè½¯ä»¶ä¸­æ–­ï¼‰
+ å¹¿æ³›çš„ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ï¼šç½‘ç»œæ¥å£æ´»åŠ¨ï¼ˆæ¯ç§’æ¥æ”¶å’Œä¼ è¾“çš„æ•°æ®åŒ…æ•°é‡å’ŒkBç­‰ï¼‰ï¼ŒåŒ…æ‹¬æ¥è‡ªç½‘ç»œè®¾å¤‡çš„æ•…éšœï¼› åŸºäºSNMPv2æ ‡å‡†çš„IPï¼ŒTCPï¼ŒICMPå’ŒUDPåè®®çš„ç½‘ç»œæµé‡ç»Ÿè®¡ï¼› æ”¯æŒä¸IPv6ç›¸å…³çš„åè®®
+ å…‰çº¤é€šé“æµé‡ç»Ÿè®¡
+ åŸºäºè½¯ä»¶çš„ç½‘ç»œå¤„ç†ï¼ˆsoftnetï¼‰ç»Ÿè®¡ä¿¡æ¯
+ NFSæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ´»åŠ¨
+ å¥—æ¥å­—ç»Ÿè®¡
+ è¿è¡Œé˜Ÿåˆ—å’Œç³»ç»Ÿè´Ÿè½½ç»Ÿè®¡ä¿¡æ¯
+ å†…æ ¸å†…éƒ¨è¡¨åˆ©ç”¨ç‡ç»Ÿè®¡
+ äº¤æ¢ç»Ÿè®¡
+ TTYè®¾å¤‡æ´»åŠ¨
+ ç”µæºç®¡ç†ç»Ÿè®¡ä¿¡æ¯ï¼ˆç¬æ—¶å’Œå¹³å‡CPUæ—¶é’Ÿé¢‘ç‡ï¼Œé£æ‰‡é€Ÿåº¦ï¼Œè®¾å¤‡æ¸©åº¦ï¼Œç”µå‹è¾“å…¥ï¼‰
+ USBè®¾å¤‡æ’å…¥ç³»ç»Ÿ
+ æ–‡ä»¶ç³»ç»Ÿåˆ©ç”¨ç‡ï¼ˆèŠ‚ç‚¹å’Œå—ï¼‰
+ å¤±é€Ÿä¿¡æ¯ç»Ÿè®¡

### å·¥å…·å®‰è£…

centos8 å®‰è£…ï¼š sudo dnf install sysstat -y

centos7å®‰è£…ï¼š sudo yum install sysstat -y

### å¸®åŠ©ä¿¡æ¯

```shell
$ sar --help
ç”¨æ³•: sar [ é€‰é¡¹ ] [ <æ—¶é—´é—´éš”> [ <æ¬¡æ•°> ] ]
ä¸»è¦é€‰é¡¹å’ŒæŠ¥å‘Šï¼ˆæŠ¥å‘Šåä»¥æ–¹æ‹¬å·åˆ†éš”ï¼‰ï¼š
        -B      åˆ†é¡µçŠ¶å†µ [A_PAGE]
        -b      I/O å’Œä¼ è¾“é€Ÿç‡ä¿¡æ¯çŠ¶å†µ [A_IO]
        -d      å—è®¾å¤‡çŠ¶å†µ [A_DISK]
        -F [ MOUNT ]
                æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ [A_FS]
        -H      å·¨å¤§é¡µé¢åˆ©ç”¨ç‡ [A_HUGE]
        -I { <ä¸­æ–­åˆ—è¡¨> | SUM | ALL }
                ä¸­æ–­ä¿¡æ¯çŠ¶å†µ [A_IRQ]
        -m { <å…³é”®å­—> [,...] | ALL }
                ç”µæºç®¡ç†ç»Ÿè®¡ä¿¡æ¯ [A_PWR_...]
                å…³é”®å­—ï¼š
                CPU     CPU ç¬æ—¶æ—¶é’Ÿé¢‘ç‡
                FAN     é£æ‰‡é€Ÿåº¦
\t\tFREQ\tCPU å¹³å‡æ—¶é’Ÿé¢‘ç‡
                IN      è¾“å…¥ç”µå‹
                TEMP    è®¾å¤‡æ¸©åº¦
\t\tUSB\tè¿æ¥çš„ USB è®¾å¤‡
        -n { <å…³é”®å­—> [,...] | ALL }
                ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ [A_NET_...]
                å…³é”®å­—ï¼š
                DEV     ç½‘ç»œæ¥å£
                EDEV    ç½‘ç»œæ¥å£ï¼ˆé”™è¯¯ï¼‰
                NFS     NFS å®¢æˆ·ç«¯
                NFSD    NFS æœåŠ¡ç«¯
                SOCK    Sockets (v4)
                IP      IP æµ   (v4)
                EIP     IP æµ   (v4)ï¼ˆé”™è¯¯ï¼‰
                ICMP    ICMP æµ (v4)
                EICMP   ICMP æµ (v4)ï¼ˆé”™è¯¯ï¼‰
                TCP     TCP æµ  (v4)
                ETCP    TCP æµ  (v4) (é”™è¯¯)
                UDP     UDP æµ  (v4)
                SOCK6   Sockets (v6)
                IP6     IP æµ   (v6)
                EIP6    IP æµ   (v6)ï¼ˆé”™è¯¯ï¼‰
                ICMP6   ICMP æµ (v6)
                EICMP6  ICMP æµ (v6) (é”™è¯¯)
                UDP6    UDP æµ  (v6)
                FC      Fibre channel HBAs
                SOFT    åŸºäºè½¯ä»¶çš„ç½‘ç»œå¤„ç†

        -q [ <keyword> [,...] | PSI | ALL ]
                System load and pressure-stall statistics  ç³»ç»Ÿè´Ÿè½½å‹åŠ›ç»Ÿè®¡
                Keywords are:
                LOAD    Queue length and load average statistics [A_QUEUE]
                CPU     Pressure-stall CPU statistics [A_PSI_CPU]
                IO      Pressure-stall I/O statistics [A_PSI_IO]
                MEM     Pressure-stall memory statistics [A_PSI_MEM]
        -r [ ALL ]
                å†…å­˜åˆ©ç”¨ç‡ä¿¡æ¯ [A_MEMORY]
        -S      äº¤æ¢ç©ºé—´åˆ©ç”¨ç‡ä¿¡æ¯ [A_MEMORY]
        -u [ ALL ]
                CPU åˆ©ç”¨ç‡ä¿¡æ¯ [A_CPU]
        -v      å†…æ ¸è¡¨ç»Ÿè®¡ä¿¡æ¯ [A_KTABLES]
        -W      äº¤æ¢ä¿¡æ¯ [A_SWAP]
        -w      ä»»åŠ¡åˆ›å»ºä¸ç³»ç»Ÿåˆ‡æ¢ä¿¡æ¯ [A_PCSW]
        -y      TTY è®¾å¤‡ä¿¡æ¯ [A_SERIAL]

```

### å¸®åŠ©è¯´æ˜

```
ç”¨æ³•: sar [ é€‰é¡¹ ] [ <æ—¶é—´é—´éš”> [ <æ¬¡æ•°> ] ]
ä¸»è¦é€‰é¡¹å’ŒæŠ¥å‘Šï¼ˆæŠ¥å‘Šåä»¥æ–¹æ‹¬å·åˆ†éš”ï¼‰ï¼š
 -B åˆ†é¡µçŠ¶å†µ [A_PAGE]
 -b I/O å’Œä¼ è¾“é€Ÿç‡ä¿¡æ¯çŠ¶å†µ [A_IO]
 -d å—è®¾å¤‡çŠ¶å†µ [A_DISK]
 -F [ MOUNT ]
  æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ [A_FS]
 -H å·¨å¤§é¡µé¢åˆ©ç”¨ç‡ [A_HUGE]
 -I { <ä¸­æ–­åˆ—è¡¨> | SUM | ALL }
  ä¸­æ–­ä¿¡æ¯çŠ¶å†µ [A_IRQ]
 -m { <å…³é”®å­—> [,...] | ALL }
  ç”µæºç®¡ç†ç»Ÿè®¡ä¿¡æ¯ [A_PWR_...]
  å…³é”®å­—ï¼š
  CPU CPU ç¬æ—¶æ—¶é’Ÿé¢‘ç‡
  FAN é£æ‰‡é€Ÿåº¦
  
 å‚æ•°è¯´æ˜ï¼š

-A æ˜¾ç¤ºæ‰€æœ‰å†å²æ•°æ®ï¼Œé€šè¿‡è¯»å–/var/log/sarç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬åˆ†é—¨åˆ«ç±»çš„æ˜¾ç¤ºå‡ºæ¥ï¼›
-b é€šè¿‡è®¾å¤‡çš„I/Oä¸­æ–­è¯»å–è®¾ç½®çš„ååç‡ï¼›
-B æŠ¥å‘Šå†…å­˜æˆ–è™šæ‹Ÿå†…å­˜äº¤æ¢ç»Ÿè®¡ï¼›
-c æŠ¥å‘Šæ¯ç§’åˆ›å»ºçš„è¿›ç¨‹æ•°ï¼›
-d æŠ¥å‘Šç‰©ç†å—è®¾å¤‡ï¼ˆå­˜å‚¨è®¾å¤‡ï¼‰çš„å†™å…¥ã€è¯»å–ä¹‹ç±»çš„ä¿¡æ¯ï¼Œå¦‚æœç›´è§‚ä¸€ç‚¹ï¼Œå¯ä»¥å’Œpå‚æ•°å…±åŒä½¿ç”¨ï¼Œ-dp
-f ä»ä¸€ä¸ªäºŒè¿›åˆ¶çš„æ•°æ®æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œæ¯”å¦‚ sar -f filename
-i interval æŒ‡å®šæ•°æ®æ”¶é›†çš„æ—¶é—´ï¼Œæ—¶é—´å•ä½æ˜¯ç§’ï¼›
-n åˆ†æç½‘ç»œè®¾å¤‡çŠ¶æ€çš„ç»Ÿè®¡ï¼Œåé¢å¯ä»¥æ¥çš„å‚æ•°æœ‰ DEVã€EDEVã€NFSã€NFSDã€SOCKç­‰ã€‚æ¯”å¦‚-n DEV
-o æŠŠç»Ÿè®¡ä¿¡æ¯å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚ -o filename ï¼›
-P æŠ¥å‘Šæ¯ä¸ªå¤„ç†å™¨åº”ç”¨ç»Ÿè®¡ï¼Œç”¨äºå¤šå¤„ç†å™¨æœºå™¨ï¼Œå¹¶ä¸”å¯ç”¨SMPå†…æ ¸æ‰æœ‰æ•ˆï¼›
-p æ˜¾ç¤ºå‹å¥½è®¾å¤‡åå­—ï¼Œä»¥æ–¹ä¾¿æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥å’Œ-då’Œ-n å‚æ•°ç»“åˆä½¿ç”¨ï¼Œæ¯”å¦‚ -dp æˆ–-np
-r å†…å­˜å’Œäº¤æ¢åŒºå ç”¨ç»Ÿè®¡ï¼›
-R
-t è¿™ä¸ªé€‰é¡¹å¯¹ä»æ–‡ä»¶è¯»å–æ•°æ®æœ‰ç”¨ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œä¼šä»¥æœ¬åœ°æ—¶é—´ä¸ºæ ‡å‡† è¯»å‡ºï¼›
-u æŠ¥å‘ŠCPUåˆ©ç”¨ç‡çš„å‚æ•°ï¼›
-v æŠ¥å‘Šinode,æ–‡ä»¶æˆ–å…¶å®ƒå†…æ ¸è¡¨çš„èµ„æºå ç”¨ä¿¡æ¯ï¼›
-w æŠ¥å‘Šç³»ç»Ÿäº¤æ¢æ´»åŠ¨çš„ä¿¡æ¯ï¼› æ¯å°‘äº¤æ¢æ•°æ®çš„ä¸ªæ•°ï¼›
-W æŠ¥å‘Šç³»ç»Ÿäº¤æ¢æ´»åŠ¨ååä¿¡æ¯ï¼›

#é«˜ç‰ˆæœ¬æ–°åŠ çš„
-x ç”¨äºç›‘è§†è¿›ç¨‹çš„ï¼Œåœ¨å…¶åè¦æŒ‡å®šè¿›ç¨‹çš„PIDå€¼ï¼›
-X ç”¨äºç›‘è§†è¿›ç¨‹çš„ï¼Œä½†æŒ‡å®šçš„åº”è¯¥æ˜¯ä¸€ä¸ªå­è¿›ç¨‹ID

æ³¨ï¼š å¦‚æœåªç”¨sar å‘½ä»¤ï¼Œsarå°±æ˜¯è¯»å– /var/log/saç›®å½•ä¸‹æœ€è¿‘ç³»ç»ŸçŠ¶æ€æ–‡ä»¶ã€‚sar -A è¯»å–/var/log/saç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶æ•°æ®ã€‚
```



### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹1ï¼š sar -u 1 5

æ¡ˆä¾‹2ï¼š sar -n DEV 2 4

(1) sar -b 1 1        // IOä¼ é€é€Ÿç‡

(2) sar -B 1 1        // é¡µäº¤æ¢é€Ÿç‡

(3) sar -c 1 1        // è¿›ç¨‹åˆ›å»ºçš„é€Ÿç‡

(4) sar -d 1 1        // å—è®¾å¤‡çš„æ´»è·ƒä¿¡æ¯

| å­—æ®µ  | é‡Šä¹‰                                              |
| ----- | ------------------------------------------------- |
| await | è¡¨ç¤ºå¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„ç­‰å¾…æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ |
| svctm | è¡¨ç¤ºå¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„æœåŠ¡æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ |
| %util | è¡¨ç¤ºä¸€ç§’ä¸­æœ‰ç™¾åˆ†ä¹‹å‡ çš„æ—¶é—´ç”¨äºI/Oæ“ä½œ             |

(5) sar -n DEV 1 1    // ç½‘è·¯è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯

| å­—æ®µ     | é‡Šä¹‰                         |
| -------- | ---------------------------- |
| IFACE    | å°±æ˜¯ç½‘ç»œè®¾å¤‡çš„åç§°ã€‚         |
| rxpck/s  | æ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„åŒ…æ•°ç›®         |
| txpck/s  | æ¯ç§’é’Ÿå‘é€å‡ºå»çš„åŒ…æ•°ç›®       |
| rxkB/s   | æ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„å­—èŠ‚æ•°         |
| txkB/s   | æ¯ç§’é’Ÿå‘é€å‡ºå»çš„å­—èŠ‚æ•°       |
| rxcmp/s  | æ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„å‹ç¼©åŒ…æ•°ç›®ã€‚   |
| txcmp/s  | æ¯ç§’é’Ÿå‘é€å‡ºå»çš„å‹ç¼©åŒ…æ•°ç›®   |
| rxmcst/s | æ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„å¤šæ’­åŒ…çš„åŒ…æ•°ç›® |

(6) sar -n SOCK 1 1   // SOCKçš„ä½¿ç”¨æƒ…å†µ

(7) sar -n ALL 1 1    // æ‰€æœ‰çš„ç½‘ç»œçŠ¶æ€ä¿¡æ¯

(8) sar -P ALL 1 1    // æ¯é¢—CPUçš„ä½¿ç”¨çŠ¶æ€ä¿¡æ¯å’ŒIOWAITç»Ÿè®¡çŠ¶æ€ 

(9) sar -q 1 1        // é˜Ÿåˆ—çš„é•¿åº¦ï¼ˆç­‰å¾…è¿è¡Œçš„è¿›ç¨‹æ•°ï¼‰å’Œè´Ÿè½½çš„çŠ¶æ€

(10) sar -r 1 1      // å†…å­˜å’Œswapç©ºé—´ä½¿ç”¨æƒ…å†µ

| å­—æ®µ                | é‡Šä¹‰                                                         |
| ------------------- | ------------------------------------------------------------ |
| kbmemfree           | è¿™ä¸ªå€¼å’Œfreeå‘½ä»¤ä¸­çš„freeå€¼åŸºæœ¬ä¸€è‡´ï¼Œæ‰€ä»¥å®ƒä¸åŒ…æ‹¬bufferå’Œcacheçš„ç©ºé—´ |
| kbmemused           | è¿™ä¸ªå€¼å’Œfreeå‘½ä»¤ä¸­çš„usedå€¼åŸºæœ¬ä¸€è‡´ï¼Œæ‰€ä»¥å®ƒåŒ…æ‹¬bufferå’Œcacheçš„ç©ºé—´ |
| %memused            | è¿™ä¸ªå€¼æ˜¯kbmemusedå’Œå†…å­˜æ€»é‡(ä¸åŒ…æ‹¬swap)çš„ä¸€ä¸ªç™¾åˆ†æ¯”          |
| kbbufferså’Œkbcached | è¿™ä¸¤ä¸ªå€¼å°±æ˜¯freeå‘½ä»¤ä¸­çš„bufferå’Œcache                        |
| kbcommit            | ä¿è¯å½“å‰ç³»ç»Ÿæ‰€éœ€è¦çš„å†…å­˜ï¼Œå³ä¸ºäº†ç¡®ä¿ä¸æº¢å‡ºè€Œéœ€è¦çš„å†…å­˜(RAM+swap) |
| %commit             | è¿™ä¸ªå€¼æ˜¯kbcommitä¸å†…å­˜æ€»é‡(åŒ…æ‹¬swap)çš„ä¸€ä¸ªç™¾åˆ†æ¯”             |

(11) sar -R 1 1       // å†…å­˜çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆå†…å­˜é¡µçš„åˆ†é…å’Œé‡Šæ”¾ã€ç³»ç»Ÿæ¯ç§’ä½œä¸ºBUFFERä½¿ç”¨å†…å­˜é¡µã€æ¯ç§’è¢«cacheåˆ°çš„å†…å­˜é¡µï¼‰

(12) sar -u 1 1       // CPUçš„ä½¿ç”¨æƒ…å†µå’ŒIOWAITä¿¡æ¯ï¼ˆåŒé»˜è®¤ç›‘æ§ï¼‰

(13) sar -v 1 1       // inode, file and other kernel tablesdçš„çŠ¶æ€ä¿¡æ¯

(14) sar -w 1 1       // æ¯ç§’ä¸Šä¸‹æ–‡äº¤æ¢çš„æ•°ç›®

(15) sar -W 1 1       // SWAPäº¤æ¢çš„ç»Ÿè®¡ä¿¡æ¯(ç›‘æ§çŠ¶æ€åŒiostat çš„si so)

(16) sar -x 2906 1 1  // æ˜¾ç¤ºæŒ‡å®šè¿›ç¨‹(2906)çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä¿¡æ¯åŒ…æ‹¬ï¼šè¿›ç¨‹é€ æˆçš„é”™è¯¯ã€ç”¨æˆ·çº§å’Œç³»ç»Ÿçº§ç”¨æˆ·CPUçš„å ç”¨æƒ…å†µã€è¿è¡Œåœ¨å“ªé¢—CPUä¸Š

(17) sar -y 1 1       // TTYè®¾å¤‡çš„æ´»åŠ¨çŠ¶æ€

---

## dstat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://ipcmen.com/dstat

â€‹	https://blog.fish2bird.com/?p=881

### å·¥å…·ç”¨é€”

 dstat æ˜¯ä¸€ä¸ªç”¨æ¥æ›¿æ¢vmstatã€iostatã€netstatã€nfsstatã€ifstatè¿™äº›å‘½ä»¤çš„å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªå…¨èƒ½çš„ç³»ç»Ÿä¿¡æ¯ç»Ÿè®¡å·¥å…·ã€‚

ä¸sysstatç›¸æ¯”ï¼Œdstatæ‹¥æœ‰ä¸€ä¸ªå½©è‰²çš„ç•Œé¢ï¼Œæ•°æ®æ˜“äºè§‚å¯Ÿã€‚

dstatçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥å®æ—¶ç›‘æ§cpuã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€ioç­‰ä½¿ç”¨æƒ…å†µã€‚ç›´æ¥ä½¿ç”¨ `dstat` å‘½ä»¤ï¼Œç›¸å½“äº `dstat -cdngy`æ˜¾ç¤ºcpuã€diskã€netã€pageã€systemä¿¡æ¯ã€‚

dstat é»˜è®¤æ˜¯æ¯ç§’åˆ·æ–°æ˜¾ç¤ºä¸€æ¬¡æ•°æ®ï¼Œä½†æ˜¯å¯ä»¥è‡ªå·±è®¾ç½®ï¼Œ`dstat 3` å°±æ˜¯æ¯3ç§’æ”¶é›†ä¸€æ¬¡æ•°æ®ï¼Œ

### å·¥å…·å®‰è£…

centos8 ä¸­å®‰è£…ï¼š sudo dnf install dstat

centos7ä¸­å®‰è£…:  yum install dstat -y

### å¸®åŠ©ä¿¡æ¯

```shell
$ dstat --help
Usage: dstat [-afv] [options...] [delay [count]]
Versatile tool for generating system resource statistics

Dstat options:
  -c, --cpu             enable cpu stats
     -C 0,3,total          include cpu0, cpu3 and total
  -d, --disk            enable disk stats
     -D total,hda          include hda and total
  -g, --page            enable page stats
  -i, --int             enable interrupt stats
     -I 9,CAL              include int9 and function call interrupts
  -l, --load            enable load stats
  -m, --mem             enable memory stats
  -n, --net             enable network stats
     -N eth1,total         include eth1 and total
  -p, --proc            enable process stats
  -r, --io              enable io stats (I/O requests completed)
  -s, --swap            enable swap stats
     -S swap1,total        include swap1 and total
  -t, --time            enable time/date output
  --time-adv            enable time/date output (with milliseconds)
  -T, --epoch           enable time counter (seconds since epoch)
  --epoch-adv           enable time counter (milliseconds since epoch)
  -y, --sys             enable system stats

  --aio                 enable aio stats
  --fs, --filesystem    enable fs stats
  --ipc                 enable ipcstats
  --lock                enable lockstats
  --raw                 enable rawstats
  --socket              enable socketstats
  --tcp                 enable tcpstats
  --udp                 enable udpstats
  --unix                enable unixstats
  --vm                  enable vmstats
  --vm-adv              enable advanced vm stats

  --list                list all available plugins
  --plugin              enable external plugin by name, see --list

  -a, --all             equals -cdngy (default)
  -f, --full            automatically expand -C, -D, -I, -N and -S lists
  -v, --vmstat          equals -pmgdsc -D total

  --bits                force bits for values expressed in bytes
  --float               force float values on screen
  --integer             force integer values on screen

  --bw, --blackonwhite  change colors for white background terminal
  --color               force colors
  --nocolor             disable colors
  --noheaders           disable repetitive headers
  --noupdate            disable intermediate headers
  -o file, --output=file
                        write CSV output to file
  --profile             show profiling statistics when exiting dstat

delay is the delay in seconds between each update (default: 1)
count is the number of updates to display before exiting (default: unlimited)

```



### å¸®åŠ©è¯´æ˜

å‚è€ƒï¼šhttps://blog.csdn.net/sinat_34789167/article/details/80986709

| å‚æ•°                   |                | ç”¨æ³•è§£é‡Š                                                     |
| ---------------------- | -------------- | ------------------------------------------------------------ |
| -l, --load             |                | æ˜¾ç¤ºç³»ç»Ÿè´Ÿè½½                                                 |
| -c, --cpu              |                | æ˜¾ç¤ºcpuç³»ç»Ÿå ç”¨ï¼Œç”¨æˆ·å ç”¨ï¼Œç©ºé—²ã€ç­‰å¾…ã€ä¸­æ–­ã€è½¯ä¸­æ–­ç­‰ä¿¡æ¯    |
|                        | -C 0,3,total   | å½“æœ‰å¤šä¸ªcpuæ—¶ï¼ŒæŒ‰éœ€åˆ†åˆ«æ˜¾ç¤ºcpuçŠ¶æ€ï¼Œä¾‹å¦‚ï¼š-C 0,1 æ˜¾ç¤ºcpu0å’Œcpu1çš„ä¿¡æ¯ |
| -m, --mem              |                | æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ                                             |
| -d, --disk             |                | æ˜¾ç¤ºç£ç›˜è¯»å†™æƒ…å†µ                                             |
|                        | -D total,hda   | ç£ç›˜æ€»è¯»å†™æƒ…å†µ                                               |
| -n, --net              |                | æ˜¾ç¤ºç½‘ç»œæƒ…å†µ                                                 |
|                        | -N eth1,total  | æŒ‡å®šæŸä¸ªç½‘å¡æƒ…å†µ                                             |
| -g, --page             |                | æ˜¾ç¤ºé¡µé¢ä½¿ç”¨æƒ…å†µ                                             |
| -y, --sys              |                | æ˜¾ç¤ºç³»ç»Ÿè¿è¡Œæƒ…å†µ                                             |
| -i, --int              |                | æ˜¾ç¤ºä¸­æ–­æƒ…å†µ                                                 |
|                        | -I 9,CAL       |                                                              |
| -r, --io               |                | æ˜¾ç¤ºioè¿è¡Œæƒ…å†µ                                               |
| -s, --swap             |                | æ˜¾ç¤ºäº¤æ¢åŒºä½¿ç”¨æƒ…å†µ                                           |
|                        | -S swap1,total |                                                              |
| -p, --proc             |                | æ˜¾ç¤ºè¿›ç¨‹çŠ¶æ€                                                 |
| -t, --time             |                | æ˜¾ç¤ºæ—¶é—´                                                     |
|                        | --time-adv     | æ˜¾ç¤ºç²¾ç¡®åˆ°å¾®ç§’çš„æ—¶é—´                                         |
|                        | --epoch        | æ˜¾ç¤ºæ—¶é—´æˆ³                                                   |
| -a, --all              |                | ç›¸å½“äºæ‰§è¡Œå‰é¢çš„å‚æ•°ï¼Œ-cdngy                                 |
| -f, --full             |                | ç›¸å½“äºæ‰§è¡Œå‰é¢çš„å‚æ•°ï¼Œ-CDINS                                 |
| -v, --vmstat           |                | ç›¸å½“äºæ‰§è¡Œæ‰§è¡Œ  -pmgdsc -D total                             |
| -o file, --output=file |                | æŠŠç»“æœå†™å…¥åˆ°æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼ä¸€èˆ¬ä¸º csv                         |



### æ¡ˆä¾‹å®æ“

é½å…¨ç‰ˆï¼š

```shell
$ dstat -lcmsdrpgny

```

![Snipaste_20200605_115401](image/Snipaste_20200605_115401.png)

cpuä¿¡æ¯ä¸­ï¼š hiqã€siqä»£è¡¨ ç¡¬ä¸­æ–­ å’Œ è½¯ä¸­æ–­

systemä¿¡æ¯ä¸­ï¼š int\csw ä»£è¡¨ï¼Œä¸­æ–­æ¬¡æ•°(interrupt) å’Œ ä¸Šä¸‹æ–‡åˆ‡æ¢ (context switch)



ç²¾ç®€ç‰ˆï¼š

```shell
$ dstat -lcmdry
```

![Snipaste_20200605_115739](image/Snipaste_20200605_115739.png)

---



## nicstat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…

### å‚è€ƒ

https://www.linuxidc.com/Linux/2013-07/86941.htm

https://blog.51cto.com/xuclv/1157208

### å·¥å…·ç”¨é€”

â€‹	ç½‘ç»œæµé‡ç›‘æ§å™¨

### å·¥å…·å®‰è£…

```shell
# ä¸‹è½½æºç åŒ… 
wget http://sourceforge.net/projects/nicstat/files/nicstat-1.92.tar.gz

# è§£å‹
tar -xzvf nicstat-1.92.tar.gz

# è¿›å…¥æ–‡ä»¶å¤¹
cd nicstat-1.92/
./nicstat.sh -help
```



### å¸®åŠ©ä¿¡æ¯

```shell
# è¿›å…¥æ–‡ä»¶å¤¹
cd nicstat-1.92/
./nicstat.sh  -help
USAGE: nicstat [-hvnsxpztual] [-i int[,int...]]
   [-S int:mbps[,int:mbps...]] [interval [count]]

         -h                 # help
         -v                 # show version (1.92)
         -i interface       # track interface only
         -n                 # show non-local interfaces only (exclude lo0)
         -s                 # summary output
         -x                 # extended output
         -p                 # parseable output
         -z                 # skip zero value lines
         -t                 # show TCP statistics
         -u                 # show UDP statistics
         -a                 # equivalent to "-x -u -t"
         -l                 # list interface(s)
         -M                 # output in Mbits/sec
         -S int:mbps[fd|hd] # tell nicstat the interface
                            # speed (Mbits/sec) and duplex
    eg,
       nicstat              # print summary since boot only
       nicstat 1            # print every 1 second
       nicstat 1 5          # print 5 times only
       nicstat -z 1         # print every 1 second, skip zero lines
       nicstat -i hme0 1    # print hme0 only every 1 second


```

### å¸®åŠ©è¯´æ˜

| å‚æ•° | ç”¨æ³•è§£é‡Š |
| ---- | -------- |
|      |          |
|      |          |
|      |          |
|      |          |
|      |          |
|      |          |
|      |          |
|      |          |
|      |          |



### æ¡ˆä¾‹å®æ“

**æ¡ˆä¾‹1ï¼š** `./nicstat.sh 1`

![nicstat-1](image/nicstat-1.png)

Timeï¼šå½“å‰é‡‡æ ·æ—¶é—´

Intï¼šç½‘å¡åç§°

rKB/s: æ¯ç§’é’Ÿæ¥æ”¶æ•°æ®

wKB/s:  æ¯ç§’å†™çš„æ•°æ®

rPk/s:  æ¯ç§’æ¥æ”¶çš„æ•°æ®åŒ…æ•°

wPk/sï¼š æ¯ç§’å†™çš„æ•°æ®åŒ…æ•°

rAvs : æ¥æ”¶åˆ°çš„æ•°æ®åŒ…å¹³å‡å¤§å°

wAvs : ä¼ è¾“çš„æ•°æ®åŒ…å¹³å‡å¤§å°

%Util : ç½‘å¡åˆ©ç”¨ç‡(ç™¾åˆ†æ¯”)

Sat : ç½‘å¡æ¯ç§’çš„é”™è¯¯æ•°.ç½‘å¡æ˜¯å¦æ¥è¿‘é¥±æ»¡çš„ä¸€ä¸ªæŒ‡æ ‡.å°è¯•å»è¯Šæ–­ç½‘ç»œé—®é¢˜çš„æ—¶å€™,æ¨èä½¿ç”¨-xé€‰é¡¹å»æŸ¥çœ‹æ›´å¤šçš„ç»Ÿè®¡ä¿¡æ¯.

**æ¡ˆä¾‹2ï¼š** `./nicstat.sh 1 -t`

![nicstat-2](image/nicstat-2.png)

InKB : è¡¨ç¤ºæ¯ç§’æ¥æ”¶åˆ°çš„åƒå­—èŠ‚

OutKB : è¡¨ç¤ºæ¯ç§’ä¼ è¾“çš„åƒå­—èŠ‚

InSeg : è¡¨ç¤ºæ¯ç§’æ¥æ”¶åˆ°çš„TCPæ•°æ®æ®µ(TCP Segments)

OutSeg : è¡¨ç¤ºæ¯ç§’ä¼ è¾“çš„TCPæ•°æ®æ®µ(TCP Segments)

Reset : è¡¨ç¤ºTCPè¿æ¥ä»ESTABLISHEDæˆ–CLOSE-WAITçŠ¶æ€ç›´æ¥è½¬å˜ä¸ºCLOSEDçŠ¶æ€çš„æ¬¡æ•°

AttF : è¡¨ç¤ºTCPè¿æ¥ä»SYN-SENTæˆ–SYN-RCVDçŠ¶æ€ç›´æ¥è½¬å˜ä¸ºCLOSEDçŠ¶æ€çš„æ¬¡æ•°,å†åŠ ä¸ŠTCPè¿æ¥ä»SYN-RCVDçŠ¶æ€ç›´æ¥è½¬å˜ä¸ºLISTENçŠ¶æ€çš„æ¬¡æ•°

%ReTX : è¡¨ç¤ºTCPæ•°æ®æ®µ(TCP Segments)é‡ä¼ çš„ç™¾åˆ†æ¯”.å³ä¼ è¾“çš„TCPæ•°æ®æ®µåŒ…å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¹‹å‰ä¼ è¾“çš„å…«ä½å­—èŠ‚

InConn : è¡¨ç¤ºTCPè¿æ¥ä»LISTENçŠ¶æ€ç›´æ¥è½¬å˜ä¸ºSYN-RCVDçŠ¶æ€çš„æ¬¡æ•°

OutCon : è¡¨ç¤ºTCPè¿æ¥ä»CLOSEDçŠ¶æ€ç›´æ¥è½¬å˜ä¸ºSYN-SENTçŠ¶æ€çš„æ¬¡æ•°

Drops : è¡¨ç¤ºä»å®Œæˆè¿æ¥(completed connection)çš„é˜Ÿåˆ—å’Œæœªå®Œæˆè¿æ¥(incomplete connection)çš„é˜Ÿåˆ—ä¸­ä¸¢å¼ƒçš„è¿æ¥æ¬¡æ•°.

---

## ntstat

### æ¨èæŒ‡æ•°	â˜…â˜…

### å‚è€ƒ

https://ipcmen.com/nstatrtacct

### å·¥å…·ç”¨é€”

 ä¸€ä¸ªç®€å•çš„ç›‘è§†å†…æ ¸çš„SNMPè®¡æ•°å™¨å’Œç½‘ç»œæ¥å£çŠ¶æ€çš„å®ç”¨å·¥å…·

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ nstat --help
Usage: nstat [OPTION] [ PATTERN [ PATTERN ] ]
   -h, --help           this message
   -a, --ignore         ignore history
   -d, --scan=SECS      sample every statistics every SECS
   -j, --json           format output in JSON
   -n, --nooutput       do history only
   -p, --pretty         pretty print
   -r, --reset          reset history
   -s, --noupdate       don't update history
   -t, --interval=SECS  report average over the last SECS
   -V, --version        output version information
   -z, --zeros          show entries with zero activity

```



### å¸®åŠ©è¯´æ˜

| å‚æ•°            | ç”¨æˆ·è§£é‡Š                   |
| --------------- | -------------------------- |
| -z, --zeros     | æ˜¾ç¤º0è®¡æ•°å™¨                |
| -a, --ignore    |                            |
| -d, --scan=SECS | ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œæœ¬å‘½ä»¤ |
| -j, --json      | ç”¨jsonæ ¼å¼è¾“å‡º             |
| -n, --nooutput  | ä¸æ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œä»…æ›´æ–°å†å² |
| -p, --pretty    |                            |
| -r, --reset     | æ¸…é›¶å†å²ç»Ÿè®¡               |
| -s, --noupdate  | ä¸æ›´æ–°å†å²                 |

### æ¡ˆä¾‹å®æ“

ntstat

---

## netstat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://man.linuxde.net/netstat

### å·¥å…·ç”¨é€”

â€‹	ç”¨äºæ˜¾ç¤ºä¸IP\TCP\UDP\ICMPåè®®ç›¸å…³çš„æ•°æ®ç»Ÿè®¡ï¼Œä¸€èˆ¬ç”¨äºæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µ

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
# netstat --help
usage: netstat [-vWeenNcCF] [<Af>] -r         netstat {-V|--version|-h|--help}
       netstat [-vWnNcaeol] [<Socket> ...]
       netstat { [-vWeenNac] -I[<Iface>] | [-veenNac] -i | [-cnNe] -M | -s [-6tuw] } [delay]

        -r, --route              display routing table
        -I, --interfaces=<Iface> display interface table for <Iface>
        -i, --interfaces         display interface table
        -g, --groups             display multicast group memberships
        -s, --statistics         display networking statistics (like SNMP)
        -M, --masquerade         display masqueraded connections

        -v, --verbose            be verbose
        -W, --wide               don't truncate IP addresses
        -n, --numeric            don't resolve names
        --numeric-hosts          don't resolve host names
        --numeric-ports          don't resolve port names
        --numeric-users          don't resolve user names
        -N, --symbolic           resolve hardware names
        -e, --extend             display other/more information
        -p, --programs           display PID/Program name for sockets
        -o, --timers             display timers
        -c, --continuous         continuous listing

        -l, --listening          display listening server sockets
        -a, --all                display all sockets (default: connected)
        -F, --fib                display Forwarding Information Base (default)
        -C, --cache              display routing cache instead of FIB
        -Z, --context            display SELinux security context for sockets

  <Socket>={-t|--tcp} {-u|--udp} {-U|--udplite} {-S|--sctp} {-w|--raw}
           {-x|--unix} --ax25 --ipx --netrom
  <AF>=Use '-6|-4' or '-A <af>' or '--<af>'; default: inet
  List of possible address families (which support routing):
    inet (DARPA Internet) inet6 (IPv6) ax25 (AMPR AX.25)
    netrom (AMPR NET/ROM) ipx (Novell IPX) ddp (Appletalk DDP)
    x25 (CCITT X.25)

```



### å¸®åŠ©è¯´æ˜

```
-aæˆ–--allï¼šæ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„Socketï¼›
-A<ç½‘ç»œç±»å‹>æˆ–--<ç½‘ç»œç±»å‹>ï¼šåˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ï¼›
-cæˆ–--continuousï¼šæŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ï¼›
-Cæˆ–--cacheï¼šæ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ï¼›
-eæˆ–--extendï¼šæ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼›
-Fæˆ–--fibï¼šæ˜¾ç¤ºFIBï¼›
-gæˆ–--groupsï¼šæ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ï¼›
-hæˆ–--helpï¼šåœ¨çº¿å¸®åŠ©ï¼›
-iæˆ–--interfacesï¼šæ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ï¼›
-læˆ–--listeningï¼šæ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„Socketï¼›
-Mæˆ–--masqueradeï¼šæ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ï¼›
-næˆ–--numericï¼šç›´æ¥ä½¿ç”¨ipåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼›
-Næˆ–--netlinkæˆ–--symbolicï¼šæ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ï¼›
-oæˆ–--timersï¼šæ˜¾ç¤ºè®¡æ—¶å™¨ï¼›
-pæˆ–--programsï¼šæ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨Socketçš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ï¼›
-ræˆ–--routeï¼šæ˜¾ç¤ºRouting Tableï¼›
-sæˆ–--statisticeï¼šæ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ï¼›
-tæˆ–--tcpï¼šæ˜¾ç¤ºTCPä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µï¼›
-uæˆ–--udpï¼šæ˜¾ç¤ºUDPä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µï¼›
-væˆ–--verboseï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›
-Væˆ–--versionï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼›
-wæˆ–--rawï¼šæ˜¾ç¤ºRAWä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µï¼›
-xæˆ–--unixï¼šæ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š"-A unix"å‚æ•°ç›¸åŒï¼›
--ipæˆ–--inetï¼šæ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š"-A inet"å‚æ•°ç›¸åŒã€‚
```



### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹ï¼šnetstat -npl	å¯ä»¥æŸ¥çœ‹ä½ è¦æ‰“å¼€çš„ç«¯å£æ˜¯å¦å·²ç»æ‰“å¼€

netstat -rn æ‰“å°è·¯ç”±è¡¨ä¿¡æ¯

netstat -in æä¾›ç³»ç»Ÿä¸Šçš„æ¥å£ä¿¡æ¯ï¼Œæ‰“å°æ¯ä¸ªæ¥å£çš„MTUï¼Œè¾“å…¥åˆ†ç»„æ•°ï¼Œè¾“å‡ºåˆ†ç»„æ•°ï¼Œè¾“å‡ºé”™è¯¯ï¼Œå†²çªä»¥åŠå½“å‰çš„è¾“å‡ºé˜Ÿåˆ—é•¿åº¦

---

## ss

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://www.cnblogs.com/princessd8251/articles/4006614.html

https://man.linuxde.net/ss

### å·¥å…·ç”¨é€”

sså³socket state. ç”¨æ¥æ˜¾ç¤ºå¤„äºæ´»åŠ¨çŠ¶æ€çš„å¥—æ¥å­—ä¿¡æ¯ã€‚sså‘½ä»¤å¯ä»¥ç”¨æ¥è·å–socketç»Ÿè®¡ä¿¡æ¯ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºå’Œ[netstat](http://man.linuxde.net/netstat)ç±»ä¼¼çš„å†…å®¹ã€‚ä½†ssçš„ä¼˜åŠ¿åœ¨äºå®ƒèƒ½å¤Ÿæ˜¾ç¤ºæ›´å¤šæ›´è¯¦ç»†çš„æœ‰å…³TCPå’Œè¿æ¥çŠ¶æ€çš„ä¿¡æ¯ï¼Œè€Œä¸”æ¯”netstatæ›´å¿«é€Ÿæ›´é«˜æ•ˆã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```sh
[root@localhost ~]# ss --help
Usage: ss [ OPTIONS ]
       ss [ OPTIONS ] [ FILTER ]
   -h, --help          this message
   -V, --version       output version information
   -n, --numeric       don't resolve service names
   -r, --resolve       resolve host names
   -a, --all           display all sockets
   -l, --listening     display listening sockets
   -o, --options       show timer information
   -e, --extended      show detailed socket information
   -m, --memory        show socket memory usage
   -p, --processes     show process using socket
   -i, --info          show internal TCP information
       --tipcinfo      show internal tipc socket information
   -s, --summary       show socket usage summary
   -b, --bpf           show bpf filter socket information
   -E, --events        continually display sockets as they are destroyed
   -Z, --context       display process SELinux security contexts
   -z, --contexts      display process and socket SELinux security contexts
   -N, --net           switch to the specified network namespace name

   -4, --ipv4          display only IP version 4 sockets
   -6, --ipv6          display only IP version 6 sockets
   -0, --packet        display PACKET sockets
   -t, --tcp           display only TCP sockets
   -S, --sctp          display only SCTP sockets
   -u, --udp           display only UDP sockets
   -d, --dccp          display only DCCP sockets
   -w, --raw           display only RAW sockets
   -x, --unix          display only Unix domain sockets
       --tipc          display only TIPC sockets
       --vsock         display only vsock sockets
   -f, --family=FAMILY display sockets of type FAMILY
       FAMILY := {inet|inet6|link|unix|netlink|vsock|tipc|help}

   -K, --kill          forcibly close sockets, display what was closed
   -H, --no-header     Suppress header line

   -A, --query=QUERY, --socket=QUERY
       QUERY := {all|inet|tcp|udp|raw|unix|unix_dgram|unix_stream|unix_seqpacket|packet|netlink|vsock_stream|vsock_dgram|tipc}[,QUERY]

   -D, --diag=FILE     Dump raw information about TCP sockets to FILE
   -F, --filter=FILE   read filter information from FILE
       FILTER := [ state STATE-FILTER ] [ EXPRESSION ]
       STATE-FILTER := {all|connected|synchronized|bucket|big|TCP-STATES}
         TCP-STATES := {established|syn-sent|syn-recv|fin-wait-{1,2}|time-wait|closed|close-wait|last-ack|listening|closing}
          connected := {established|syn-sent|syn-recv|fin-wait-{1,2}|time-wait|close-wait|last-ack|closing}
       synchronized := {established|syn-recv|fin-wait-{1,2}|time-wait|close-wait|last-ack|closing}
             bucket := {syn-recv|time-wait}
                big := {established|syn-sent|fin-wait-{1,2}|closed|close-wait|last-ack|listening|closing}

```



### å¸®åŠ©è¯´æ˜

```
-hï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼›
-Vï¼šæ˜¾ç¤ºæŒ‡ä»¤ç‰ˆæœ¬ä¿¡æ¯ï¼›
-nï¼šä¸è§£ææœåŠ¡åç§°ï¼Œä»¥æ•°å­—æ–¹å¼æ˜¾ç¤ºï¼›
-aï¼šæ˜¾ç¤ºæ‰€æœ‰çš„å¥—æ¥å­—ï¼›
-lï¼šæ˜¾ç¤ºå¤„äºç›‘å¬çŠ¶æ€çš„å¥—æ¥å­—ï¼›
-oï¼šæ˜¾ç¤ºè®¡æ—¶å™¨ä¿¡æ¯ï¼›
-mï¼šæ˜¾ç¤ºå¥—æ¥å­—çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼›
-pï¼šæ˜¾ç¤ºä½¿ç”¨å¥—æ¥å­—çš„è¿›ç¨‹ä¿¡æ¯ï¼›
-iï¼šæ˜¾ç¤ºå†…éƒ¨çš„TCPä¿¡æ¯ï¼›
-4ï¼šåªæ˜¾ç¤ºipv4çš„å¥—æ¥å­—ï¼›
-6ï¼šåªæ˜¾ç¤ºipv6çš„å¥—æ¥å­—ï¼›
-tï¼šåªæ˜¾ç¤ºtcpå¥—æ¥å­—ï¼›
-uï¼šåªæ˜¾ç¤ºudpå¥—æ¥å­—ï¼›
-dï¼šåªæ˜¾ç¤ºDCCPå¥—æ¥å­—ï¼›
-wï¼šä»…æ˜¾ç¤ºRAWå¥—æ¥å­—ï¼›
-xï¼šä»…æ˜¾ç¤ºUNIXåŸŸå¥—æ¥å­—ã€‚
```

### æ¡ˆä¾‹å®æ“

æ˜¾ç¤ºicpè¿æ¥ï¼šss -t -a

æ˜¾ç¤ºsocketæ‘˜è¦ï¼š ss -s

åˆ—å‡ºæ‰€æœ‰æ‰“å¼€çš„ç½‘ç»œè¿æ¥ç«¯å£ï¼š ss -l

æŸ¥çœ‹è¿›ç¨‹ä½¿ç”¨çš„socketï¼š ss -pl

æ‰¾å‡ºæ‰“å¼€å¥—æ¥å­—\ç«¯å£åº”ç”¨ç¨‹åºï¼š  ss -pl |grep 3306

---

## tapestat(ä¸å…³æ³¨)

### æ¨èæŒ‡æ•°	â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

**å®˜æ–¹ï¼š**reports statistics for tape drives connected to the system.æ˜¾ç¤ºè¿æ¥åˆ°ç³»ç»Ÿçš„ç£ç›˜é©±åŠ¨å™¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## cifsiostat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…

### å‚è€ƒ

http://sebastien.godard.pagesperso-orange.fr/man_cifsiostat.html

### å·¥å…·ç”¨é€”

å®˜æ–¹ï¼šreports CIFS statisticsæŠ¥å‘ŠCIFSç»Ÿè®¡ä¿¡æ¯

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## sysbenchã€å·¥å…·ã€‘

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…

### å‚è€ƒ

https://github.com/akopytov/sysbench#rhelcentos

### å·¥å…·ç”¨é€”

æ€§èƒ½æ–½å‹å·¥å…·ï¼Œå¯ä»¥æ¨¡æ‹ŸCPUè¿›è¡Œç´ æ•°è®¡ç®—

### å·¥å…·å®‰è£…

```shell
# centos ä¸­å®‰è£…
curl -s https://packagecloud.io/install/repositories/akopytov/sysbench/script.rpm.sh | sudo bash

sudo yum -y install sysbench
```

### å¸®åŠ©ä¿¡æ¯

```shell
$ sysbench --help
Usage:
  sysbench [options]... [testname] [command]

Commands implemented by most tests: prepare run cleanup help

General options:
  --threads=N                     number of threads to use [1]
  --events=N                      limit for total number of events [0]
  --time=N                        limit for total execution time in seconds [10]
  --forced-shutdown=STRING        number of seconds to wait after the --time limit before forcing shutdown, or 'off' to disable [off]
  --thread-stack-size=SIZE        size of stack per thread [64K]
  --rate=N                        average transactions rate. 0 for unlimited rate [0]
  --report-interval=N             periodically report intermediate statistics with a specified interval in seconds. 0 disables intermediate reports [0]
  --report-checkpoints=[LIST,...] dump full statistics and reset all counters at specified points in time. The argument is a list of comma-separated values representing the amount of time in seconds elapsed from start of test when report checkpoint(s) must be performed. Report checkpoints are off by default. []
  --debug[=on|off]                print more debugging info [off]
  --validate[=on|off]             perform validation checks where possible [off]
  --help[=on|off]                 print help and exit [off]
  --version[=on|off]              print version and exit [off]
  --config-file=FILENAME          File containing command line options
  --tx-rate=N                     deprecated alias for --rate [0]
  --max-requests=N                deprecated alias for --events [0]
  --max-time=N                    deprecated alias for --time [0]
  --num-threads=N                 deprecated alias for --threads [1]

Pseudo-Random Numbers Generator options:
  --rand-type=STRING random numbers distribution {uniform,gaussian,special,pareto} [special]
  --rand-spec-iter=N number of iterations used for numbers generation [12]
  --rand-spec-pct=N  percentage of values to be treated as 'special' (for special distribution) [1]
  --rand-spec-res=N  percentage of 'special' values to use (for special distribution) [75]
  --rand-seed=N      seed for random number generator. When 0, the current time is used as a RNG seed. [0]
  --rand-pareto-h=N  parameter h for pareto distribution [0.2]

Log options:
  --verbosity=N verbosity level {5 - debug, 0 - only critical messages} [3]

  --percentile=N       percentile to calculate in latency statistics (1-100). Use the special value of 0 to disable percentile calculations [95]
  --histogram[=on|off] print latency histogram in report [off]

General database options:

  --db-driver=STRING  specifies database driver to use ('help' to get list of available drivers) [mysql]
  --db-ps-mode=STRING prepared statements usage mode {auto, disable} [auto]
  --db-debug[=on|off] print database-specific debug information [off]


Compiled-in database drivers:
  mysql - MySQL driver
  pgsql - PostgreSQL driver

mysql options:
  --mysql-host=[LIST,...]          MySQL server host [localhost]
  --mysql-port=[LIST,...]          MySQL server port [3306]
  --mysql-socket=[LIST,...]        MySQL socket
  --mysql-user=STRING              MySQL user [sbtest]
  --mysql-password=STRING          MySQL password []
  --mysql-db=STRING                MySQL database name [sbtest]
  --mysql-ssl[=on|off]             use SSL connections, if available in the client library [off]
  --mysql-ssl-cipher=STRING        use specific cipher for SSL connections []
  --mysql-compression[=on|off]     use compression, if available in the client library [off]
  --mysql-debug[=on|off]           trace all client library calls [off]
  --mysql-ignore-errors=[LIST,...] list of errors to ignore, or "all" [1213,1020,1205]
  --mysql-dry-run[=on|off]         Dry run, pretend that all MySQL client API calls are successful without executing them [off]

pgsql options:
  --pgsql-host=STRING     PostgreSQL server host [localhost]
  --pgsql-port=N          PostgreSQL server port [5432]
  --pgsql-user=STRING     PostgreSQL user [sbtest]
  --pgsql-password=STRING PostgreSQL password []
  --pgsql-db=STRING       PostgreSQL database name [sbtest]

Compiled-in tests:
  fileio - File I/O test
  cpu - CPU performance test
  memory - Memory functions speed test
  threads - Threads subsystem performance test
  mutex - Mutex performance test

```

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹1ï¼š `sysbench --threads=10 --time=120 threads run`

---

## vmstat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://www.cnblogs.com/ftl1012/p/vmstat.html

â€‹	https://www.cnblogs.com/tommyli/p/3746187.html

â€‹	https://man.linuxde.net/vmstat

### å·¥å…·ç”¨é€”

â€‹	virtual meomory statistics è™šæ‹Ÿå†…å­˜ç»Ÿè®¡çš„ç¼©å†™ï¼Œå¯å¯¹è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€cpuæ´»åŠ¨è¿›è¡Œç›‘æ§ã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
$ vmstat -help

Usage:
 vmstat [options] [delay [count]]

Options:
 -a, --active           active/inactive memory
 -f, --forks            number of forks since boot
 -m, --slabs            slabinfo
 -n, --one-header       do not redisplay header
 -s, --stats            event counter statistics
 -d, --disk             disk statistics
 -D, --disk-sum         summarize disk statistics
 -p, --partition <dev>  partition specific statistics
 -S, --unit <char>      define display unit
 -w, --wide             wide output
 -t, --timestamp        show timestamp

 -h, --help     display this help and exit
 -V, --version  output version information and exit

```

### å¸®åŠ©è¯´æ˜

| å‚æ•°                  | ç”¨æ³•è§£é‡Š                           |
| --------------------- | ---------------------------------- |
| -a, --active          | æ˜¾ç¤ºæ´»è·ƒæˆ–éæ´»è·ƒçš„å†…å­˜             |
| -f, --forks           | æ˜¾ç¤ºä»ç³»ç»Ÿå¯åŠ¨è‡³ä»Šçš„forkæ•°é‡       |
| -m, --slabs           | æ˜¾ç¤ºslabä¿¡æ¯                       |
| -n, --one-header      | å¤´ä¿¡æ¯ä»…æ˜¾ç¤ºä¸€æ¬¡                   |
| -s, --stats           | ä»¥è¡¨æ ¼æ–¹å¼æ˜¾ç¤ºæ—¶é—´è®¡æ•°å™¨çš„å†…å­˜çŠ¶æ€ |
| -d, --disk            | æŠ¥å‘Šç£ç›˜çŠ¶æ€                       |
| -p, --partition <dev> | æ˜¾ç¤ºæŒ‡å®šçš„ç¡¬ç›˜åˆ†åŒºçŠ¶æ€             |
| -S, --unit <char>     | è¾“å‡ºä¿¡æ¯çš„å®šä½                     |
|                       |                                    |

### æ¡ˆä¾‹å®æ“

**æ¡ˆä¾‹1**ï¼š vmstat 3

![vmstat-01](vmstat-01.png)

â–ª procsï¼šrè¿™ä¸€åˆ—æ˜¾ç¤ºäº†å¤šå°‘è¿›ç¨‹åœ¨ç­‰å¾…cpuï¼Œbåˆ—æ˜¾ç¤ºå¤šå°‘è¿›ç¨‹æ­£åœ¨ä¸å¯ä¸­æ–­çš„ä¼‘çœ ï¼ˆç­‰å¾…IOï¼‰ã€‚

â–ª memoryï¼šswapdåˆ—æ˜¾ç¤ºäº†å¤šå°‘å—è¢«æ¢å‡ºäº†ç£ç›˜ï¼ˆé¡µé¢äº¤æ¢ï¼‰ï¼Œå‰©ä¸‹çš„åˆ—æ˜¾ç¤ºäº†å¤šå°‘å—æ˜¯ç©ºé—²çš„ï¼ˆæœªè¢«ä½¿ç”¨ï¼‰ï¼Œå¤šå°‘å—æ­£åœ¨è¢«ç”¨ä½œç¼“å†²åŒºï¼Œä»¥åŠå¤šå°‘æ­£åœ¨è¢«ç”¨ä½œæ“ä½œç³»ç»Ÿçš„ç¼“å­˜ã€‚

â–ª swapï¼šæ˜¾ç¤ºäº¤æ¢æ´»åŠ¨ï¼šæ¯ç§’æœ‰å¤šå°‘å—æ­£åœ¨è¢«æ¢å…¥ï¼ˆä»ç£ç›˜ï¼‰å’Œæ¢å‡ºï¼ˆåˆ°ç£ç›˜ï¼‰ã€‚

â–ª ioï¼šæ˜¾ç¤ºäº†å¤šå°‘å—ä»å—è®¾å¤‡è¯»å–ï¼ˆbiï¼‰å’Œå†™å‡ºï¼ˆboï¼‰,é€šå¸¸åæ˜ äº†ç¡¬ç›˜I/Oã€‚

â–ª systemï¼šæ˜¾ç¤ºæ¯ç§’ä¸­æ–­(in)å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcsï¼‰çš„æ•°é‡ã€‚

â–ª cpuï¼šæ˜¾ç¤ºæ‰€æœ‰çš„cpuæ—¶é—´èŠ±è´¹åœ¨å„ç±»æ“ä½œçš„ç™¾åˆ†æ¯”ï¼ŒåŒ…æ‹¬æ‰§è¡Œç”¨æˆ·ä»£ç ï¼ˆéå†…æ ¸ï¼‰ï¼Œæ‰§è¡Œç³»ç»Ÿä»£ç ï¼ˆå†…æ ¸ï¼‰ï¼Œç©ºé—²ä»¥åŠç­‰å¾…IOã€‚

å†…å­˜ä¸è¶³çš„è¡¨ç°ï¼šfree  memoryæ€¥å‰§å‡å°‘ï¼Œå›æ”¶bufferå’Œcacherä¹Ÿæ— æµäºäº‹ï¼Œå¤§é‡ä½¿ç”¨äº¤æ¢åˆ†åŒºï¼ˆswpdï¼‰,é¡µé¢äº¤æ¢ï¼ˆswapï¼‰é¢‘ç¹ï¼Œè¯»å†™ç£ç›˜æ•°é‡ï¼ˆioï¼‰å¢å¤šï¼Œç¼ºé¡µä¸­æ–­ï¼ˆinï¼‰å¢å¤šï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcsï¼‰æ¬¡æ•°å¢å¤šï¼Œç­‰å¾…IOçš„è¿›ç¨‹æ•°ï¼ˆbï¼‰å¢å¤šï¼Œå¤§é‡CPUæ—¶é—´ç”¨äºç­‰å¾…IOï¼ˆwaï¼‰

**æ¡ˆä¾‹2ï¼š** vmstat -s		æŸ¥çœ‹ page ** inï¼ˆpiï¼‰ page ** out(po)

---

## atop

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://www.cnblogs.com/DataArt/p/10344438.html

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

centos8ä¸­å®‰è£…ï¼š ` sudo dnf install atop `

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## htop

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://www.cnblogs.com/programmer-tlh/p/11726016.html

### å·¥å…·ç”¨é€”

htopå·¥å…·åœ¨epelæºä¸­æä¾›, htopè·Ÿtopä¸€æ ·ï¼Œä¹Ÿæ˜¯æ‰“å¼€ä¸€ä¸ªå®æ—¶çš„ç›‘æ§ç•Œé¢ï¼Œç›´æ¥è¾“å…¥htopå‘½ä»¤æ‰“å¼€

### å·¥å…·å®‰è£…

```
yum install epel-release -y	# å®‰è£…epelæº
yum install htop -y	# å®‰è£…htop
```

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## ps

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://man.linuxde.net/ps

### å·¥å…·ç”¨é€”

â€‹	ç”¨äºæŠ¥å‘Šå½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€ã€‚å¯ä»¥æ­é…[kill](http://man.linuxde.net/kill)æŒ‡ä»¤éšæ—¶ä¸­æ–­ã€åˆ é™¤ä¸å¿…è¦çš„ç¨‹åºã€‚pså‘½ä»¤æ˜¯æœ€åŸºæœ¬åŒæ—¶ä¹Ÿæ˜¯éå¸¸å¼ºå¤§çš„è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ï¼Œä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥ç¡®å®šæœ‰å“ªäº›è¿›ç¨‹æ­£åœ¨è¿è¡Œå’Œè¿è¡Œçš„çŠ¶æ€ã€è¿›ç¨‹æ˜¯å¦ç»“æŸã€è¿›ç¨‹æœ‰æ²¡æœ‰åƒµæ­»ã€å“ªäº›è¿›ç¨‹å ç”¨äº†è¿‡å¤šçš„èµ„æºç­‰ç­‰ï¼Œæ€»ä¹‹å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½æ˜¯å¯ä»¥é€šè¿‡æ‰§è¡Œè¯¥å‘½ä»¤å¾—åˆ°çš„ã€‚

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```sh
man ps

PS(1)                                                                                               User Commands                                                                                               PS(1)

NAME
       ps - report a snapshot of the current processes.

SYNOPSIS
       ps [options]

DESCRIPTION
       ps displays information about a selection of the active processes.  If you want a repetitive update of the selection and the displayed information, use top(1) instead.

       This version of ps accepts several kinds of options:

       1   UNIX options, which may be grouped and must be preceded by a dash.
       2   BSD options, which may be grouped and must not be used with a dash.
       3   GNU long options, which are preceded by two dashes.

       Options of different types may be freely mixed, but conflicts can appear.  There are some synonymous options, which are functionally identical, due to the many standards and ps implementations that this ps
       is compatible with.

       Note that "ps -aux" is distinct from "ps aux".  The POSIX and UNIX standards require that "ps -aux" print all processes owned by a user named "x", as well as printing all processes that would be selected by
       the -a option.  If the user named "x" does not exist, this ps may interpret the command as "ps aux" instead and print a warning.  This behavior is intended to aid in transitioning old scripts and habits.
       It is fragile, subject to change, and thus should not be relied upon.

       By default, ps selects all processes with the same effective user ID (euid=EUID) as the current user and associated with the same terminal as the invoker.  It displays the process ID (pid=PID), the terminal
       associated with the process (tname=TTY), the cumulated CPU time in [DD-]hh:mm:ss format (time=TIME), and the executable name (ucmd=CMD).  Output is unsorted by default.

       The use of BSD-style options will add process state (stat=STAT) to the default display and show the command args (args=COMMAND) instead of the executable name.  You can override this with the PS_FORMAT
       environment variable. The use of BSD-style options will also change the process selection to include processes on other terminals (TTYs) that are owned by you; alternately, this may be described as setting
       the selection to be the set of all processes filtered to exclude processes owned by other users or not on a terminal.  These effects are not considered when options are described as being "identical" below,
       so -M will be considered identical to Z and so on.

       Except as described below, process selection options are additive.  The default selection is discarded, and then the selected processes are added to the set of processes to be displayed.  A process will
       thus be shown if it meets any of the given selection criteria.

EXAMPLES
       To see every process on the system using standard syntax:
          ps -e
          ps -ef
          ps -eF
          ps -ely

       To see every process on the system using BSD syntax:
          ps ax
          ps axu

       To print a process tree:
          ps -ejH
          ps axjf

       To get info about threads:
          ps -eLf

```



### å¸®åŠ©è¯´æ˜

pså‚æ•°å¤ªå¤šï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒman psï¼Œå¸¸ç”¨çš„æ–¹æ³•ï¼šps  aux  #hsserverï¼›ps â€“ef |grep #hundsun

```
-aï¼šæ˜¾ç¤ºæ‰€æœ‰ç»ˆç«¯æœºä¸‹æ‰§è¡Œçš„ç¨‹åºï¼Œé™¤äº†é˜¶æ®µä½œä¸šé¢†å¯¼è€…ä¹‹å¤–ã€‚
aï¼šæ˜¾ç¤ºç°è¡Œç»ˆç«¯æœºä¸‹çš„æ‰€æœ‰ç¨‹åºï¼ŒåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„ç¨‹åºã€‚
-Aï¼šæ˜¾ç¤ºæ‰€æœ‰ç¨‹åºã€‚
-cï¼šæ˜¾ç¤ºCLSå’ŒPRIæ ä½ã€‚
cï¼šåˆ—å‡ºç¨‹åºæ—¶ï¼Œæ˜¾ç¤ºæ¯ä¸ªç¨‹åºçœŸæ­£çš„æŒ‡ä»¤åç§°ï¼Œè€Œä¸åŒ…å«è·¯å¾„ï¼Œé€‰é¡¹æˆ–å¸¸é©»æœåŠ¡çš„æ ‡ç¤ºã€‚
-C<æŒ‡ä»¤åç§°>ï¼šæŒ‡å®šæ‰§è¡ŒæŒ‡ä»¤çš„åç§°ï¼Œå¹¶åˆ—å‡ºè¯¥æŒ‡ä»¤çš„ç¨‹åºçš„çŠ¶å†µã€‚
-dï¼šæ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä½†ä¸åŒ…æ‹¬é˜¶æ®µä½œä¸šé¢†å¯¼è€…çš„ç¨‹åºã€‚
-eï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"A"é€‰é¡¹ç›¸åŒã€‚
eï¼šåˆ—å‡ºç¨‹åºæ—¶ï¼Œæ˜¾ç¤ºæ¯ä¸ªç¨‹åºæ‰€ä½¿ç”¨çš„ç¯å¢ƒå˜é‡ã€‚
-fï¼šæ˜¾ç¤ºUID,PPIP,Cä¸STIMEæ ä½ã€‚
fï¼šç”¨ASCIIå­—ç¬¦æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„ï¼Œè¡¨è¾¾ç¨‹åºé—´çš„ç›¸äº’å…³ç³»ã€‚
-g<ç¾¤ç»„åç§°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-G"é€‰é¡¹ç›¸åŒï¼Œå½“äº¦èƒ½ä½¿ç”¨é˜¶æ®µä½œä¸šé¢†å¯¼è€…çš„åç§°æ¥æŒ‡å®šã€‚
gï¼šæ˜¾ç¤ºç°è¡Œç»ˆç«¯æœºä¸‹çš„æ‰€æœ‰ç¨‹åºï¼ŒåŒ…æ‹¬ç¾¤ç»„é¢†å¯¼è€…çš„ç¨‹åºã€‚
-G<ç¾¤ç»„è¯†åˆ«ç >ï¼šåˆ—å‡ºå±äºè¯¥ç¾¤ç»„çš„ç¨‹åºçš„çŠ¶å†µï¼Œä¹Ÿå¯ä½¿ç”¨ç¾¤ç»„åç§°æ¥æŒ‡å®šã€‚
hï¼šä¸æ˜¾ç¤ºæ ‡é¢˜åˆ—ã€‚
-Hï¼šæ˜¾ç¤ºæ ‘çŠ¶ç»“æ„ï¼Œè¡¨ç¤ºç¨‹åºé—´çš„ç›¸äº’å…³ç³»ã€‚
-jæˆ–jï¼šé‡‡ç”¨å·¥ä½œæ§åˆ¶çš„æ ¼å¼æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
-læˆ–lï¼šé‡‡ç”¨è¯¦ç»†çš„æ ¼å¼æ¥æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
Lï¼šåˆ—å‡ºæ ä½çš„ç›¸å…³ä¿¡æ¯ã€‚
-mæˆ–mï¼šæ˜¾ç¤ºæ‰€æœ‰çš„æ‰§è¡Œç»ªã€‚
nï¼šä»¥æ•°å­—æ¥è¡¨ç¤ºUSERå’ŒWCHANæ ä½ã€‚
-Nï¼šæ˜¾ç¤ºæ‰€æœ‰çš„ç¨‹åºï¼Œé™¤äº†æ‰§è¡ŒpsæŒ‡ä»¤ç»ˆç«¯æœºä¸‹çš„ç¨‹åºä¹‹å¤–ã€‚
-p<ç¨‹åºè¯†åˆ«ç >ï¼šæŒ‡å®šç¨‹åºè¯†åˆ«ç ï¼Œå¹¶åˆ—å‡ºè¯¥ç¨‹åºçš„çŠ¶å†µã€‚
p<ç¨‹åºè¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-p"é€‰é¡¹ç›¸åŒï¼Œåªåœ¨åˆ—è¡¨æ ¼å¼æ–¹é¢ç¨æœ‰å·®å¼‚ã€‚
rï¼šåªåˆ—å‡ºç°è¡Œç»ˆç«¯æœºæ­£åœ¨æ‰§è¡Œä¸­çš„ç¨‹åºã€‚
-s<é˜¶æ®µä½œä¸š>ï¼šæŒ‡å®šé˜¶æ®µä½œä¸šçš„ç¨‹åºè¯†åˆ«ç ï¼Œå¹¶åˆ—å‡ºéš¶å±è¯¥é˜¶æ®µä½œä¸šçš„ç¨‹åºçš„çŠ¶å†µã€‚
sï¼šé‡‡ç”¨ç¨‹åºä¿¡å·çš„æ ¼å¼æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
Sï¼šåˆ—å‡ºç¨‹åºæ—¶ï¼ŒåŒ…æ‹¬å·²ä¸­æ–­çš„å­ç¨‹åºèµ„æ–™ã€‚
-t<ç»ˆç«¯æœºç¼–å·>ï¼šæŒ‡å®šç»ˆç«¯æœºç¼–å·ï¼Œå¹¶åˆ—å‡ºå±äºè¯¥ç»ˆç«¯æœºçš„ç¨‹åºçš„çŠ¶å†µã€‚
t<ç»ˆç«¯æœºç¼–å·>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-t"é€‰é¡¹ç›¸åŒï¼Œåªåœ¨åˆ—è¡¨æ ¼å¼æ–¹é¢ç¨æœ‰å·®å¼‚ã€‚
-Tï¼šæ˜¾ç¤ºç°è¡Œç»ˆç«¯æœºä¸‹çš„æ‰€æœ‰ç¨‹åºã€‚
-u<ç”¨æˆ·è¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-U"é€‰é¡¹ç›¸åŒã€‚
uï¼šä»¥ç”¨æˆ·ä¸ºä¸»çš„æ ¼å¼æ¥æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
-U<ç”¨æˆ·è¯†åˆ«ç >ï¼šåˆ—å‡ºå±äºè¯¥ç”¨æˆ·çš„ç¨‹åºçš„çŠ¶å†µï¼Œä¹Ÿå¯ä½¿ç”¨ç”¨æˆ·åç§°æ¥æŒ‡å®šã€‚
U<ç”¨æˆ·åç§°>ï¼šåˆ—å‡ºå±äºè¯¥ç”¨æˆ·çš„ç¨‹åºçš„çŠ¶å†µã€‚
vï¼šé‡‡ç”¨è™šæ‹Ÿå†…å­˜çš„æ ¼å¼æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
-Væˆ–Vï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚
-wæˆ–wï¼šé‡‡ç”¨å®½é˜”çš„æ ¼å¼æ¥æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚ã€€
xï¼šæ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä¸ä»¥ç»ˆç«¯æœºæ¥åŒºåˆ†ã€‚
Xï¼šé‡‡ç”¨æ—§å¼çš„Linux i386ç™»é™†æ ¼å¼æ˜¾ç¤ºç¨‹åºçŠ¶å†µã€‚
-yï¼šé…åˆé€‰é¡¹"-l"ä½¿ç”¨æ—¶ï¼Œä¸æ˜¾ç¤ºF(flag)æ ä½ï¼Œå¹¶ä»¥RSSæ ä½å–ä»£ADDRæ ä½ã€€ã€‚
-<ç¨‹åºè¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"p"é€‰é¡¹ç›¸åŒã€‚
--cols<æ¯åˆ—å­—ç¬¦æ•°>ï¼šè®¾ç½®æ¯åˆ—çš„æœ€å¤§å­—ç¬¦æ•°ã€‚
--columns<æ¯åˆ—å­—ç¬¦æ•°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"--cols"é€‰é¡¹ç›¸åŒã€‚
--cumulativeï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"S"é€‰é¡¹ç›¸åŒã€‚
--deselectï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-N"é€‰é¡¹ç›¸åŒã€‚
--forestï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"f"é€‰é¡¹ç›¸åŒã€‚
--headersï¼šé‡å¤æ˜¾ç¤ºæ ‡é¢˜åˆ—ã€‚
--helpï¼šåœ¨çº¿å¸®åŠ©ã€‚
--infoï¼šæ˜¾ç¤ºæ’é”™ä¿¡æ¯ã€‚
--lines<æ˜¾ç¤ºåˆ—æ•°>ï¼šè®¾ç½®æ˜¾ç¤ºç”»é¢çš„åˆ—æ•°ã€‚
--no-headersï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"h"é€‰é¡¹ç›¸åŒï¼Œåªåœ¨åˆ—è¡¨æ ¼å¼æ–¹é¢ç¨æœ‰å·®å¼‚ã€‚
--group<ç¾¤ç»„åç§°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-G"é€‰é¡¹ç›¸åŒã€‚
--Group<ç¾¤ç»„è¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-G"é€‰é¡¹ç›¸åŒã€‚
--pid<ç¨‹åºè¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-p"é€‰é¡¹ç›¸åŒã€‚
--rows<æ˜¾ç¤ºåˆ—æ•°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"--lines"é€‰é¡¹ç›¸åŒã€‚
--sid<é˜¶æ®µä½œä¸š>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-s"é€‰é¡¹ç›¸åŒã€‚
--tty<ç»ˆç«¯æœºç¼–å·>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-t"é€‰é¡¹ç›¸åŒã€‚
--user<ç”¨æˆ·åç§°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-U"é€‰é¡¹ç›¸åŒã€‚
--User<ç”¨æˆ·è¯†åˆ«ç >ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-U"é€‰é¡¹ç›¸åŒã€‚
--versionï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-V"é€‰é¡¹ç›¸åŒã€‚
--widty<æ¯åˆ—å­—ç¬¦æ•°>ï¼šæ­¤é€‰é¡¹çš„æ•ˆæœå’ŒæŒ‡å®š"-cols"é€‰é¡¹ç›¸åŒã€‚
```

### æ¡ˆä¾‹å®æ“

æ€æ‰æŸä¸€ç¨‹åºçš„æ–¹æ³•ï¼šps  aux | grep mysqld | grep â€“v grep | awk â€˜{print $2 }â€™ xargs kill -9

æ€æ‰åƒµå°¸è¿›ç¨‹ï¼šps â€“eal | awk â€˜{if ($2 == â€œZâ€){print $4}}â€™ | xargs kill -9

---

## strace

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

â€‹	è·Ÿè¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨åŠæ¥æ”¶åˆ°çš„ä¿¡å·ï¼Œå¸®åŠ©åˆ†æç¨‹åºæˆ–å‘½ä»¤æ‰§è¡Œä¸­é‡åˆ°çš„å¼‚å¸¸æƒ…å†µã€‚å¯ä»¥å¯¹ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨æˆ–è€…å‡ ç»„ç³»ç»Ÿè°ƒç”¨è¿›è¡Œè¿‡æ»¤ï¼›å¯ä»¥é€šè¿‡ç»Ÿè®¡ç‰¹å®šç³»ç»Ÿè°ƒç”¨çš„è°ƒç”¨æ¬¡æ•°ã€è€—è´¹æ—¶é—´ã€æˆåŠŸå’Œå¤±è´¥çš„æ¬¡æ•°æ¥é…ç½®ç³»ç»Ÿè°ƒç”¨ï¼›è·Ÿè¸ªå‘é€ç»™è¿›ç¨‹çš„ä¿¡å·é‡ï¼›é€šè¿‡pidã€attacheåˆ°ä»»ä½•è¿è¡Œçš„è¿›ç¨‹.

â€‹	è·Ÿè¸ªå†…æ ¸æ€è°ƒç”¨

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```sh
[root@localhost ~]# strace -h
usage: strace [-CdffhiqrtttTvVwxxy] [-I n] [-e expr]...
              [-a column] [-o file] [-s strsize] [-P path]...
              -p pid... / [-D] [-E var=val]... [-u username] PROG [ARGS]
   or: strace -c[dfw] [-I n] [-e expr]... [-O overhead] [-S sortby]
              -p pid... / [-D] [-E var=val]... [-u username] PROG [ARGS]

Output format:
  -a column      alignment COLUMN for printing syscall results (default 40)
  -i             print instruction pointer at time of syscall
  -k             obtain stack trace between each syscall
  -o file        send trace output to FILE instead of stderr
  -q             suppress messages about attaching, detaching, etc.
  -r             print relative timestamp
  -s strsize     limit length of print strings to STRSIZE chars (default 32)
  -t             print absolute timestamp
  -tt            print absolute timestamp with usecs
  -T             print time spent in each syscall
  -x             print non-ascii strings in hex
  -xx            print all strings in hex
  -y             print paths associated with file descriptor arguments
  -yy            print protocol specific information associated with socket file descriptors

Statistics:
  -c             count time, calls, and errors for each syscall and report summary
  -C             like -c but also print regular output
  -O overhead    set overhead for tracing syscalls to OVERHEAD usecs
  -S sortby      sort syscall counts by: time, calls, name, nothing (default time)
  -w             summarise syscall latency (default is system time)

Filtering:
  -e expr        a qualifying expression: option=[!]all or option=[!]val1[,val2]...
     options:    trace, abbrev, verbose, raw, signal, read, write, fault, inject, kvm
  -P path        trace accesses to path

Tracing:
  -b execve      detach on execve syscall
  -D             run tracer process as a detached grandchild, not as parent
  -f             follow forks
  -ff            follow forks with output into separate files
  -I interruptible
     1:          no signals are blocked
     2:          fatal signals are blocked while decoding syscall (default)
     3:          fatal signals are always blocked (default if '-o FILE PROG')
     4:          fatal signals and SIGTSTP (^Z) are always blocked
                 (useful to make 'strace -o FILE PROG' not stop on ^Z)

Startup:
  -E var         remove var from the environment for command
  -E var=val     put var=val in the environment for command
  -p pid         trace process with process id PID, may be repeated
  -u username    run command as username handling setuid and/or setgid

Miscellaneous:
  -d             enable debug output to stderr
  -v             verbose mode: print unabbreviated argv, stat, termios, etc. args
  -h             print help message
  -V             print version

```

### å¸®åŠ©è¯´æ˜

| å‚æ•°             | ç”¨æ³•è¯´æ˜                                                     |
| ---------------- | ------------------------------------------------------------ |
| -a column        | åˆ—å¯¹é½çš„COLUMNï¼Œç”¨äºæ‰“å°**ç³»ç»Ÿè°ƒç”¨**ç»“æœï¼ˆé»˜è®¤å€¼ä¸º40ï¼‰       |
| -i               | åœ¨ç³»ç»Ÿè°ƒç”¨æ—¶æ‰“å°æŒ‡ä»¤æŒ‡é’ˆ                                     |
| -k               | è·å–æ¯ä¸ªç³»ç»Ÿè°ƒç”¨ä¹‹é—´çš„å †æ ˆè·Ÿè¸ª                               |
| -o file          | å°†è·Ÿè¸ªè¾“å‡ºå‘é€åˆ°FILEï¼Œè€Œä¸æ˜¯stderr                           |
| -t               | æ‰“å°ç»å¯¹æ—¶é—´æˆ³                                               |
| -T               | æ¯ä¸ªç³»ç»Ÿè°ƒç”¨èŠ±è´¹çš„æ‰“å°æ—¶é—´                                   |
| -tt              | ä½¿ç”¨usecsæ‰“å°ç»å¯¹æ—¶é—´æˆ³                                      |
| -ff              | å¦‚æœæä¾›-o filename,åˆ™æ‰€æœ‰è¿›ç¨‹çš„è·Ÿè¸ªç»“æœè¾“å‡ºåˆ°ç›¸åº”çš„filename.pidä¸­,pidæ˜¯å„è¿›ç¨‹çš„è¿›ç¨‹å· |
| -S sortby        | æŒ‰ä»¥ä¸‹é¡ºåºå¯¹ç³»ç»Ÿè°ƒç”¨è®¡æ•°ï¼šæ—¶é—´ï¼Œè°ƒç”¨ï¼Œåç§°ï¼Œæ— ï¼ˆé»˜è®¤æ—¶é—´ï¼‰   |
| -c               | ç»Ÿè®¡æ¯ä¸€ç³»ç»Ÿè°ƒç”¨çš„æ‰€æ‰§è¡Œçš„æ—¶é—´,æ¬¡æ•°å’Œå‡ºé”™çš„æ¬¡æ•°ç­‰            |
| -d               | è¾“å‡ºstraceå…³äºæ ‡å‡†é”™è¯¯çš„è°ƒè¯•ä¿¡æ¯                             |
| -f               | è·Ÿè¸ªç”±forkè°ƒç”¨æ‰€äº§ç”Ÿçš„å­è¿›ç¨‹.                                |
| -F               | å°è¯•è·Ÿè¸ªvforkè°ƒç”¨.åœ¨-fæ—¶,vforkä¸è¢«è·Ÿè¸ª.                      |
| -q               | ç¦æ­¢è¾“å‡ºå…³äºè„±ç¦»çš„æ¶ˆæ¯.                                      |
| -e trace=set     | åªè·Ÿè¸ªæŒ‡å®šçš„ç³»ç»Ÿè°ƒç”¨.ä¾‹å¦‚:-e trace=open,close,rean,writeè¡¨ç¤ºåªè·Ÿè¸ªè¿™å››ä¸ªç³»ç»Ÿè°ƒç”¨.é»˜è®¤çš„ä¸ºset=all. |
| -e trace=file    | åªè·Ÿè¸ªæœ‰å…³æ–‡ä»¶æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨.                                |
| -e trace=process | åªè·Ÿè¸ªæœ‰å…³è¿›ç¨‹æ§åˆ¶çš„ç³»ç»Ÿè°ƒç”¨.                                |
| -e trace=network | è·Ÿè¸ªä¸ç½‘ç»œæœ‰å…³çš„æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨.                                |
| -e strace=signal | è·Ÿè¸ªæ‰€æœ‰ä¸ç³»ç»Ÿä¿¡å·æœ‰å…³çš„ç³»ç»Ÿè°ƒç”¨                             |
| -e write=set     | è¾“å‡ºå†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸­çš„æ•°æ®.                                  |
| -o filename      | å°†straceçš„è¾“å‡ºå†™å…¥æ–‡ä»¶filename                               |
| -u username      | ä»¥usernameçš„UIDå’ŒGIDæ‰§è¡Œè¢«è·Ÿè¸ªçš„å‘½ä»¤                         |

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹ï¼š

æŸ¥çœ‹mysqldåœ¨linuxä¸ŠåŠ è½½å“ªç§é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼šstrace â€“e stat64 mysqld â€“print â€“defaults > /dev/null

æ¡ˆä¾‹ï¼š strace -f -p pidå€¼ -ttt -o /tmp/strace.log



---

## ltrace

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

â€‹	è·Ÿè¸ªç”¨æˆ·æ€è°ƒç”¨

### å·¥å…·å®‰è£…

```sh
yum install -y ltrace
```

### å¸®åŠ©ä¿¡æ¯

```sh
[root@localhost bin]# ltrace -h
Usage: ltrace [option ...] [command [arg ...]]
Trace library calls of a given program.

  -a, --align=COLUMN  align return values in a secific column.
  -A MAXELTS          maximum number of array elements to print.
  -b, --no-signals    don't print signals.
  -c                  count time and calls, and report a summary on exit.
  -C, --demangle      decode low-level symbol names into user-level names.
  -D, --debug=MASK    enable debugging (see -Dh or --debug=help).
  -Dh, --debug=help   show help on debugging.
  -e FILTER           modify which library calls to trace.
  -f                  trace children (fork() and clone()).
  -F, --config=FILE   load alternate configuration file (may be repeated).
  -h, --help          display this help and exit.
  -i                  print instruction pointer at time of library call.
  -l, --library=LIBRARY_PATTERN only trace symbols implemented by this library.
  -L                  do NOT display library calls.
  -n, --indent=NR     indent output by NR spaces for each call level nesting.
  -o, --output=FILENAME write the trace output to file with given name.
  -p PID              attach to the process with the process ID pid.
  -r                  print relative timestamps.
  -s STRSIZE          specify the maximum string size to print.
  -S                  trace system calls as well as library calls.
  -t, -tt, -ttt       print absolute timestamps.
  -T                  show the time spent inside each call.
  -u USERNAME         run command with the userid, groupid of username.
  -V, --version       output version information and exit.
  -w, --where=NR      print backtrace showing NR stack frames at most.
  -x FILTER           modify which static functions to trace.


```

### å¸®åŠ©è¯´æ˜

| å‚æ•°                          | ç”¨æ³•                                   |
| ----------------------------- | -------------------------------------- |
| -a, --align=column            | COLUMNå°†è¿”å›å€¼åœ¨ä¸€ä¸ªsecificåˆ—ä¸­å¯¹é½    |
| -A MAXELTS                    | è¦æ‰“å°çš„æœ€å¤§æ•°ç»„å…ƒç´ æ•°                 |
| -b, --no-signals              | ä¸æ‰“å°ä¿¡å·                             |
| -c                            | è®¡ç®—æ—¶é—´å’Œè°ƒç”¨æ¬¡æ•°ï¼Œå¹¶åœ¨é€€å‡ºæ—¶æŠ¥å‘Šæ‘˜è¦ |
| -C, --demangle                | å°†ä½çº§ç¬¦å·åç§°è§£ç ä¸ºç”¨æˆ·çº§åç§°         |
| -D, --debug=MASK              | å¯ç”¨è°ƒè¯•                               |
| -Dh, --debug=help             | helpæ˜¾ç¤ºè°ƒè¯•å¸®åŠ©                       |
| -e FILTER                     | ä¿®æ”¹è¦è·Ÿè¸ªçš„åº“è°ƒç”¨                     |
| -f                            | è·Ÿè¸ªå­é¡¹ï¼ˆforkï¼ˆï¼‰å’Œcloneï¼ˆï¼‰ï¼‰        |
| -F, --config=FILE             | åŠ è½½å¤‡ç”¨é…ç½®æ–‡ä»¶ï¼ˆå¯ä»¥é‡å¤ï¼‰           |
| -i                            | åœ¨è°ƒç”¨åº“æ—¶æ‰“å°æŒ‡ä»¤æŒ‡é’ˆ                 |
| -l, --library=LIBRARY_PATTERN | ä»…è·Ÿè¸ªç”±è¯¥åº“å®ç°çš„ç¬¦å·                 |
| -L                            | ä¸æ˜¾ç¤ºåº“è°ƒç”¨                           |
| -n, --indent=NR               | NRç©ºé—´ä¸ºæ¯ä¸ªè°ƒç”¨çº§åˆ«åµŒå¥—è¾“å‡ºç¼©è¿›       |
| -o, --output=FILENAME         | å°†è·Ÿè¸ªè¾“å‡ºå†™å…¥å…·æœ‰ç»™å®šåç§°çš„æ–‡ä»¶       |
| -p PID                        | ä»¥è¿›ç¨‹ID pidé™„åŠ åˆ°è¿›ç¨‹                 |
| -r                            | æ‰“å°ç›¸å¯¹æ—¶é—´æˆ³                         |
| -s STRSIZE                    | æŒ‡å®šè¦æ‰“å°çš„æœ€å¤§å­—ç¬¦ä¸²å¤§å°             |
| -S                            | è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨ä»¥åŠåº“è°ƒç”¨                 |
| -t, -tt, -ttt                 | æ‰“å°ç»å¯¹æ—¶é—´æˆ³                         |
| -T                            | æ˜¾ç¤ºæ¯æ¬¡é€šè¯æ‰€èŠ±è´¹çš„æ—¶é—´               |
| -u USERNAME                   | è¿è¡Œå‘½ä»¤ï¼Œå¸¦æœ‰ç”¨æˆ·åï¼Œç”¨æˆ·åçš„ç»„æ ‡è¯†   |
| -w, --where=NR                | æ‰“å°å›æº¯ï¼Œæœ€å¤šæ˜¾ç¤ºNRå †æ ˆå¸§             |
| -x FILTER                     | ä¿®æ”¹è¦è·Ÿè¸ªçš„é™æ€å‡½æ•°                   |

### æ¡ˆä¾‹å®æ“





---

## lsof

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

lsof(list open files)æ˜¯ä¸€ä¸ªåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```sh
$ lsof --help
lsof: illegal option character: -
lsof: -e not followed by a file system path: "lp"
lsof 4.91
 latest revision: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/
 latest FAQ: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/FAQ
 latest man page: ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/lsof_man
 usage: [-?abhKlnNoOPRtUvVX] [+|-c c] [+|-d s] [+D D] [+|-E] [+|-e s] [+|-f[gG]]
 [-F [f]] [-g [s]] [-i [i]] [+|-L [l]] [+m [m]] [+|-M] [-o [o]] [-p s]
 [+|-r [t]] [-s [p:s]] [-S [t]] [-T [t]] [-u s] [+|-w] [-x [fl]] [-Z [Z]] [--] [names]
Defaults in parentheses; comma-separated set (s) items; dash-separated ranges.
  -?|-h list help          -a AND selections (OR)     -b avoid kernel blocks
  -c c  cmd c ^c /c/[bix]  +c w  COMMAND width (9)    +d s  dir s files
  -d s  select by FD set   +D D  dir D tree *SLOW?*   +|-e s  exempt s *RISKY*
  -i select IPv[46] files  -K [i] list|(i)gn tasKs    -l list UID numbers
  -n no host names         -N select NFS files        -o list file offset
  -O no overhead *RISKY*   -P no port names           -R list paRent PID
  -s list file size        -t terse listing           -T disable TCP/TPI info
  -U select Unix socket    -v list version info       -V verbose search
  +|-w  Warnings (+)       -X skip TCP&UDP* files     -Z Z  context [Z]
  -- end option scan
  -E display endpoint info              +E display endpoint info and files
  +f|-f  +filesystem or -file names     +|-f[gG] flaGs
  -F [f] select fields; -F? for help
  +|-L [l] list (+) suppress (-) link counts < l (0 = all; default = 0)
                                        +m [m] use|create mount supplement
  +|-M   portMap registration (-)       -o o   o 0t offset digits (8)
  -p s   exclude(^)|select PIDs         -S [t] t second stat timeout (15)
  -T qs TCP/TPI Q,St (s) info
  -g [s] exclude(^)|select and print process group IDs
  -i i   select by IPv[46] address: [46][proto][@host|addr][:svc_list|port_list]
  +|-r [t[m<fmt>]] repeat every t seconds (15);  + until no files, - forever.
       An optional suffix to t is m<fmt>; m must separate t from <fmt> and
      <fmt> is an strftime(3) format for the marker line.
  -s p:s  exclude(^)|select protocol (p = TCP|UDP) states by name(s).
  -u s   exclude(^)|select login|UID set s
  -x [fl] cross over +d|+D File systems or symbolic Links
  names  select named files or files on named file systems
Anyone can list all files; /dev warnings disabled; kernel ID check disabled.
```

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿé˜»å¡  lsof /boot

æŸ¥çœ‹ç«¯å£å·è¢«å“ªä¸ªè¿›ç¨‹å ç”¨  lsof  -i : 3306

æŸ¥çœ‹ç”¨æˆ·æ‰“å¼€å“ªäº›æ–‡ä»¶  lsof â€“u username

æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€å“ªäº›æ–‡ä»¶  lsof â€“p  4838

æŸ¥çœ‹è¿œç¨‹å·²æ‰“å¼€çš„ç½‘ç»œé“¾æ¥  lsof â€“i @192.168.34.128

---

## perf_events

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://blog.sina.com.cn/s/blog_98822316010122ex.html

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## eBPF tools

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://blog.csdn.net/ljy1988123/article/details/50444693

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## perf-tools

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://github.com/brendangregg/perf-tools

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## bcc(BPF Compiler Collection)

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://github.com/iovisor/bcc#tools

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## ktap

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://github.com/ktap/ktap

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## Flame Graphs

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

http://www.brendangregg.com/flamegraphs.html

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## ab

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://man.linuxde.net/ab

â€‹	https://blog.csdn.net/ZYC88888/article/details/85051946

### å·¥å…·ç”¨é€”

â€‹	æ˜¯Apacheçš„WebæœåŠ¡å™¨çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä»¥æµ‹è¯•å®‰è£…WebæœåŠ¡å™¨æ¯ç§’ç§å¤„ç†çš„HTTPè¯·æ±‚

### å·¥å…·å®‰è£…

â€‹	centosä¸­å®‰è£…ï¼š`sudo yum install -y httpd-tools` 

### å¸®åŠ©ä¿¡æ¯

```shell
# ab --help
ab: wrong number of arguments
Usage: ab [options] [http[s]://]hostname[:port]/path
Options are:
    -n requests     Number of requests to perform
    -c concurrency  Number of multiple requests to make at a time
    -t timelimit    Seconds to max. to spend on benchmarking
                    This implies -n 50000
    -s timeout      Seconds to max. wait for each response
                    Default is 30 seconds
    -b windowsize   Size of TCP send/receive buffer, in bytes
    -B address      Address to bind to when making outgoing connections
    -p postfile     File containing data to POST. Remember also to set -T
    -u putfile      File containing data to PUT. Remember also to set -T
    -T content-type Content-type header to use for POST/PUT data, eg.
                    'application/x-www-form-urlencoded'
                    Default is 'text/plain'
    -v verbosity    How much troubleshooting info to print
    -w              Print out results in HTML tables
    -i              Use HEAD instead of GET
    -x attributes   String to insert as table attributes
    -y attributes   String to insert as tr attributes
    -z attributes   String to insert as td or th attributes
    -C attribute    Add cookie, eg. 'Apache=1234'. (repeatable)
    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'
                    Inserted after all normal header lines. (repeatable)
    -A attribute    Add Basic WWW Authentication, the attributes
                    are a colon separated username and password.
    -P attribute    Add Basic Proxy Authentication, the attributes
                    are a colon separated username and password.
    -X proxy:port   Proxyserver and port number to use
    -V              Print version number and exit
    -k              Use HTTP KeepAlive feature
    -d              Do not show percentiles served table.
    -S              Do not show confidence estimators and warnings.
    -q              Do not show progress when doing more than 150 requests
    -g filename     Output collected data to gnuplot format file.
    -e filename     Output CSV file with percentages served
    -r              Don't exit on socket receive errors.
    -h              Display usage information (this message)
    -Z ciphersuite  Specify SSL/TLS cipher suite (See openssl ciphers)
    -f protocol     Specify SSL/TLS protocol
                    (SSL3, TLS1, TLS1.1, TLS1.2 or ALL)
```

### å¸®åŠ©è¯´æ˜

```
-Aï¼šæŒ‡å®šè¿æ¥æœåŠ¡å™¨çš„åŸºæœ¬çš„è®¤è¯å‡­æ®ï¼›
-cï¼šæŒ‡å®šä¸€æ¬¡å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚æ•°ï¼›
-Cï¼šæ·»åŠ cookieï¼›
-gï¼šå°†æµ‹è¯•ç»“æœè¾“å‡ºä¸ºâ€œgnuolotâ€æ–‡ä»¶ï¼›
-hï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼›
-Hï¼šä¸ºè¯·æ±‚è¿½åŠ ä¸€ä¸ªé¢å¤–çš„å¤´ï¼›
-iï¼šä½¿ç”¨â€œheadâ€è¯·æ±‚æ–¹å¼ï¼›
-kï¼šæ¿€æ´»HTTPä¸­çš„â€œkeepAliveâ€ç‰¹æ€§ï¼›
-nï¼šæŒ‡å®šæµ‹è¯•ä¼šè¯ä½¿ç”¨çš„è¯·æ±‚æ•°ï¼›
-pï¼šæŒ‡å®šåŒ…å«æ•°æ®çš„æ–‡ä»¶ï¼›
-qï¼šä¸æ˜¾ç¤ºè¿›åº¦ç™¾åˆ†æ¯”ï¼›
-Tï¼šä½¿ç”¨POSTæ•°æ®æ—¶ï¼Œè®¾ç½®å†…å®¹ç±»å‹å¤´ï¼›
-vï¼šè®¾ç½®è¯¦ç»†æ¨¡å¼ç­‰çº§ï¼›
-wï¼šä»¥HTMLè¡¨æ ¼æ–¹å¼æ‰“å°ç»“æœï¼›
-xï¼šä»¥è¡¨æ ¼æ–¹å¼è¾“å‡ºæ—¶ï¼Œè®¾ç½®è¡¨æ ¼çš„å±æ€§ï¼›
-Xï¼šä½¿ç”¨æŒ‡å®šçš„ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼›
-yï¼šä»¥è¡¨æ ¼æ–¹å¼è¾“å‡ºæ—¶ï¼Œè®¾ç½®è¡¨æ ¼å±æ€§ã€‚
```



### æ¡ˆä¾‹å®æ“

---

## jmap

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://www.jianshu.com/p/a4ad53179df3

â€‹	https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jmap.html

### å·¥å…·ç”¨é€”

â€‹	å®ƒæ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„å‘½ä»¤ï¼Œå¯ä»¥ç”Ÿæˆjavaç¨‹åºçš„dumpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹å †å†…å¯¹è±¡ç¤ºä¾‹çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒæŸ¥çœ‹classLoaderçš„ä¿¡æ¯ä»¥åŠfinalizeré˜Ÿåˆ—

### å·¥å…·å®‰è£…

â€‹	javaç¯å¢ƒè‡ªå¸¦

### å¸®åŠ©ä¿¡æ¯

```shell
$ jmap --help
Usage:
    jmap [option] <pid>
        (to connect to running process)
    jmap [option] <executable <core>
        (to connect to a core file)
    jmap [option] [server_id@]<remote server IP or hostname>
        (to connect to remote debug server)

where <option> is one of:
    <none>               to print same info as Solaris pmap
    -heap                to print java heap summary
    -histo[:live]        to print histogram of java object heap; if the "live"
                         suboption is specified, only count live objects
    -permstat            to print permanent generation statistics
    -finalizerinfo       to print information on objects awaiting finalization
    -dump:<dump-options> to dump java heap in hprof binary format
                         dump-options:
                           live         dump only live objects; if not specified,
                                        all objects in the heap are dumped.
                           format=b     binary format
                           file=<file>  dump heap to <file>
                         Example: jmap -dump:live,format=b,file=heap.bin <pid>
    -F                   force. Use with -dump:<dump-options> <pid> or -histo
                         to force a heap dump or histogram when <pid> does not
                         respond. The "live" suboption is not supported
                         in this mode.
    -h | -help           to print this help message
    -J<flag>             to pass <flag> diectly to the runtime system

```

### å¸®åŠ©è¯´æ˜

	+ pid: éœ€æ‰“å°é…ç½®ä¿¡æ¯çš„è¿›ç¨‹id
	+ executableï¼š äº§ç”Ÿæ ¸å¿ƒdumpçš„javaå¯æ‰§è¡Œæ–‡ä»¶
	+ coreï¼š éœ€è¦æ‰“å°é…ç½®ä¿¡æ¯çš„æ ¸å¿ƒæ–‡ä»¶
	+ server-id: å¯é€‰å¯¹å”¯ä¸€idï¼Œå¦‚æœç›¸åŒçš„è¿œç¨‹ä¸»æœºä¸Šå…è®¸äº†å¤šå°è°ƒè¯•æœåŠ¡å™¨ï¼Œç”¨æ­¤é€‰é¡¹å‚æ•°æ ‡è¯†æœåŠ¡å™¨
	+ remote server ip or hostnameï¼š è¿œç¨‹è°ƒç”¨æœåŠ¡å™¨çš„ipåœ°å€æˆ–ä¸»æœºå
 + **option**
   	+ no opetion: æŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜æ˜ åƒä¿¡æ¯ï¼Œç±»ä¼¼solaris pmapå‘½ä»¤
      	+ heapï¼šæ˜¾ç¤ºjavaå †è¯¦ç»†ä¿¡æ¯
      	+ histo[:live]: æ˜¾ç¤ºå †ä¸­å¯¹è±¡çš„ç»Ÿè®¡ä¿¡æ¯
              	+ clsats: æ‰“å°ç±»åŠ è½½å™¨ä¿¡æ¯
              	+ finalizeinfoï¼š æ˜¾ç¤ºåœ¨F-Queueé˜Ÿåˆ—ç­‰å¾…Finalizerçº¿ç¨‹æ‰§è¡Œfinalizeræ–¹æ³•çš„å¯¹è±¡
      	+ dump:<dump-options>ï¼š ç”Ÿæˆå †è½¬å‚¨å¿«ç…§
              	+ Fï¼š å½“-dumpæ²¡æœ‰å“åº”æ—¶ï¼Œä½¿ç”¨-dumpæˆ–-histoå‚æ•°ã€‚
              	+ J<flag>ï¼šæŒ‡å®šä¼ é€’ç»™è¿è¡Œjmapçš„JVMçš„å‚æ•°

### æ¡ˆä¾‹å®æ“

æ¡ˆä¾‹ï¼šjmap pid	æŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜æ˜ åƒä¿¡æ¯ï¼Œç±»ä¼¼solaris pmapå‘½ä»¤

æ¡ˆä¾‹ï¼š jmap -heap pid	æ˜¾ç¤ºjavaå †è¯¦ç»†ä¿¡æ¯

æ¡ˆä¾‹ï¼š jmap -histo:live pid	æ˜¾ç¤ºå †ä¸­å¯¹è±¡çš„ç»Ÿè®¡ä¿¡æ¯

æ¡ˆä¾‹ï¼š jmap -clstats pid	æ‰“å°ç±»åŠ è½½å™¨ä¿¡æ¯

æ¡ˆä¾‹ï¼š jmap --finalizerinfo pid	æ‰“å°ç­‰å¾…ç»ˆç»“çš„å¯¹è±¡ä¿¡æ¯

æ¡ˆä¾‹ï¼š jmap -dump:format=b,file=heapdump.phrof pid	ç”Ÿæˆå †è½¬å‚¨å¿«ç…§dumpæ–‡ä»¶

---

## jstack

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

â€‹	jstack å‘½ä»¤ä¸»è¦ç”¨äºè°ƒè¯•javaç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„çº¿ç¨‹å †æ ˆä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºæ£€æµ‹æ­»é”ï¼Œè¿›ç¨‹è€—ç”¨cpuè¿‡é«˜æŠ¥è­¦é—®é¢˜çš„æ’æŸ¥

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## bcc -- filetop

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## bcc -- opensnoop

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## sysctl

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://ipcmen.com/sysctl

[sysctlå‘½ä»¤_yuioplvçš„åšå®¢-CSDNåšå®¢_sysctl](https://blog.csdn.net/yuioplv/article/details/95034787)

### å·¥å…·ç”¨é€”

sysctl ç”¨äºè¿è¡Œæ—¶é…ç½®å†…æ ¸å‚æ•°ï¼Œè¿™äº›å‚æ•°ä½äº/proc/sysç›®å½•ä¸‹ã€‚sysctlé…ç½®ä¸æ˜¾ç¤ºåœ¨/proc/sysç›®å½•ä¸­çš„å†…æ ¸å‚æ•°.linuxç³»ç»Ÿåœ¨å¯åŠ¨æ—¶ï¼Œsystemd-sysctlä¼šæ ¹æ®ä¼˜å…ˆçº§ï¼Œä¾æ¬¡è¯»å– â‘  /etc/sysctl.d/\*.conf â‘¡ /run/sysctl.d/\*.conf â‘¢ /usr/lib/sysctl.d/*.conf æ–‡ä»¶è¯»å–sysctlå†…æ ¸å‚æ•°

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```sh
[root@localhost ~]# sysctl --help

Usage:
 sysctl [options] [variable[=value] ...]

Options:
  -a, --all            display all variables
  -A                   alias of -a
  -X                   alias of -a
      --deprecated     include deprecated parameters to listing
  -b, --binary         print value without new line
  -e, --ignore         ignore unknown variables errors
  -N, --names          print variable names without values
  -n, --values         print only values of the given variable(s)
  -p, --load[=<file>]  read values from file
  -f                   alias of -p
      --system         read values from all system directories
  -r, --pattern <expression>
                       select setting that match expression
  -q, --quiet          do not echo variable set
  -w, --write          enable writing a value to variable
  -o                   does nothing
  -x                   does nothing
  -d                   alias of -h

 -h, --help     display this help and exit
 -V, --version  output version information and exit

For more details see sysctl(8).

```



### å¸®åŠ©è¯´æ˜

```sh
åå­—
       sysctl - åœ¨è¿è¡Œæ—¶é…ç½®å†…æ ¸å‚æ•°

è¯­æ³•
       sysctl [options] [variable[=value]] [...]
       sysctl -p [file or regexp] [...]

æè¿°
       sysctl å¯ä»¥åœ¨è¿è¡Œæ—¶é…ç½®å†…æ ¸å‚æ•°ã€‚æ‰€æœ‰å¯ç”¨å‚æ•°éƒ½ä½äº /proc/sys/ ç›®å½•ä¸‹ã€‚

å‚æ•°ä¸é€‰é¡¹
       variable
              è¦è¯»å–å…¶å€¼çš„å˜é‡ï¼Œæ¯”å¦‚"kernel.ostype"ã€‚[æç¤º]"."ä¹Ÿå¯ä»¥ç”¨"/"ä»£æ›¿ã€‚

       variable=value
              è¦è®¾ç½®å˜é‡åŠç›¸åº”çš„å€¼ã€‚å¿…é¡»åŒæ—¶ä½¿ç”¨ -w é€‰é¡¹ã€‚
              å¦‚æœå€¼ä¸­å«æœ‰ç‰¹æ®Šæ„ä¹‰çš„shellå­—ç¬¦æˆ–å¼•å·ï¼Œé‚£ä¹ˆä½ æœ€å¥½ä½¿ç”¨åŒå¼•å·è¿›è¡Œç•Œå®šã€‚

       -n, --values
              æ˜¾ç¤ºå˜é‡å€¼çš„åŒæ—¶ä¸æ˜¾ç¤ºå˜é‡å

       -e, --ignore
              å¿½ç•¥ä¸æ­£ç¡®çš„å˜é‡åè€Œä¸æŠ¥é”™

       -N, --names
              ä»…æ˜¾ç¤ºå˜é‡åã€‚å¸¸ç”¨äºè„šæœ¬ä¸­ã€‚

       -q, --quiet
              ä¸åœ¨ stdout ä¸Šæ˜¾ç¤ºå˜é‡å€¼

       -w, --write
              å¦‚æœä½ æƒ³ä¿®æ”¹å˜é‡çš„å€¼ï¼Œå°±å¿…é¡»ä½¿ç”¨æ­¤é€‰é¡¹

       -p[FILE], --load[=FILE]
              ä»æŒ‡å®šæ–‡ä»¶(é»˜è®¤ /etc/sysctl.conf)ä¸­åŠ è½½å·²ç»è®¾ç½®å¥½çš„ä¸€ç³»åˆ—å˜é‡å€¼ã€‚
              å¦‚æœä½¿ç”¨ - ä½œä¸ºæ–‡ä»¶åï¼Œé‚£ä¹ˆè¡¨ç¤ºä» stdin è¯»å–é…ç½®ã€‚
              FILE è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥åŒ¹é…å¤šä¸ªæ–‡ä»¶ã€‚

       -a, --all
              æ˜¾ç¤ºæ‰€æœ‰å½“å‰çš„å˜é‡å

       --deprecated
              åœ¨ --all çš„è¾“å‡ºä¸­åŒ…å«å·²è¢«åå¯¹ä½¿ç”¨çš„å‚æ•°

       -b, --binary
              æ‰“å°å€¼æ—¶ä¸æ·»åŠ æ¢è¡Œæ ‡è®°

       --system
              ä»æ‰€æœ‰ä¸‹åˆ—é…ç½®æ–‡ä»¶ä¸­åŠ è½½ç³»ç»Ÿè®¾ç½®
              /run/sysctl.d/*.conf
              /etc/sysctl.d/*.conf
              /usr/local/lib/sysctl.d/*.conf
              /usr/lib/sysctl.d/*.conf
              /lib/sysctl.d/*.conf
              /etc/sysctl.conf

       -r, --pattern pattern
              ä»…åº”ç”¨ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ–‡ä»¶ä¸­çš„è®¾ç½®ã€‚

       -h, --help
              æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯åé€€å‡º

       -V, --version
              æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯åé€€å‡º
```



### æ¡ˆä¾‹å®æ“

```sh
/sbin/sysctl -a
/sbin/sysctl -n kernel.hostname
/sbin/sysctl -w kernel.domainname="example.com"
/sbin/sysctl -p/etc/sysctl.conf
/sbin/sysctl -a --pattern forward
/sbin/sysctl -a --pattern forward$
/sbin/sysctl -a --pattern 'net.ipv4.conf.(eth|wlan)0.arp'
/sbin/sysctl --system --pattern '^net.ipv6'
```



```
# è®¾ç½®ipåœ°å€ç¦ping
/sbin/sysctl -w net.ipv4.icmp_echo_ignore_all=1
/sbin/sysctl -w net.ipv4.route.flush=1
/sbin/sysctl -p
```



---

## ethtool

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://www.cnblogs.com/danxi/p/6591885.html

https://www.cnblogs.com/pengdonglin137/p/3578919.html

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
[root@localhost ~]# ethtool --help
ethtool version 4.16
Usage:
        ethtool DEVNAME Display standard information about device
        ethtool -s|--change DEVNAME     Change generic options
                [ speed %d ]
                [ duplex half|full ]
                [ port tp|aui|bnc|mii|fibre ]
                [ mdix auto|on|off ]
                [ autoneg on|off ]
                [ advertise %x ]
                [ phyad %d ]
                [ xcvr internal|external ]
                [ wol p|u|m|b|a|g|s|d... ]
                [ sopass %x:%x:%x:%x:%x:%x ]
                [ msglvl %d | msglvl type on|off ... ]
        ethtool -a|--show-pause DEVNAME Show pause options
        ethtool -A|--pause DEVNAME      Set pause options
                [ autoneg on|off ]
                [ rx on|off ]
                [ tx on|off ]
        ethtool -c|--show-coalesce DEVNAME      Show coalesce options
        ethtool -C|--coalesce DEVNAME   Set coalesce options
                [adaptive-rx on|off]
                [adaptive-tx on|off]
                [rx-usecs N]
                [rx-frames N]
                [rx-usecs-irq N]
                [rx-frames-irq N]
                [tx-usecs N]
                [tx-frames N]
                [tx-usecs-irq N]
                [tx-frames-irq N]
                [stats-block-usecs N]
                [pkt-rate-low N]
                [rx-usecs-low N]
                [rx-frames-low N]
                [tx-usecs-low N]
                [tx-frames-low N]
                [pkt-rate-high N]
                [rx-usecs-high N]
                [rx-frames-high N]
                [tx-usecs-high N]
                [tx-frames-high N]
                [sample-interval N]
        ethtool -g|--show-ring DEVNAME  Query RX/TX ring parameters
        ethtool -G|--set-ring DEVNAME   Set RX/TX ring parameters
                [ rx N ]
                [ rx-mini N ]
                [ rx-jumbo N ]
                [ tx N ]
        ethtool -k|--show-features|--show-offload DEVNAME       Get state of protocol offload and other features
        ethtool -K|--features|--offload DEVNAME Set protocol offload and other features
                FEATURE on|off ...
        ethtool -i|--driver DEVNAME     Show driver information
        ethtool -d|--register-dump DEVNAME      Do a register dump
                [ raw on|off ]
                [ file FILENAME ]
        ethtool -e|--eeprom-dump DEVNAME        Do a EEPROM dump
                [ raw on|off ]
                [ offset N ]
                [ length N ]
        ethtool -E|--change-eeprom DEVNAME      Change bytes in device EEPROM
                [ magic N ]
                [ offset N ]
                [ length N ]
                [ value N ]
        ethtool -r|--negotiate DEVNAME  Restart N-WAY negotiation
        ethtool -p|--identify DEVNAME   Show visible port identification (e.g. blinking)
               [ TIME-IN-SECONDS ]
        ethtool -t|--test DEVNAME       Execute adapter self test
               [ online | offline | external_lb ]
        ethtool -S|--statistics DEVNAME Show adapter statistics
        ethtool --phy-statistics DEVNAME        Show phy statistics
        ethtool -n|-u|--show-nfc|--show-ntuple DEVNAME  Show Rx network flow classification options or rules
                [ rx-flow-hash tcp4|udp4|ah4|esp4|sctp4|tcp6|udp6|ah6|esp6|sctp6 [context %d] |
                  rule %d ]
        ethtool -N|-U|--config-nfc|--config-ntuple DEVNAME      Configure Rx network flow classification options or rules
                rx-flow-hash tcp4|udp4|ah4|esp4|sctp4|tcp6|udp6|ah6|esp6|sctp6 m|v|t|s|d|f|n|r... [context %d] |
                flow-type ether|ip4|tcp4|udp4|sctp4|ah4|esp4|ip6|tcp6|udp6|ah6|esp6|sctp6
                        [ src %x:%x:%x:%x:%x:%x [m %x:%x:%x:%x:%x:%x] ]
                        [ dst %x:%x:%x:%x:%x:%x [m %x:%x:%x:%x:%x:%x] ]
                        [ proto %d [m %x] ]
                        [ src-ip IP-ADDRESS [m IP-ADDRESS] ]
                        [ dst-ip IP-ADDRESS [m IP-ADDRESS] ]
                        [ tos %d [m %x] ]
                        [ tclass %d [m %x] ]
                        [ l4proto %d [m %x] ]
                        [ src-port %d [m %x] ]
                        [ dst-port %d [m %x] ]
                        [ spi %d [m %x] ]
                        [ vlan-etype %x [m %x] ]
                        [ vlan %x [m %x] ]
                        [ user-def %x [m %x] ]
                        [ dst-mac %x:%x:%x:%x:%x:%x [m %x:%x:%x:%x:%x:%x] ]
                        [ action %d ] | [ vf %d queue %d ]
                        [ context %d ]
                        [ loc %d]] |
                delete %d
        ethtool -T|--show-time-stamping DEVNAME Show time stamping capabilities
        ethtool -x|--show-rxfh-indir|--show-rxfh DEVNAME        Show Rx flow hash indirection table and/or RSS hash key
                [ context %d ]
        ethtool -X|--set-rxfh-indir|--rxfh DEVNAME      Set Rx flow hash indirection table and/or RSS hash key
                [ context %d|new ]
                [ equal N | weight W0 W1 ... | default ]
                [ hkey %x:%x:%x:%x:%x:.... ]
                [ hfunc FUNC ]
                [ delete ]
        ethtool -f|--flash DEVNAME      Flash firmware image from the specified file to a region on the device
               FILENAME [ REGION-NUMBER-TO-FLASH ]
        ethtool -P|--show-permaddr DEVNAME      Show permanent hardware address
        ethtool -w|--get-dump DEVNAME   Get dump flag, data
                [ data FILENAME ]
        ethtool -W|--set-dump DEVNAME   Set dump flag of the device
                N
        ethtool -l|--show-channels DEVNAME      Query Channels
        ethtool -L|--set-channels DEVNAME       Set Channels
               [ rx N ]
               [ tx N ]
               [ other N ]
               [ combined N ]
        ethtool --show-priv-flags DEVNAME       Query private flags
        ethtool --set-priv-flags DEVNAME        Set private flags
                FLAG on|off ...
        ethtool -m|--dump-module-eeprom|--module-info DEVNAME   Query/Decode Module EEPROM information and optical diagnostics if available
                [ raw on|off ]
                [ hex on|off ]
                [ offset N ]
                [ length N ]
        ethtool --show-eee DEVNAME      Show EEE settings
        ethtool --set-eee DEVNAME       Set EEE settings
                [ eee on|off ]
                [ advertise %x ]
                [ tx-lpi on|off ]
                [ tx-timer %d ]
        ethtool --set-phy-tunable DEVNAME       Set PHY tunable
                [ downshift on|off [count N] ]
        ethtool --get-phy-tunable DEVNAME       Get PHY tunable
                [ downshift ]
        ethtool --reset DEVNAME Reset components
                [ flags %x ]
                [ mgmt ]
                [ mgmt-shared ]
                [ irq ]
                [ irq-shared ]
                [ dma ]
                [ dma-shared ]
                [ filter ]
                [ filter-shared ]
                [ offload ]
                [ offload-shared ]
                [ mac ]
                [ mac-shared ]
                [ phy ]
                [ phy-shared ]
                [ ram ]
                [ ram-shared ]
                [ ap ]
                [ ap-shared ]
                [ dedicated ]
                [ all ]
        ethtool --show-fec DEVNAME      Show FEC settings
        ethtool --set-fec DEVNAME       Set FEC settings
                [ encoding auto|off|rs|baser ]
        ethtool -h|--help               Show this help
        ethtool --version               Show version number

```



### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“

---

## traceroute

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

â€‹	https://blog.csdn.net/llq_200/article/details/81034345

### å·¥å…·ç”¨é€”

â€‹	é€šè¿‡tracerouteæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¿¡æ¯ä»ä½ çš„è®¡ç®—æœºåˆ°äº’è”ç½‘å¦ä¸€ç«¯çš„ä¸»æœºæ˜¯èµ°çš„ä»€ä¹ˆè·¯å¾„.å½“ç„¶æ¯æ¬¡æ•°æ®åŒ…ç”±æŸä¸€åŒæ ·çš„å‡ºå‘ç‚¹ï¼ˆsourceï¼‰åˆ°è¾¾æŸä¸€åŒæ ·çš„ç›®çš„åœ°(destination)èµ°çš„è·¯å¾„å¯èƒ½ä¼šä¸ä¸€æ ·ï¼Œä½†åŸºæœ¬ä¸Šæ¥è¯´å¤§éƒ¨åˆ†æ—¶å€™æ‰€èµ°çš„è·¯ç”±æ˜¯ç›¸åŒçš„ã€‚

### å·¥å…·å®‰è£…

```shell
yum install traceroute -y
```



### å¸®åŠ©ä¿¡æ¯

```sh
[root@localhost ~]# traceroute --help
Usage:
  traceroute [ -46dFITnreAUDV ] [ -f first_ttl ] [ -g gate,... ] [ -i device ] [ -m max_ttl ] [ -N squeries ] [ -p port ] [ -t tos ] [ -l flow_label ] [ -w MAX,HERE,NEAR ] [ -q nqueries ] [ -s src_addr ] [ -z sendwait ] [ --fwmark=num ] host [ packetlen ]
Options:
  -4                          Use IPv4
  -6                          Use IPv6
  -d  --debug                 Enable socket level debugging
  -F  --dont-fragment         Do not fragment packets
  -f first_ttl  --first=first_ttl
                              Start from the first_ttl hop (instead from 1)
  -g gate,...  --gateway=gate,...
                              Route packets through the specified gateway
                              (maximum 8 for IPv4 and 127 for IPv6)
  -I  --icmp                  Use ICMP ECHO for tracerouting
  -T  --tcp                   Use TCP SYN for tracerouting (default port is 80)
  -i device  --interface=device
                              Specify a network interface to operate with
  -m max_ttl  --max-hops=max_ttl
                              Set the max number of hops (max TTL to be
                              reached). Default is 30
  -N squeries  --sim-queries=squeries
                              Set the number of probes to be tried
                              simultaneously (default is 16)
  -n                          Do not resolve IP addresses to their domain names
  -p port  --port=port        Set the destination port to use. It is either
                              initial udp port value for "default" method
                              (incremented by each probe, default is 33434), or
                              initial seq for "icmp" (incremented as well,
                              default from 1), or some constant destination
                              port for other methods (with default of 80 for
                              "tcp", 53 for "udp", etc.)
  -t tos  --tos=tos           Set the TOS (IPv4 type of service) or TC (IPv6
                              traffic class) value for outgoing packets
  -l flow_label  --flowlabel=flow_label
                              Use specified flow_label for IPv6 packets
  -w MAX,HERE,NEAR  --wait=MAX,HERE,NEAR
                              Wait for a probe no more than HERE (default 3)
                              times longer than a response from the same hop,
                              or no more than NEAR (default 10) times than some
                              next hop, or MAX (default 5.0) seconds (float
                              point values allowed too)
  -q nqueries  --queries=nqueries
                              Set the number of probes per each hop. Default is
                              3
  -r                          Bypass the normal routing and send directly to a
                              host on an attached network
  -s src_addr  --source=src_addr
                              Use source src_addr for outgoing packets
  -z sendwait  --sendwait=sendwait
                              Minimal time interval between probes (default 0).
                              If the value is more than 10, then it specifies a
                              number in milliseconds, else it is a number of
                              seconds (float point values allowed too)
  -e  --extensions            Show ICMP extensions (if present), including MPLS
  -A  --as-path-lookups       Perform AS path lookups in routing registries and
                              print results directly after the corresponding
                              addresses
  -M name  --module=name      Use specified module (either builtin or external)
                              for traceroute operations. Most methods have
                              their shortcuts (`-I' means `-M icmp' etc.)
  -O OPTS,...  --options=OPTS,...
                              Use module-specific option OPTS for the
                              traceroute module. Several OPTS allowed,
                              separated by comma. If OPTS is "help", print info
                              about available options
  --sport=num                 Use source port num for outgoing packets. Implies
                              `-N 1'
  --fwmark=num                Set firewall mark for outgoing packets
  -U  --udp                   Use UDP to particular port for tracerouting
                              (instead of increasing the port per each probe),
                              default port is 53
  -UL                         Use UDPLITE for tracerouting (default dest port
                              is 53)
  -D  --dccp                  Use DCCP Request for tracerouting (default port
                              is 33434)
  -P prot  --protocol=prot    Use raw packet of protocol prot for tracerouting
  --mtu                       Discover MTU along the path being traced. Implies
                              `-F -N 1'
  --back                      Guess the number of hops in the backward path and
                              print if it differs
  -V  --version               Print version info and exit
  --help                      Read this help and exit

Arguments:
+     host          The host to traceroute to
      packetlen     The full packet length (default is the length of an IP
                    header plus 40). Can be ignored or increased to a minimal
                    allowed value

```



### å¸®åŠ©è¯´æ˜

| å‚æ•° | ç”¨æ³•è¯´æ˜                                            |
| ---- | --------------------------------------------------- |
| -d   | ä½¿ç”¨Socketå±‚çº§çš„æ’é”™åŠŸèƒ½ã€‚                          |
| -f   | è®¾ç½®ç¬¬ä¸€ä¸ªæ£€æµ‹æ•°æ®åŒ…çš„å­˜æ´»æ•°å€¼TTLçš„å¤§å°             |
| -F   |                                                     |
| -g   | è®¾ç½®æ¥æºè·¯ç”±ç½‘å…³ï¼Œæœ€å¤šå¯è®¾ç½®8ä¸ª                     |
| -i   | ä½¿ç”¨æŒ‡å®šçš„ç½‘ç»œç•Œé¢é€å‡ºæ•°æ®åŒ…ã€‚                      |
| -I   | ä½¿ç”¨ICMPå›åº”å–ä»£UDPèµ„æ–™ä¿¡æ¯ã€‚                       |
| -m   | è®¾ç½®æ£€æµ‹æ•°æ®åŒ…çš„æœ€å¤§å­˜æ´»æ•°å€¼TTLçš„å¤§å°               |
| -n   | ç›´æ¥ä½¿ç”¨IPåœ°å€è€Œéä¸»æœºåç§°                          |
| -p   | è®¾ç½®UDPä¼ è¾“åè®®çš„é€šä¿¡ç«¯å£                           |
| -r   | å¿½ç•¥æ™®é€šçš„Routing Tableï¼Œç›´æ¥å°†æ•°æ®åŒ…é€åˆ°è¿œç«¯ä¸»æœºä¸Š |
| -s   | è®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€                      |
| -t   | è®¾ç½®æ£€æµ‹æ•°æ®åŒ…çš„TOSæ•°å€¼ã€‚                           |
| -v   | è¯¦ç»†æ˜¾ç¤ºæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹                              |
| -w   | è®¾ç½®ç­‰å¾…è¿œç«¯ä¸»æœºå›æŠ¥çš„æ—¶é—´                          |
| -x   | å¼€å¯æˆ–å…³é—­æ•°æ®åŒ…çš„æ­£ç¡®æ€§æ£€éªŒ                        |



### æ¡ˆä¾‹å®æ“

---

## ulimit

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

https://www.ibm.com/support/knowledgecenter/en/ssw_aix_71/u_commands/ulimit.html

https://www.cnblogs.com/zengkefu/p/5649407.html

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

```shell
[root@iZwz95595k3zd19eqoif62Z ~]# ulimit -a
core file size          (blocks, -c) unlimited
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 7197
max locked memory       (kbytes, -l) 16384
max memory size         (kbytes, -m) unlimited
open files                      (-n) 65535
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 7197
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

```

ç¬¬1åˆ—ï¼š é™åˆ¶é¡¹

ç¬¬2åˆ—ï¼š è¯¥é™åˆ¶é¡¹ç›®å‘½ä»¤å‚æ•°åŠå•ä½

ç¬¬3åˆ—ï¼šç›®å‰é™åˆ¶å€¼(unlimitedä¸é™åˆ¶)



å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š `ulimit ç¬¬2åˆ—çš„å‚æ•° å‚æ•°å€¼`  æ¥ä¸´æ—¶ä¿®æ”¹ï¼Œç³»ç»Ÿé‡å¯åŠ¨åè¢«è¿˜åŸ

### å¸®åŠ©è¯´æ˜

-a æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ‰€æœ‰çš„limitèµ„æºä¿¡æ¯

-H è®¾ç½®èµ„æºçš„ç¡¬æ€§é™åˆ¶ï¼Œä¸€æ—¦è®¾ç½®ä¸èƒ½å¢åŠ ã€‚ä¾‹å¦‚ï¼šulimit -Hs 64 ç¡¬æ€§é™åˆ¶çº¿ç¨‹æ ˆçš„å¤§å°ä¸º64K

-S è®¾ç½®èµ„æºçš„å¼¹æ€§é™åˆ¶ï¼Œè®¾ç½®åå¯ä»¥å¢åŠ ï¼Œä½†ï¼Œä¸èƒ½è¶…è¿‡ç¡¬æ€§è®¾ç½®ã€‚ä¾‹å¦‚ï¼šulimit -Sn 32 é™åˆ¶è½¯èµ„æºä¸º32ä¸ªæ–‡ä»¶æè¿°ç¬¦

-c æœ€å¤§çš„coreæ–‡ä»¶çš„å¤§å°ï¼Œä»¥ blocks å—ä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼šulimit â€“ c unlimitedï¼› å¯¹ç”Ÿæˆçš„ core æ–‡ä»¶çš„å¤§å°ä¸è¿›è¡Œé™åˆ¶ã€‚

-f è¿›ç¨‹å¯ä»¥åˆ›å»ºæ–‡ä»¶çš„æœ€å¤§å€¼ï¼Œä»¥blocks å—ä¸ºå•ä½.ä¾‹å¦‚ï¼šulimit â€“ f 2048ï¼›é™åˆ¶è¿›ç¨‹å¯ä»¥åˆ›å»ºçš„æœ€å¤§æ–‡ä»¶å¤§å°ä¸º 2048 blocksã€‚

-d è¿›ç¨‹æœ€å¤§çš„æ•°æ®æ®µçš„å¤§å°ï¼Œä»¥Kbytes ä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼šulimit -d unlimitedï¼›å¯¹è¿›ç¨‹çš„æ•°æ®æ®µå¤§å°ä¸è¿›è¡Œé™åˆ¶ã€‚

-m æœ€å¤§å†…å­˜å¤§å°ï¼Œä»¥Kbytesä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼šulimit â€“ m unlimitedï¼›å¯¹æœ€å¤§å†…å­˜ä¸è¿›è¡Œé™åˆ¶ã€‚

-n åŒä¸€æ—¶é—´å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼šulimit â€“ n 128ï¼›é™åˆ¶æœ€å¤§å¯ä»¥ä½¿ç”¨ 128 ä¸ªæ–‡ä»¶æè¿°ç¬¦

-s çº¿ç¨‹æ ˆå¤§å°ï¼Œä»¥Kbytesä¸ºå•ä½ã€‚ä¾‹å¦‚:ulimit â€“ s 512ï¼›é™åˆ¶çº¿ç¨‹æ ˆçš„å¤§å°ä¸º 512 Kbytesã€‚

-p ç®¡é“ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥Kbytes ä¸ºå•ä½ã€‚ä¾‹å¦‚ulimit â€“ p 512ï¼›é™åˆ¶ç®¡é“ç¼“å†²åŒºçš„å¤§å°ä¸º 512 Kbytesã€‚

-u ç”¨æˆ·æœ€å¤§å¯ç”¨çš„è¿›ç¨‹æ•°ã€‚ä¾‹å¦‚ limit â€“ u 65536ï¼›é™åˆ¶ç”¨æˆ·æœ€å¤šå¯ä»¥ä½¿ç”¨ 65536ä¸ªè¿›ç¨‹ã€‚

-v è¿›ç¨‹æœ€å¤§å¯ç”¨çš„è™šæ‹Ÿå†…å­˜ï¼Œä»¥Kbytes ä¸ºå•ä½ã€‚ulimit â€“ v 200000ï¼›é™åˆ¶æœ€å¤§å¯ç”¨çš„è™šæ‹Ÿå†…å­˜ä¸º 200000 Kbytesã€‚

-t æœ€å¤§CPUå ç”¨æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚ulimit â€“ t unlimitedï¼›å¯¹æœ€å¤§çš„ CPU å ç”¨æ—¶é—´ä¸è¿›è¡Œé™åˆ¶ã€‚

-l æœ€å¤§å¯åŠ é”å†…å­˜å¤§å°ï¼Œä»¥Kbytes ä¸ºå•ä½ã€‚

-e æœ€é«˜ä¼˜å…ˆçº§

-i  æœ€å¤§å¾…å¤„ç†çš„ä¿¡å·

-q POSIXæ¶ˆæ¯é˜Ÿåˆ—æœ€å¤§å€¼

-r æ—¶é—´ä¼˜å…ˆçº§

-x æ–‡ä»¶é”



### æ¡ˆä¾‹å®æ“

---

## stat

### æ¨èæŒ‡æ•°	â˜…â˜…â˜…â˜…

### å‚è€ƒ

### å·¥å…·ç”¨é€”

### å·¥å…·å®‰è£…

### å¸®åŠ©ä¿¡æ¯

### å¸®åŠ©è¯´æ˜

### æ¡ˆä¾‹å®æ“